[![CodeFactor](https://www.codefactor.io/repository/github/tig/winprint/badge?s=93affda0738af869187afe5296914b814511f529)](https://www.codefactor.io/repository/github/tig/winprint)

# WinPrint 2.0

WinPrint - A modern take on the the classic from [1988](https://www.kindel.com/products/winprint/).

WinPrint is the perfect tool for printing source code, web pages, reports generated by legacy systems, documentation, or any text file. It works either interactively or from the command line making it perfect for single users or whole enterprises.

## Features

* Cross platform. Even though it's named **Win**Print, it works on Windows, Linux (command line only), and (not yet tested) Mac OS.
* Use from the Commandline/Console or GUI.
* Print source code, with syntax highlighting and line numbering for over 200 programming langauges and file formats.
* Print "multiple-pages-up" on one piece of paper (saves trees!)
* Complete control over all page formatting options, including headers and footers, margins, fonts, page orientation, etc...
* Simple and elegant graphical user interface with accurate print preview.
* Complete command line interface. Allows WinPrint to be used from other applications or solutions.
* Sheet Definitions make it easy to save settings for frequent print jobs.
* Headers and Footers support detailed file nad print information macros with rich date/time formatting.

## Command Line Interface

Examples:

Print Program.cs in landscape mode:

    winprint --landscape Program.cs

Print all .cs files on a specific printer with a specific paper size:

    winprint --printer "Fabricam 535" --paper-size A4 *.cs

Print the first two pages of Program.cs:

    winprint --from-page 1 --to-page 2 Program.cs

Print Program.cs using the 2 Up sheet defintion:

    winprint --sheet "2 Up" Program.cs

* `-s`, `--sheet` - Sheet defintion to use for formatting. Use sheet ID or friendly name.

* `-l`, `--landscape` - Force landscape orientation.

* `-r`, `--portrait` - Force portrait orientation.

* `-p`, `--printer` - Printer name.

* `z`, `--paper-size` - Paper size name.

* `f`, `--from-page` - (Default: 0) Number of first page to print (may be used with `--to-page`).

* `t`, `--to-page` - (Default: 0) Number of last page to print (may be used with `--from-page`).

* `c`, `--count-pages` - (Default: false) Exit code is set to numer of pages that would be printed. Use `--verbose` to diplsay the count.

* `v`, `--verbose` - (Default: false) Verbose console output (log is always verbose).

* `d`, `--debug` - (Default: false) Debug-level console & log output.

* `g`, `--gui ` - (Default: false) Show WinPrint GUI (to preview or change sheet settings).

* `--help` - Display this help screen.

* `--version` - Display version information.

* `<files>` - Required. One or more files to be printed.

## Sheet Definitions

WinPrint supports multiple sheet definitions. In the WinPrint world a **Sheet** is a side of a sheet of paper. Depending on how its configured, WinPrint will print one or more (even numbers) of **Pages** on each **Sheet**.

This is called "n-up" printing. The most common form of "n-up" printing is "2-up" where the page orientation is set to landscape and there are two columns of pages.

The layout and format of the **Sheet** is defined by a set of configuration settings called a **Sheet Definition**. **Sheet Definitions** are defined and stored in the `WinPrint.Config.json` configuration file found in `%appdata%\Kindel Systems\WinPrint`.

### Headers & Footers Macros

The format for header & footer specifiers is:

    [<left part>|<center part>|<right part>]

where `<left part>`,` <center part>`, and `<right part>` can be composed of text and any of the **Macros** described below. For example:

    {DateRevised:D}|{FullyQualifiedPath}|{FileType}

* `{NumPages}` - The total number of **Sheets** in the file.

* `{Page}` - The current **Sheet** number.

* `{FileExtension}` - The file extension of the file.

* `{FileName}` - The name of file without the extension.

* `{FilePath}` - The path to the file without the filename or extension.

* `{FullyQualifiedPath}` - The full path to the file, inclidng the filename and extension.

* `{FileType}` - The file type (for `text/plain` and `text/html`) or language (for `sourcecode`) of the file. 

* `{DatePrinted}` - The current date & time (see formatting below).

* `{DateRevised}` - The date & time the file was last revised.

The `{DatePrinted}` and `{DateRevised}` macros support the full set of [standard .NET date and time formatting modifiers](https://docs.microsoft.com/en-us/dotnet/standard/base-types/standard-date-and-time-format-strings). For example `{DateRevised:M}` will generate just the month and date (e.g. `September 10`) while `{DateRevised:t}` will generate just the `short time` (`4:55 PM`).

### Modifying Sheet Definitions

The WinPrint GUI can be used to change most Sheet Definition settings. All settings can be changed by editing the `WinPrint.Config.json` file. Note if `WinPrint.Config.json` is changed while the WinPrint GUI App is running, it will detect the change and re-flow the currently loaded file. In other-words, a text editor can be used as the UI for advanced settings.

### Creating new Sheet Definitions

WinPrint starts with two "built-in" Sheet Definitions: `Default (1-UP)` and `Default (2-Up)`. Additional Sheet Definitions can be created by editing `WinPrint.Config.json`, copying one of the existing Sheet Defintions and giving it a new unique `name` and unique `ID`.

## Content Types

WinPrint currently supports three rendering engines, representing three Content Types:

1. **`text/plain`** - This rendering engine knows only how to print raw `text/plain` files. The format of the printed text can be changed (e.g. to turn off line numbers or use a differnt font). Lines that are too long for a page are wrapped at character boundaries. `\r` (formfeed) characters can be made to cause following text to print on the next page (this is off by default). Settings for the `text/plain` can be changed by editing the `textFileSettings` section of a Sheet Definition in the `WinPrint.Config.json` file. 

2. **`text/html`** - This rendering engine can print html files. Any CSS specified by the HTML file will be honored. For HTML without CSS, the default CSS used can be overridden by providing a file named `winprint.css` in the `%appdata%\Kindel Systems\WinPrint` folder. `text/html` does not support line numbers.

3. **`text/sourcecode`** - The sourcecode rendering engine supports syntax highlighting (pretty printing), with line numbering, of over 200 programming languages. The style of the printing can be changed by providing a file named `winprint-prism.css` `%appdata%\Kindel Systems\WinPrint` folder. The styles defined in this format shold match those defined for [PrismJS](https://prismjs.com). Any PrismJS style sheet will work with WinPrint.

WinPrint decides which Content Type Rendering Engine to use based on file extension. It has a built-in library of hundreds of file-type mappings. 

To associate a file extension with a particular Content Type Engine modify the `files.associations` section of `WinPrint.Config.json` appropriately. For example to associate files with a `.htm` extension with the `text/html` Content Type Engine add a line as shown below (the `WinPrint.Config.json` generated when WinPrint runs the first time already provides this example, as an example):

    "files.associations": {
      "*.htm": "text/html",
    }

For assocaiting file extentions with a particular programming language using the `sourcecode` File Type Renderer see below.

## Language Associations

WinPrint's `text/sourcecode` File Type Engine knows how to syntax highlight (pretty print) over 200 programming languages. It has a built-in file extension to language mapping that should work for most modern scenarios. For example it knows that `.cs` files hold `C#` and `.bf` files hold `brainfuck`.

### Adding or Changing `text/sourcecode` Language Associations

To associate a file extension with a language spported by `text/sourcecode` modify the `files.associations` and `languages` sections of `WinPrint.Config.json` appropriately. For example to associate files with a `.config` extension with the JSON langauge  add a line as shown below (the `WinPrint.Config.json` generated when WinPrint runs the first time already provides this example, as an example):

    "files.associations": {
      "*.config": "json"
    }

To determine the name to use (e.g. `json`) see the [PrismJS](https://prismjs.com/#supported-languages) list of languages.

A new langauge can be defined by aliasing it to an existing language by modifying the `languages` section of `WinPrint.Config.json`. 

For example to enable the [Icon Programming Language](https://en.wikipedia.org/wiki/Icon_%28programming_language%29) which is a very C-like language the `files.associations` and `languages` sections would look like the following:

    "files.associations": {
      "*.icon": "icon"
    },
    "languages": [
      {
        "id": "icon",
        "extensions": [
          ".icon"
        ],
        "aliases": [
          "clike"
        ]
      }
    ]

