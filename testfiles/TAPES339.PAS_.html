<!DOCTYPE html><html><head><title>C:\Users\ckindel\s\winprint\tests\TAPES339.PAS</title>
<meta charset="utf-8"/>
<style>
/**
 * prism.js default theme for JavaScript, CSS and HTML
 * Based on dabblet (http://dabblet.com)
 * @author Lea Verou
 */

 code[class*="language-"],
 pre[class*="language-"] {
     color: black;
     background: none;
     font-family: 'Cascadia Code', Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
     font-size: 8pt;
     text-align: left;
     word-spacing: normal;
     word-break: normal;
     word-wrap: normal;
     line-height: normal;
     tab-size: 4;
     hyphens: none;
 }
 
 pre[class*="language-"]::-moz-selection, pre[class*="language-"] ::-moz-selection,
 code[class*="language-"]::-moz-selection, code[class*="language-"] ::-moz-selection {
     text-shadow: none;
     background: #b3d4fc;
 }
 
 pre[class*="language-"]::selection, pre[class*="language-"] ::selection,
 code[class*="language-"]::selection, code[class*="language-"] ::selection {
     text-shadow: none;
     background: #b3d4fc;
 }
 
 @media print {
     code[class*="language-"],
     pre[class*="language-"] {
         text-shadow: none;
     }
 }
 
 /* Code blocks */
 pre[class*="language-"] {
     overflow: auto;
 }
 
 :not(pre) > code[class*="language-"],
 pre[class*="language-"] {
     background: #f5f2f0;
 }
 
 /* Inline code */
 :not(pre) > code[class*="language-"] {
 }
 
 .token.comment,
 .token.prolog,
 .token.doctype,
 .token.cdata {
     color: slategray;
 }
 
 .token.punctuation {
     color: #999;
 }
 
 .namespace {
     opacity: .7;
 }
 
 .token.property,
 .token.tag,
 .token.boolean,
 .token.number,
 .token.constant,
 .token.symbol,
 .token.deleted {
     color: #905;
 }
 
 .token.selector,
 .token.attr-name,
 .token.string,
 .token.char,
 .token.builtin,
 .token.inserted {
     color: #690;
 }
 
 .token.operator,
 .token.entity,
 .token.url,
 .language-css .token.string,
 .style .token.string {
     color: #9a6e3a;
 }
 
 .token.atrule,
 .token.attr-value,
 .token.keyword {
     color: #07a;
 }
 
 .token.function,
 .token.class-name {
     color: #DD4A68;
 }
 
 .token.regex,
 .token.important,
 .token.variable {
     color: #e90;
 }
 
 .token.important,
 .token.bold {
     font-weight: bold;
 }
 .token.italic {
     font-style: italic;
 }
 
 .token.entity {
     cursor: help;
 }

 .token {
 }

 span {
    padding: unset;
    padding-left: 0px;
    padding-right: 0px;
    border: none;
    margin-left: 0px;
    margin-right: 0px;
 }
 
code[class*="language-"], pre[class*="language-"] {
font-family: 'Consolas', winprint;
font-size: 8pt;
font-weight: Regular;}
/* These style override Prism built-in (and any provided theme), 
   optimizing for rendering for print. E.g. Colored backgrounds
    make no sense when printing. Also turns off some stuff 
    litehtml does not support correctly.
*/
code[class*="language-"],
pre[class*="language-"] {
    /* no backgrond 
    background: none;*/
    /* linehtml only supports white-space: pre-wrap. word-break: break-all are not yet supported.*/
    /* Relevant docs:
        white-space - https://developer.mozilla.org/en-US/docs/web/css/white-space 
        word-break - https://developer.mozilla.org/en-US/docs/Web/CSS/word-break 
        overflow-wrap - https://developer.mozilla.org/en-US/docs/Web/CSS/overflow-wrap 

        Default for winprint should be `word-break: break-all` 
        Ideally would also support `overflow-wrap: break-word`
    */
    white-space: pre-wrap; /* not good enuf. does not break at non-whitespace chars*/
    overflow-wrap: break-word; /* would work well, except broken line will start on a new line (suboptimal) */
    word-break: break-word; /* ok - may be a preference (breaks at word, then break-all */
    word-break: break-all; /* idea - breaks anywhere */
    /* Force line-height to 'normal' */
    line-height: normal;
    /* Remove all padding and margins */
    padding: 0;
    margin: 0;
    hyphens: auto;
    text-align: left;
    tab-size: 4;
}

/* Code blocks */
pre[class*="language-"] {
    position: relative;
    /* Remove all padding and margins */
    margin: 0;
    padding: 0;
    overflow: visible;
}

/* Background & border */
pre[class*="language-"] > code {
    /* turn off all background features */
    /* no backgrond 
    background: none;*/
    background-image: none;
    /* background-color: transparent;*/
    /* turn off all borders (winprint provides own border mechansim) */
    border-left: 0px;
    border-right: none;
    border-top: none;
    border-bottom: none;
    box-shadow: none;
}

code[class*="language"] {
    /* Remove all padding and margins */
    padding: 0;
    margin: 0;
}

/* Margin bottom to accommodate shadow */
:not(pre) > code[class*="language-"],
pre[class*="language-"] {
    /* Remove all padding and margins (prism-coy) */
    all: unset;
}

    /* Remove any before/after fancy formatting (like coy's shadows) */
    pre[class*="language-"]:before,
    pre[class*="language-"]:after {
        all: initial;
    }

    :not(pre) > code[class*="language-"]:after,
    pre[class*="language-"]:after {
        all: unset;
    }

/* disable operator background found in default prism.js */
.token.comment,
.token.block-comment,
.token.prolog,
.token.doctype,
.token.cdata,
.token.punctuation,
.token.property,
.token.tag,
.token.boolean,
.token.number,
.token.function-name,
.token.constant,
.token.symbol,
.token.deleted,
.token.selector,
.token.attr-name,
.token.string,
.token.char,
.token.function,
.token.builtin,
.token.inserted,
.token.operator,
.token.entity,
.token.url,
.token.variable,
.token.atrule,
.token.attr-value,
.token.keyword,
.token.class-name,
.token.regex,
.token.important,
.language-css .token.string,
.style .token.string,
.token.important,
.token.bold,
.token.italic,
.token.operator,
.token.entity,
.token.url,
.language-css .token.string,
.style .token.string {
    /* no backgrond 
    background: none;*/
}

ol {
    display: block;
    /* This works around a bug in litehmtl where it renders lists too far down */
    margin-top: -0.5em;
    margin-bottom: 0;
    margin-left: 30px;
    margin-right: 0;
    list-style-type: decimal;
    padding-top: 0px;
    padding-right: 0px;
    padding-bottom: 0px;
    padding-left: 0px;
}

li:first-child {
    margin-top: 0;
}

li {
    padding: 0px;
    margin: 0;
    line-height: 0px;
}

body {
    padding: 0px;
    margin: 0px;
}

table {
    border: 0;
    border-spacing: 0;
    padding: 0px;
    margin: 0;
}

tr {
    border: 0;
    border-spacing: 0;
    padding: 0px;
    margin: 0;
}

td {
    border: 0;
    border-spacing: 0;
    padding: 0px;
    margin: 0;
}

td[class*="line-number"] {
    padding-left: 0.5em;
    padding-right: 0.2em;
    margin-right: 0.5em;
    text-align: right;
    vertical-align: top;
    border-right: 1px solid darkgray;
    color: darkgray;
}

</style>
</head><body><pre class="language-pascal "><code class="language-pascal"><table>
<tr><td class="line-number">1</td><td><span class="token keyword">Program</span> Tapes<span class="token punctuation">;</span> <span class="token comment">{ver 3.39}</span></td></tr>
<tr><td class="line-number">2</td><td></td></tr>
<tr><td class="line-number">3</td><td><span class="token comment">{========================================================================}</span></td></tr>
<tr><td class="line-number">4</td><td><span class="token comment">{               TAPES - (c) 1986-1990 Charles E. Kindel, Jr.             }</span></td></tr>
<tr><td class="line-number">5</td><td><span class="token comment">{                     KindlCo Software Systems                           }</span></td></tr>
<tr><td class="line-number">6</td><td><span class="token comment">{                                                                        }</span></td></tr>
<tr><td class="line-number">7</td><td><span class="token comment">{ Written by Charles E. Kindel                                           }</span></td></tr>
<tr><td class="line-number">8</td><td><span class="token comment">{            Kindlco Software Systems                                    }</span></td></tr>
<tr><td class="line-number">9</td><td><span class="token comment">{            4225 N. First Ave #1315                                     }</span></td></tr>
<tr><td class="line-number">10</td><td><span class="token comment">{            Tucson, AZ 85719                                            }</span></td></tr>
<tr><td class="line-number">11</td><td><span class="token comment">{                                                                        }</span></td></tr>
<tr><td class="line-number">12</td><td><span class="token comment">{ Tapes is copyrighted by Charles E. Kindel, Jr. (1987,88,89,90). The Source}</span></td></tr>
<tr><td class="line-number">13</td><td><span class="token comment">{ code may is not be distributed, copied, or altered in any form.  The   }</span></td></tr>
<tr><td class="line-number">14</td><td><span class="token comment">{ executable code (TAPES.EXE) can be copied and distributed freely.      }</span></td></tr>
<tr><td class="line-number">15</td><td><span class="token comment">{ This program may not be sold, rented, or offered as                    }</span></td></tr>
<tr><td class="line-number">16</td><td><span class="token comment">{ as an incitement to buy any other product.                             }</span></td></tr>
<tr><td class="line-number">17</td><td><span class="token comment">{                                                                        }</span></td></tr>
<tr><td class="line-number">18</td><td><span class="token comment">{ Revisons:                                                              }</span></td></tr>
<tr><td class="line-number">19</td><td><span class="token comment">{                                                                        }</span></td></tr>
<tr><td class="line-number">20</td><td><span class="token comment">{       1/29/88                                                          }</span></td></tr>
<tr><td class="line-number">21</td><td><span class="token comment">{       V3.22 - Made RETURN go to the beginning of next line, as apposed }</span></td></tr>
<tr><td class="line-number">22</td><td><span class="token comment">{               to going to same position in next line.                  }</span></td></tr>
<tr><td class="line-number">23</td><td><span class="token comment">{               Fixed bug that would prompt to clear and exit even if    }</span></td></tr>
<tr><td class="line-number">24</td><td><span class="token comment">{               no data had been entered.                                }</span></td></tr>
<tr><td class="line-number">25</td><td><span class="token comment">{               Fixed print routines so the printer gets "reset" to      }</span></td></tr>
<tr><td class="line-number">26</td><td><span class="token comment">{               uncompressed and 1/6 inch line spacing.                  }</span></td></tr>
<tr><td class="line-number">27</td><td><span class="token comment">{                                                                        }</span></td></tr>
<tr><td class="line-number">28</td><td><span class="token comment">{       2/22/88                                                          }</span></td></tr>
<tr><td class="line-number">29</td><td><span class="token comment">{       V3.30 - Converted to Turbo Pascal 4.0                            }</span></td></tr>
<tr><td class="line-number">30</td><td><span class="token comment">{                                                                        }</span></td></tr>
<tr><td class="line-number">31</td><td><span class="token comment">{       5/28/88                                                          }</span></td></tr>
<tr><td class="line-number">32</td><td><span class="token comment">{       V3.31 - Added code to detect 43 line EGA or 50 line VGA.  TAPES  }</span></td></tr>
<tr><td class="line-number">33</td><td><span class="token comment">{               now switches out of these modes into 25 line mode when   }</span></td></tr>
<tr><td class="line-number">34</td><td><span class="token comment">{               it starts and goes back to original mode when it is done.}</span></td></tr>
<tr><td class="line-number">35</td><td><span class="token comment">{             - The cursor now changes size when Insert/Overwrite is     }</span></td></tr>
<tr><td class="line-number">36</td><td><span class="token comment">{               toggled with the Insert key.  Small cursor means insert  }</span></td></tr>
<tr><td class="line-number">37</td><td><span class="token comment">{               mode is on, block cursor means overwrite is on.          }</span></td></tr>
<tr><td class="line-number">38</td><td><span class="token comment">{             - Made the prompts for Clear, and Quit open windows.       }</span></td></tr>
<tr><td class="line-number">39</td><td><span class="token comment">{       7/18/88                                                          }</span></td></tr>
<tr><td class="line-number">40</td><td><span class="token comment">{       V3.32 - Enhanced ability to detect screen mode.                  }</span></td></tr>
<tr><td class="line-number">41</td><td><span class="token comment">{       10/5/88                                                          }</span></td></tr>
<tr><td class="line-number">42</td><td><span class="token comment">{       V3.33 - Recompiled in Turbo Pascal 5.0                           }</span></td></tr>
<tr><td class="line-number">43</td><td><span class="token comment">{                                                                        }</span></td></tr>
<tr><td class="line-number">44</td><td><span class="token comment">{       V3.34 - Fixed PgUp and PgDown so they worked more intuitivley    }</span></td></tr>
<tr><td class="line-number">45</td><td><span class="token comment">{                                                                        }</span></td></tr>
<tr><td class="line-number">46</td><td><span class="token comment">{       2/1/89                                                           }</span></td></tr>
<tr><td class="line-number">47</td><td><span class="token comment">{       V3.35 - Added option to print Tape Type and Noise Reduction      }</span></td></tr>
<tr><td class="line-number">48</td><td><span class="token comment">{               And added a menu window for print,clear,etc...           }</span></td></tr>
<tr><td class="line-number">49</td><td><span class="token comment">{                                                                        }</span></td></tr>
<tr><td class="line-number">50</td><td><span class="token comment">{       2/27/89                                                          }</span></td></tr>
<tr><td class="line-number">51</td><td><span class="token comment">{       V3.36 - Now can save default configuration of noise reduction    }</span></td></tr>
<tr><td class="line-number">52</td><td><span class="token comment">{               and tape type.  Searches current dir, path, and          }</span></td></tr>
<tr><td class="line-number">53</td><td><span class="token comment">{               dir where program was executed.  Added option to change  }</span></td></tr>
<tr><td class="line-number">54</td><td><span class="token comment">{               lpt port, user can now select between lpt1: lpt2:, com1:,}</span></td></tr>
<tr><td class="line-number">55</td><td><span class="token comment">{               and com2:.  This can be saved to the .EXE file.  Now     }</span></td></tr>
<tr><td class="line-number">56</td><td><span class="token comment">{               supports multiple printers.                              }</span></td></tr>
<tr><td class="line-number">57</td><td><span class="token comment">{                                                                        }</span></td></tr>
<tr><td class="line-number">58</td><td><span class="token comment">{       5/15/89                                                          }</span></td></tr>
<tr><td class="line-number">59</td><td><span class="token comment">{       V3.37 - Added tab key support.  Tab key now inserts 5 spaces     }</span></td></tr>
<tr><td class="line-number">60</td><td><span class="token comment">{                                                                        }</span></td></tr>
<tr><td class="line-number">61</td><td><span class="token comment">{       11/30/89                                                         }</span></td></tr>
<tr><td class="line-number">62</td><td><span class="token comment">{       V3.38 - Fixed bug in clear where after clear the cursor would    }</span></td></tr>
<tr><td class="line-number">63</td><td><span class="token comment">{               return to field 1.  Fixed keyboard handling problem in   }</span></td></tr>
<tr><td class="line-number">64</td><td><span class="token comment">{               Menu.  Previously if the down arrrow was pressed in Menu }</span></td></tr>
<tr><td class="line-number">65</td><td><span class="token comment">{               Print would happen.  Fixed copyright notices.            }</span></td></tr>
<tr><td class="line-number">66</td><td><span class="token comment">{                                                                        }</span></td></tr>
<tr><td class="line-number">67</td><td><span class="token comment">{       4/27/90                                                          }</span></td></tr>
<tr><td class="line-number">68</td><td><span class="token comment">{       V3.39 - Updated address and fixed color problems                 }</span></td></tr>
<tr><td class="line-number">69</td><td><span class="token comment">{                                                                        }</span></td></tr>
<tr><td class="line-number">70</td><td><span class="token comment">{========================================================================}</span></td></tr>
<tr><td class="line-number">71</td><td></td></tr>
<tr><td class="line-number">72</td><td></td></tr>
<tr><td class="line-number">73</td><td><span class="token keyword">Uses</span></td></tr>
<tr><td class="line-number">74</td><td>  Dos<span class="token punctuation">,</span></td></tr>
<tr><td class="line-number">75</td><td>  TpString<span class="token punctuation">,</span></td></tr>
<tr><td class="line-number">76</td><td>  TpDOS<span class="token punctuation">,</span></td></tr>
<tr><td class="line-number">77</td><td>  TpCrt<span class="token punctuation">,</span></td></tr>
<tr><td class="line-number">78</td><td>  TpWindow<span class="token punctuation">,</span></td></tr>
<tr><td class="line-number">79</td><td>  sDefs<span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">80</td><td></td></tr>
<tr><td class="line-number">81</td><td>   <span class="token keyword">type</span> PtrRec <span class="token operator">=</span> <span class="token keyword">record</span></td></tr>
<tr><td class="line-number">82</td><td>           Comp_On  <span class="token punctuation">:</span> <span class="token keyword">string</span> <span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">83</td><td>           Comp_Off <span class="token punctuation">:</span> <span class="token keyword">string</span> <span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">84</td><td>           Bold_On  <span class="token punctuation">:</span> <span class="token keyword">string</span> <span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">85</td><td>           Bold_Off <span class="token punctuation">:</span> <span class="token keyword">string</span> <span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">86</td><td>           One8th   <span class="token punctuation">:</span> <span class="token keyword">string</span> <span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">87</td><td>           One6th   <span class="token punctuation">:</span> <span class="token keyword">string</span> <span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">88</td><td>        <span class="token keyword">end</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">89</td><td>        fieldtype <span class="token operator">=</span> <span class="token keyword">string</span> <span class="token punctuation">[</span><span class="token number">50</span><span class="token punctuation">]</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">90</td><td></td></tr>
<tr><td class="line-number">91</td><td>   <span class="token keyword">Const</span></td></tr>
<tr><td class="line-number">92</td><td>      idHeader<span class="token punctuation">:</span>   <span class="token keyword">String</span><span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span>  <span class="token operator">=</span> <span class="token string">'XmtSpot '</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">93</td><td>      biastype     <span class="token punctuation">:</span> byte <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">94</td><td>      noisetype    <span class="token punctuation">:</span> byte <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">95</td><td>      lpttype  <span class="token punctuation">:</span> byte <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">96</td><td>      prntype  <span class="token punctuation">:</span> byte <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">97</td><td></td></tr>
<tr><td class="line-number">98</td><td>      Printers <span class="token punctuation">:</span> <span class="token keyword">array</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token operator">..</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token keyword">of</span> PtrRec <span class="token operator">=</span></td></tr>
<tr><td class="line-number">99</td><td>               <span class="token punctuation">(</span>    <span class="token punctuation">(</span>Comp_On <span class="token punctuation">:</span> <span class="token string">^O</span> <span class="token punctuation">;</span>         <span class="token comment">{Compressed on: change to suit your printer}</span></td></tr>
<tr><td class="line-number">100</td><td>                    Comp_Off <span class="token punctuation">:</span> <span class="token string">^R</span> <span class="token punctuation">;</span>         <span class="token comment">{Compressed off: ditto.}</span></td></tr>
<tr><td class="line-number">101</td><td>        <span class="token comment">{IBM/EPSON}</span> Bold_On  <span class="token punctuation">:</span> <span class="token string">#27</span><span class="token operator">+</span><span class="token string">'G'</span><span class="token punctuation">;</span>     <span class="token comment">{Turns on double strike}</span></td></tr>
<tr><td class="line-number">102</td><td>                    Bold_Off <span class="token punctuation">:</span> <span class="token string">#27</span><span class="token operator">+</span><span class="token string">'H'</span><span class="token punctuation">;</span>     <span class="token comment">{Turns double strike off}</span></td></tr>
<tr><td class="line-number">103</td><td>                    One8th   <span class="token punctuation">:</span> <span class="token string">#27</span><span class="token operator">+</span><span class="token string">'0'</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">104</td><td>                    One6th   <span class="token punctuation">:</span> <span class="token string">#27</span><span class="token operator">+</span> <span class="token string">'A'</span><span class="token operator">+</span> <span class="token string">#12</span><span class="token operator">+</span> <span class="token string">#27</span><span class="token operator">+</span> <span class="token string">'2'</span></td></tr>
<tr><td class="line-number">105</td><td>                    <span class="token punctuation">)</span><span class="token punctuation">,</span></td></tr>
<tr><td class="line-number">106</td><td>                    <span class="token punctuation">(</span>Comp_On <span class="token punctuation">:</span> <span class="token string">#27</span><span class="token operator">+</span><span class="token string">'(s16.66H'</span><span class="token punctuation">;</span>   <span class="token comment">{Compressed on: change to suit your printer}</span></td></tr>
<tr><td class="line-number">107</td><td>                    Comp_Off <span class="token punctuation">:</span> <span class="token string">#27</span><span class="token operator">+</span><span class="token string">'(s10H'</span><span class="token punctuation">;</span>      <span class="token comment">{Compressed off: ditto.}</span></td></tr>
<tr><td class="line-number">108</td><td>        <span class="token comment">{HP Laser}</span>  Bold_On  <span class="token punctuation">:</span> <span class="token string">#27</span><span class="token operator">+</span><span class="token string">'(s3B'</span><span class="token punctuation">;</span>       <span class="token comment">{Turns on double strike}</span></td></tr>
<tr><td class="line-number">109</td><td>                    Bold_Off <span class="token punctuation">:</span> <span class="token string">#27</span><span class="token operator">+</span><span class="token string">'(s0B'</span><span class="token punctuation">;</span>       <span class="token comment">{Turns double strike off}</span></td></tr>
<tr><td class="line-number">110</td><td>                    One8th   <span class="token punctuation">:</span> <span class="token string">#27</span><span class="token operator">+</span><span class="token string">'&amp;l8D'</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">111</td><td>                    One6th   <span class="token punctuation">:</span> <span class="token string">#27</span><span class="token operator">+</span><span class="token string">'&amp;l6D'</span></td></tr>
<tr><td class="line-number">112</td><td>                    <span class="token punctuation">)</span></td></tr>
<tr><td class="line-number">113</td><td>               <span class="token punctuation">)</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">114</td><td>      LastByte <span class="token punctuation">:</span> byte <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">115</td><td>      PrnName <span class="token punctuation">:</span> <span class="token keyword">array</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token operator">..</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token keyword">of</span> <span class="token keyword">string</span> <span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span> <span class="token operator">=</span></td></tr>
<tr><td class="line-number">116</td><td>                <span class="token punctuation">(</span><span class="token string">'IBM/Epson'</span><span class="token punctuation">,</span> <span class="token string">'HP Laser'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">117</td><td></td></tr>
<tr><td class="line-number">118</td><td></td></tr>
<tr><td class="line-number">119</td><td></td></tr>
<tr><td class="line-number">120</td><td></td></tr>
<tr><td class="line-number">121</td><td>      Version <span class="token operator">=</span> <span class="token number">3.39</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">122</td><td>      Year <span class="token operator">=</span> <span class="token number">1990</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">123</td><td>   <span class="token comment">{Printer Codes:}</span></td></tr>
<tr><td class="line-number">124</td><td>      Tab <span class="token operator">=</span> <span class="token string">^I</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">125</td><td>      Esc <span class="token operator">=</span> <span class="token operator">^</span><span class="token punctuation">[</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">126</td><td>   <span class="token comment">{Graphics Characters:}</span></td></tr>
<tr><td class="line-number">127</td><td>      Horiz <span class="token operator">=</span> <span class="token string">#196</span><span class="token punctuation">;</span>          Vert  <span class="token operator">=</span> <span class="token string">#186</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">128</td><td>      Right_T <span class="token operator">=</span> <span class="token string">#180</span><span class="token punctuation">;</span>        Left_T <span class="token operator">=</span> <span class="token string">#195</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">129</td><td>      Top_T <span class="token operator">=</span> <span class="token string">#210</span><span class="token punctuation">;</span>          Bot_T <span class="token operator">=</span> <span class="token string">#208</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">130</td><td>      Cross <span class="token operator">=</span> <span class="token string">#215</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">131</td><td>   <span class="token comment">{Function Keys:}</span></td></tr>
<tr><td class="line-number">132</td><td>      F10 <span class="token operator">=</span> <span class="token number">323</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">133</td><td>      Up <span class="token operator">=</span> <span class="token number">327</span><span class="token punctuation">;</span>              Down <span class="token operator">=</span> <span class="token number">335</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">134</td><td>      PgUp <span class="token operator">=</span> <span class="token number">328</span><span class="token punctuation">;</span>            PgDn <span class="token operator">=</span> <span class="token number">336</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">135</td><td>      CR  <span class="token operator">=</span> <span class="token number">13</span><span class="token punctuation">;</span>              BOTTOM <span class="token operator">=</span> <span class="token number">336</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">136</td><td>      DEL <span class="token operator">=</span> <span class="token number">338</span><span class="token punctuation">;</span>             DELEOL <span class="token operator">=</span> <span class="token number">372</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">137</td><td>      DELFLD <span class="token operator">=</span> <span class="token number">374</span><span class="token punctuation">;</span>          BKSPC <span class="token operator">=</span> <span class="token number">8</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">138</td><td>      HOME <span class="token operator">=</span> <span class="token number">326</span><span class="token punctuation">;</span>            ENDD<span class="token operator">=</span> <span class="token number">334</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">139</td><td>      LEFT <span class="token operator">=</span> <span class="token number">330</span><span class="token punctuation">;</span>            RIGHT <span class="token operator">=</span> <span class="token number">332</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">140</td><td>      INS  <span class="token operator">=</span> <span class="token number">337</span><span class="token punctuation">;</span>            TOP <span class="token operator">=</span> <span class="token number">328</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">141</td><td>      ESCKey <span class="token operator">=</span> <span class="token number">27</span><span class="token punctuation">;</span>           TABkey <span class="token operator">=</span> <span class="token number">9</span> <span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">142</td><td>      Month_ <span class="token punctuation">:</span> <span class="token keyword">array</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token operator">..</span><span class="token number">12</span><span class="token punctuation">]</span> <span class="token keyword">of</span> <span class="token keyword">string</span> <span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token string">'January'</span><span class="token punctuation">,</span> <span class="token string">'February'</span><span class="token punctuation">,</span> <span class="token string">'March'</span><span class="token punctuation">,</span></td></tr>
<tr><td class="line-number">143</td><td>                                               <span class="token string">'April'</span><span class="token punctuation">,</span> <span class="token string">'May'</span><span class="token punctuation">,</span> <span class="token string">'June'</span><span class="token punctuation">,</span> <span class="token string">'July'</span><span class="token punctuation">,</span></td></tr>
<tr><td class="line-number">144</td><td>                                               <span class="token string">'August'</span><span class="token punctuation">,</span> <span class="token string">'September'</span><span class="token punctuation">,</span> <span class="token string">'October'</span><span class="token punctuation">,</span></td></tr>
<tr><td class="line-number">145</td><td>                                               <span class="token string">'November'</span><span class="token punctuation">,</span> <span class="token string">'December'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">146</td><td>      DayOfWeek_ <span class="token punctuation">:</span> <span class="token keyword">array</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token operator">..</span><span class="token number">6</span><span class="token punctuation">]</span> <span class="token keyword">of</span> <span class="token keyword">string</span> <span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token string">'Sunday'</span><span class="token punctuation">,</span> <span class="token string">'Monday'</span><span class="token punctuation">,</span> <span class="token string">'Tuesday'</span><span class="token punctuation">,</span></td></tr>
<tr><td class="line-number">147</td><td>                                                  <span class="token string">'Wednesday'</span><span class="token punctuation">,</span> <span class="token string">'Thursday'</span><span class="token punctuation">,</span> <span class="token string">'Friday'</span><span class="token punctuation">,</span></td></tr>
<tr><td class="line-number">148</td><td>                                                  <span class="token string">'Saturday'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">149</td><td>      Bias <span class="token punctuation">:</span> <span class="token keyword">array</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token operator">..</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token keyword">of</span> <span class="token keyword">string</span> <span class="token punctuation">[</span><span class="token number">30</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token string">'Type I  (Normal Bias 120us)'</span><span class="token punctuation">,</span> <span class="token string">'Type II (CrO2 High Bias 70us)'</span><span class="token punctuation">,</span></td></tr>
<tr><td class="line-number">150</td><td>                                            <span class="token string">'Type IV (Metal)'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">151</td><td>      Noise <span class="token punctuation">:</span> <span class="token keyword">array</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token operator">..</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token keyword">of</span> <span class="token keyword">string</span> <span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token string">'None'</span><span class="token punctuation">,</span> <span class="token string">'Dolby B'</span><span class="token punctuation">,</span> <span class="token string">'Dolby C'</span><span class="token punctuation">,</span> <span class="token string">'dbx'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">152</td><td>      Lptname <span class="token punctuation">:</span> <span class="token keyword">array</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token operator">..</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token keyword">of</span> <span class="token keyword">string</span> <span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token string">'Lpt1'</span><span class="token punctuation">,</span> <span class="token string">'Lpt2'</span><span class="token punctuation">,</span> <span class="token string">'com1'</span><span class="token punctuation">,</span> <span class="token string">'com2'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">153</td><td></td></tr>
<tr><td class="line-number">154</td><td>   <span class="token keyword">Var</span></td></tr>
<tr><td class="line-number">155</td><td>      Song_Names  <span class="token punctuation">:</span> <span class="token keyword">array</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token operator">..</span><span class="token number">40</span><span class="token punctuation">]</span> <span class="token keyword">of</span> fieldtype<span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">156</td><td>      FieldNum<span class="token punctuation">,</span>               <span class="token comment">{Field number on the screen}</span></td></tr>
<tr><td class="line-number">157</td><td>      Pos<span class="token punctuation">,</span>                    <span class="token comment">{Position of cursor on line}</span></td></tr>
<tr><td class="line-number">158</td><td>      Htab<span class="token punctuation">,</span></td></tr>
<tr><td class="line-number">159</td><td>      Vtab        <span class="token punctuation">:</span> byte<span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">160</td><td>      i           <span class="token punctuation">:</span> word<span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">161</td><td>      New_Page<span class="token punctuation">,</span>               <span class="token comment">{Do we need to send a form feed?}</span></td></tr>
<tr><td class="line-number">162</td><td>      Empty<span class="token punctuation">,</span>                  <span class="token comment">{Is the data cleared?}</span></td></tr>
<tr><td class="line-number">163</td><td>      InsertMode<span class="token punctuation">,</span></td></tr>
<tr><td class="line-number">164</td><td>      Line43      <span class="token punctuation">:</span> boolean<span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">165</td><td>      Key         <span class="token punctuation">:</span> char<span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">166</td><td>      ptrwin<span class="token punctuation">,</span> UtilWin     <span class="token punctuation">:</span> WindowPtr<span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">167</td><td>      Status      <span class="token punctuation">:</span> word<span class="token punctuation">;</span>  <span class="token comment">{any modifications?}</span></td></tr>
<tr><td class="line-number">168</td><td>      QuitFlag    <span class="token punctuation">:</span> boolean<span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">169</td><td>      vbSize      <span class="token punctuation">:</span> Word<span class="token punctuation">;</span>     <span class="token comment">{Size of CONST block of default variables.}</span></td></tr>
<tr><td class="line-number">170</td><td>      lst         <span class="token punctuation">:</span> text<span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">171</td><td>      winMin<span class="token punctuation">,</span> winMax  <span class="token punctuation">:</span> word<span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">172</td><td></td></tr>
<tr><td class="line-number">173</td><td></td></tr>
<tr><td class="line-number">174</td><td><span class="token comment">{$I Ding.pro}</span>                       <span class="token comment">{Produces a small beep noise}</span></td></tr>
<tr><td class="line-number">175</td><td><span class="token comment">{$I Frame.pro}</span>                      <span class="token comment">{Draws double lined frames}</span></td></tr>
<tr><td class="line-number">176</td><td><span class="token comment">{$I kindlco.pas}</span></td></tr>
<tr><td class="line-number">177</td><td></td></tr>
<tr><td class="line-number">178</td><td>  <span class="token keyword">procedure</span> SaveWindow<span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">179</td><td>    <span class="token keyword">begin</span></td></tr>
<tr><td class="line-number">180</td><td>      WinMin <span class="token operator">:=</span> WindMin<span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">181</td><td>      WinMax <span class="token operator">:=</span> WindMax<span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">182</td><td>      window <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">80</span><span class="token punctuation">,</span><span class="token number">25</span><span class="token punctuation">)</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">183</td><td>    <span class="token keyword">end</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">184</td><td></td></tr>
<tr><td class="line-number">185</td><td>  <span class="token keyword">procedure</span> RestoreWindow<span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">186</td><td>    <span class="token keyword">begin</span></td></tr>
<tr><td class="line-number">187</td><td>      window <span class="token punctuation">(</span>Lo<span class="token punctuation">(</span>WinMin<span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span>Hi<span class="token punctuation">(</span>WinMin<span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span> Lo<span class="token punctuation">(</span>WinMax<span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span> Hi<span class="token punctuation">(</span>WinMax<span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">188</td><td>    <span class="token keyword">end</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">189</td><td></td></tr>
<tr><td class="line-number">190</td><td>  <span class="token keyword">procedure</span> ClearStatLine<span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">191</td><td>    <span class="token keyword">begin</span></td></tr>
<tr><td class="line-number">192</td><td>      HiddenCursor<span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">193</td><td>      Window <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">25</span><span class="token punctuation">,</span><span class="token number">80</span><span class="token punctuation">,</span><span class="token number">25</span><span class="token punctuation">)</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">194</td><td>      ClrScr<span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">195</td><td>      Window <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">80</span><span class="token punctuation">,</span><span class="token number">25</span><span class="token punctuation">)</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">196</td><td>    <span class="token keyword">end</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">197</td><td></td></tr>
<tr><td class="line-number">198</td><td>  <span class="token keyword">Procedure</span> ErExit<span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">199</td><td>    <span class="token keyword">Begin</span></td></tr>
<tr><td class="line-number">200</td><td>    savewindow<span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">201</td><td>    GoToXY<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">25</span><span class="token punctuation">)</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">202</td><td>    TextColor <span class="token punctuation">(</span>Yellow<span class="token punctuation">)</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">203</td><td>    <span class="token keyword">Write</span><span class="token punctuation">(</span>center <span class="token punctuation">(</span>ErSt<span class="token punctuation">,</span><span class="token number">79</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">{The error report string is provided by sDefs.TPU}</span></td></tr>
<tr><td class="line-number">204</td><td>    ding<span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">205</td><td>  <span class="token keyword">end</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">206</td><td></td></tr>
<tr><td class="line-number">207</td><td>  <span class="token keyword">Procedure</span> SaveConfig<span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">208</td><td>    <span class="token keyword">var</span> FileName <span class="token punctuation">:</span> <span class="token keyword">string</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">209</td><td>        newbias<span class="token punctuation">,</span> newnoise<span class="token punctuation">,</span>newlpt<span class="token punctuation">,</span>newprn <span class="token punctuation">:</span> byte<span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">210</td><td></td></tr>
<tr><td class="line-number">211</td><td>    <span class="token keyword">Begin</span></td></tr>
<tr><td class="line-number">212</td><td>      <span class="token keyword">if</span> <span class="token punctuation">(</span>Hi <span class="token punctuation">(</span>DosVersion<span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token keyword">then</span></td></tr>
<tr><td class="line-number">213</td><td>        <span class="token keyword">begin</span></td></tr>
<tr><td class="line-number">214</td><td>          <span class="token keyword">if</span> <span class="token operator">not</span> <span class="token punctuation">(</span>ExistOnPath <span class="token punctuation">(</span><span class="token string">'TAPES.EXE'</span><span class="token punctuation">,</span> filename<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">then</span></td></tr>
<tr><td class="line-number">215</td><td>            <span class="token keyword">begin</span></td></tr>
<tr><td class="line-number">216</td><td>              SaveWindow<span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">217</td><td>              TextColor <span class="token punctuation">(</span>Yellow<span class="token punctuation">)</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">218</td><td>              GotoXY <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">25</span><span class="token punctuation">)</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">219</td><td>              writeln <span class="token punctuation">(</span>center<span class="token punctuation">(</span><span class="token string">'Cannot Find TAPES.EXE; If you are using a version of DOS less than 3.0'</span><span class="token punctuation">,</span><span class="token number">79</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">220</td><td>              <span class="token keyword">write</span> <span class="token punctuation">(</span>center<span class="token punctuation">(</span><span class="token string">'then TAPES.EXE must be in current directory or in the PATH.'</span><span class="token punctuation">,</span><span class="token number">79</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">221</td><td>              ding<span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">222</td><td>              RestoreWindow<span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">223</td><td>              <span class="token keyword">exit</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">224</td><td>            <span class="token keyword">end</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">225</td><td>        <span class="token keyword">end</span></td></tr>
<tr><td class="line-number">226</td><td>      <span class="token keyword">else</span></td></tr>
<tr><td class="line-number">227</td><td>        filename <span class="token operator">:=</span> paramstr <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">228</td><td>      newbias <span class="token operator">:=</span> biastype<span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">229</td><td>      newnoise <span class="token operator">:=</span> noisetype<span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">230</td><td>      newlpt <span class="token operator">:=</span> lpttype<span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">231</td><td>      newprn <span class="token operator">:=</span> prntype<span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">232</td><td>      vbSize<span class="token operator">:=</span> Ofs<span class="token punctuation">(</span>LastByte<span class="token punctuation">)</span><span class="token operator">-</span>Ofs<span class="token punctuation">(</span>idheader<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">{Segments will be equal.}</span></td></tr>
<tr><td class="line-number">233</td><td>      SaveWindow<span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">234</td><td>      TextColor <span class="token punctuation">(</span>Yellow<span class="token punctuation">)</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">235</td><td>      GotoXY <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">)</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">236</td><td>      <span class="token keyword">Write</span><span class="token punctuation">(</span>Center<span class="token punctuation">(</span><span class="token string">'Updating '</span><span class="token operator">+</span> filename<span class="token operator">+</span> <span class="token string">' with new configuration information...'</span><span class="token punctuation">,</span><span class="token number">79</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">237</td><td>      <span class="token keyword">If</span> NOT PrgFileLoaded<span class="token punctuation">(</span>filename<span class="token punctuation">)</span> <span class="token keyword">then</span></td></tr>
<tr><td class="line-number">238</td><td>        <span class="token keyword">begin</span></td></tr>
<tr><td class="line-number">239</td><td>          erexit<span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">240</td><td>          <span class="token keyword">exit</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">241</td><td>        <span class="token keyword">end</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">242</td><td>      <span class="token keyword">If</span> NOT DefRecFound<span class="token punctuation">(</span><span class="token operator">@</span>idHeader<span class="token punctuation">,</span> SizeOf<span class="token punctuation">(</span>idHeader<span class="token punctuation">)</span> <span class="token punctuation">)</span> <span class="token keyword">then</span></td></tr>
<tr><td class="line-number">243</td><td>        <span class="token keyword">begin</span></td></tr>
<tr><td class="line-number">244</td><td>          ErExit<span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">245</td><td>          <span class="token keyword">exit</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">246</td><td>        <span class="token keyword">end</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">247</td><td>      ReadMemBlk<span class="token punctuation">(</span><span class="token operator">@</span>idheader<span class="token punctuation">,</span> vbSize<span class="token punctuation">)</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">248</td><td>      biastype <span class="token operator">:=</span> newbias<span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">249</td><td>      noisetype <span class="token operator">:=</span> newnoise<span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">250</td><td>      lpttype <span class="token operator">:=</span> newlpt<span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">251</td><td>      prntype <span class="token operator">:=</span> newprn<span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">252</td><td>      WriteMemBlk<span class="token punctuation">(</span><span class="token operator">@</span>idHeader<span class="token punctuation">,</span> vbSize<span class="token punctuation">)</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">253</td><td>      <span class="token keyword">If</span> NOT PrgFileSaved<span class="token punctuation">(</span>filename<span class="token punctuation">)</span> <span class="token keyword">then</span></td></tr>
<tr><td class="line-number">254</td><td>        <span class="token keyword">begin</span></td></tr>
<tr><td class="line-number">255</td><td>          ErExit<span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">256</td><td>          <span class="token keyword">exit</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">257</td><td>        <span class="token keyword">end</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">258</td><td>      GotoXY <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">25</span><span class="token punctuation">)</span> <span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">259</td><td>      ClrEol <span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">260</td><td>      RestoreWindow<span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">261</td><td>   <span class="token keyword">end</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">262</td><td></td></tr>
<tr><td class="line-number">263</td><td></td></tr>
<tr><td class="line-number">264</td><td>  <span class="token keyword">Procedure</span> TitlePage<span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">265</td><td>      <span class="token keyword">var</span> VerS <span class="token punctuation">:</span> <span class="token keyword">string</span> <span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">266</td><td></td></tr>
<tr><td class="line-number">267</td><td>      <span class="token keyword">begin</span></td></tr>
<tr><td class="line-number">268</td><td>        ClrScr<span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">269</td><td>        TextColor <span class="token punctuation">(</span>MapColor <span class="token punctuation">(</span>Yellow<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">270</td><td>        str <span class="token punctuation">(</span>Version<span class="token punctuation">:</span><span class="token number">5</span><span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">,</span> VerS<span class="token punctuation">)</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">271</td><td>        writeln<span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">272</td><td>        Writeln <span class="token punctuation">(</span>Center <span class="token punctuation">(</span><span class="token string">'??? T A P E S - V'</span><span class="token operator">+</span>VerS<span class="token operator">+</span><span class="token string">' ???'</span><span class="token punctuation">,</span>currentwidth<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">273</td><td>        writeln<span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">274</td><td>        writeln<span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">275</td><td>        TextColor <span class="token punctuation">(</span>MapColor <span class="token punctuation">(</span>LightRed<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">276</td><td>        kindlco<span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">277</td><td>        writeln<span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">278</td><td>        TextColor <span class="token punctuation">(</span>MapColor <span class="token punctuation">(</span>White<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">279</td><td>        writeln <span class="token punctuation">(</span>Center <span class="token punctuation">(</span><span class="token string">'This program is FreeWare'</span><span class="token punctuation">,</span>currentwidth<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">280</td><td>        writeln <span class="token punctuation">(</span>Center <span class="token punctuation">(</span><span class="token string">'If you find it useful please send a donation ($5) to'</span><span class="token punctuation">,</span>currentwidth<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">281</td><td>        writeln<span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">282</td><td>        writeln <span class="token punctuation">(</span>Center <span class="token punctuation">(</span><span class="token string">'Charles E. Kindel, Kindlco Software Systems'</span><span class="token punctuation">,</span>currentwidth<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">283</td><td>        writeln <span class="token punctuation">(</span>Center <span class="token punctuation">(</span><span class="token string">'4225 North First Ave, #1315'</span><span class="token punctuation">,</span>currentwidth<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">284</td><td>        writeln <span class="token punctuation">(</span>Center <span class="token punctuation">(</span><span class="token string">'Tucson, AZ  85719'</span><span class="token punctuation">,</span>currentwidth<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">285</td><td>      <span class="token keyword">end</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">286</td><td></td></tr>
<tr><td class="line-number">287</td><td>  <span class="token keyword">Procedure</span> PrintInsertMode<span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">288</td><td>    <span class="token keyword">begin</span></td></tr>
<tr><td class="line-number">289</td><td>      GotoXY <span class="token punctuation">(</span><span class="token number">71</span><span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">)</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">290</td><td>      TextBackground <span class="token punctuation">(</span>MapColor <span class="token punctuation">(</span>Red<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> TextColor <span class="token punctuation">(</span>black<span class="token punctuation">)</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">291</td><td>      <span class="token keyword">if</span> InsertMode <span class="token keyword">then</span></td></tr>
<tr><td class="line-number">292</td><td>        <span class="token keyword">begin</span></td></tr>
<tr><td class="line-number">293</td><td>          <span class="token keyword">write</span> <span class="token punctuation">(</span><span class="token string">' Insert  '</span><span class="token punctuation">)</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">294</td><td>          NormalCursor<span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">295</td><td>        <span class="token keyword">end</span></td></tr>
<tr><td class="line-number">296</td><td>      <span class="token keyword">else</span></td></tr>
<tr><td class="line-number">297</td><td>        <span class="token keyword">begin</span></td></tr>
<tr><td class="line-number">298</td><td>          <span class="token keyword">write</span> <span class="token punctuation">(</span><span class="token string">'Overwrite'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">299</td><td>          BlockCursor<span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">300</td><td>        <span class="token keyword">end</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">301</td><td>      TextBackground <span class="token punctuation">(</span>Black<span class="token punctuation">)</span><span class="token punctuation">;</span> TextColor <span class="token punctuation">(</span>white<span class="token punctuation">)</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">302</td><td>    <span class="token keyword">end</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">303</td><td></td></tr>
<tr><td class="line-number">304</td><td>  <span class="token keyword">Procedure</span> StatLine<span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">305</td><td>    <span class="token keyword">begin</span></td></tr>
<tr><td class="line-number">306</td><td>      ClearstatLine<span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">307</td><td>      TextColor <span class="token punctuation">(</span>MapCOlor<span class="token punctuation">(</span>LightCyan<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">308</td><td>      GotoXY <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">25</span><span class="token punctuation">)</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">309</td><td>      <span class="token keyword">write</span> <span class="token punctuation">(</span>Center <span class="token punctuation">(</span><span class="token string">'Press [ESC] for menu or [F10] to quit'</span><span class="token punctuation">,</span><span class="token number">79</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">310</td><td>      PrintInsertMode<span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">311</td><td>    <span class="token keyword">end</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">312</td><td></td></tr>
<tr><td class="line-number">313</td><td>  <span class="token keyword">Procedure</span> DataOut<span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">314</td><td>    <span class="token keyword">var</span> Side<span class="token punctuation">,</span> Field<span class="token punctuation">,</span> Song <span class="token punctuation">:</span> byte<span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">315</td><td></td></tr>
<tr><td class="line-number">316</td><td>    <span class="token keyword">begin</span></td></tr>
<tr><td class="line-number">317</td><td>      <span class="token keyword">For</span> Side <span class="token operator">:=</span> <span class="token number">0</span> <span class="token keyword">to</span> <span class="token number">1</span> <span class="token keyword">do</span></td></tr>
<tr><td class="line-number">318</td><td>        <span class="token keyword">begin</span></td></tr>
<tr><td class="line-number">319</td><td>          <span class="token keyword">case</span> Side <span class="token keyword">of</span></td></tr>
<tr><td class="line-number">320</td><td>            <span class="token number">0</span> <span class="token punctuation">:</span> <span class="token keyword">begin</span></td></tr>
<tr><td class="line-number">321</td><td>                  Window <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">39</span><span class="token punctuation">,</span><span class="token number">23</span><span class="token punctuation">)</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">322</td><td>                  ClrScr<span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">323</td><td>                  GotoXY <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">write</span> <span class="token punctuation">(</span>Song_Names<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">324</td><td>                <span class="token keyword">end</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">325</td><td>            <span class="token number">1</span> <span class="token punctuation">:</span> <span class="token keyword">begin</span></td></tr>
<tr><td class="line-number">326</td><td>                  Window <span class="token punctuation">(</span><span class="token number">42</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">79</span><span class="token punctuation">,</span> <span class="token number">23</span><span class="token punctuation">)</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">327</td><td>                  ClrScr<span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">328</td><td>                  GotoXY <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">write</span> <span class="token punctuation">(</span>Song_Names<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">329</td><td>                <span class="token keyword">end</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">330</td><td>          <span class="token keyword">end</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">331</td><td>          GotoXY <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">332</td><td>          <span class="token keyword">For</span> i <span class="token operator">:=</span> <span class="token number">1</span> <span class="token keyword">to</span> <span class="token number">38</span> <span class="token keyword">do</span> <span class="token keyword">Write</span> <span class="token punctuation">(</span>Horiz<span class="token punctuation">)</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">333</td><td>          <span class="token keyword">For</span> Song <span class="token operator">:=</span> <span class="token number">2</span> <span class="token keyword">to</span> <span class="token number">19</span> <span class="token keyword">do</span></td></tr>
<tr><td class="line-number">334</td><td>            <span class="token keyword">begin</span></td></tr>
<tr><td class="line-number">335</td><td>              Field <span class="token operator">:=</span> Song <span class="token operator">+</span> <span class="token punctuation">(</span>Side<span class="token operator">*</span><span class="token number">19</span><span class="token punctuation">)</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">336</td><td>              GotoXY <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token operator">+</span>Song<span class="token punctuation">)</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">337</td><td>              <span class="token keyword">write</span> <span class="token punctuation">(</span><span class="token string">'  '</span><span class="token punctuation">,</span> Song_Names<span class="token punctuation">[</span>Field<span class="token punctuation">]</span><span class="token punctuation">)</span></td></tr>
<tr><td class="line-number">338</td><td>            <span class="token keyword">end</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">339</td><td>        <span class="token keyword">end</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">340</td><td>        Window <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> CurrentWidth<span class="token punctuation">,</span> CurrentHeight<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">341</td><td>    <span class="token keyword">end</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">342</td><td></td></tr>
<tr><td class="line-number">343</td><td>  <span class="token keyword">Procedure</span> ScreenOut<span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">344</td><td>  <span class="token comment">{outputs the data and the field numbers to the screen}</span></td></tr>
<tr><td class="line-number">345</td><td></td></tr>
<tr><td class="line-number">346</td><td>    <span class="token keyword">Var</span>   Row<span class="token punctuation">,</span></td></tr>
<tr><td class="line-number">347</td><td>          Line<span class="token punctuation">,</span></td></tr>
<tr><td class="line-number">348</td><td>          Htab<span class="token punctuation">,</span></td></tr>
<tr><td class="line-number">349</td><td>          Vtab<span class="token punctuation">,</span></td></tr>
<tr><td class="line-number">350</td><td>          Field</td></tr>
<tr><td class="line-number">351</td><td>          <span class="token punctuation">:</span> byte<span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">352</td><td>          temp</td></tr>
<tr><td class="line-number">353</td><td>          <span class="token punctuation">:</span> <span class="token keyword">string</span> <span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">354</td><td></td></tr>
<tr><td class="line-number">355</td><td>  <span class="token keyword">Begin</span></td></tr>
<tr><td class="line-number">356</td><td>      window <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> CurrentWidth<span class="token punctuation">,</span> CurrentHeight<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">357</td><td>      ClrScr<span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">358</td><td>      TextColor <span class="token punctuation">(</span>MapColor <span class="token punctuation">(</span><span class="token number">14</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> TextBackground <span class="token punctuation">(</span>MapColor <span class="token punctuation">(</span>black<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">359</td><td>      Frame <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">,</span> <span class="token number">24</span><span class="token punctuation">)</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">360</td><td>      Frame <span class="token punctuation">(</span><span class="token number">41</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">,</span> <span class="token number">24</span><span class="token punctuation">)</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">361</td><td>      GotoXY <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">Write</span> <span class="token punctuation">(</span>Left_T<span class="token punctuation">)</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">362</td><td>      GotoXY <span class="token punctuation">(</span><span class="token number">40</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">Write</span> <span class="token punctuation">(</span>Right_T<span class="token punctuation">,</span> Left_T<span class="token punctuation">)</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">363</td><td>      GotoXY <span class="token punctuation">(</span><span class="token number">80</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">Write</span> <span class="token punctuation">(</span>Right_T<span class="token punctuation">)</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">364</td><td>      TextColor <span class="token punctuation">(</span>MapColor <span class="token punctuation">(</span>white<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> TextBackground <span class="token punctuation">(</span>black<span class="token punctuation">)</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">365</td><td>      GotoXY <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">366</td><td>      Str<span class="token punctuation">(</span>Version<span class="token punctuation">:</span><span class="token number">4</span><span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">,</span>Temp<span class="token punctuation">)</span> <span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">367</td><td>      ClrEol <span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">368</td><td>      <span class="token keyword">write</span> <span class="token punctuation">(</span>Center <span class="token punctuation">(</span><span class="token string">'TAPES V'</span><span class="token operator">+</span>Temp<span class="token operator">+</span><span class="token string">'   Kindlco Software Systems'</span><span class="token punctuation">,</span><span class="token number">79</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">369</td><td>      GotoXY <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">370</td><td>      ClrEol <span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">371</td><td>      <span class="token keyword">Write</span> <span class="token punctuation">(</span>Center <span class="token punctuation">(</span><span class="token string">'Copyright (C) 1986-'</span><span class="token operator">+</span>Long2Str<span class="token punctuation">(</span>Year<span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">' Charles E. Kindel, Jr.'</span><span class="token punctuation">,</span><span class="token number">79</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">372</td><td>      TextColor <span class="token punctuation">(</span>MapColor <span class="token punctuation">(</span>LightGreen<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">373</td><td>      GotoXY <span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">write</span> <span class="token punctuation">(</span><span class="token string">' Side A '</span><span class="token punctuation">)</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">374</td><td>      GotoXY <span class="token punctuation">(</span><span class="token number">55</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">write</span> <span class="token punctuation">(</span><span class="token string">' Side B '</span><span class="token punctuation">)</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">375</td><td>      StatLine<span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">376</td><td>    <span class="token keyword">end</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">377</td><td></td></tr>
<tr><td class="line-number">378</td><td>  <span class="token keyword">Procedure</span> CleanUp<span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">379</td><td>    <span class="token keyword">var</span></td></tr>
<tr><td class="line-number">380</td><td>       i</td></tr>
<tr><td class="line-number">381</td><td>       <span class="token punctuation">:</span> byte<span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">382</td><td></td></tr>
<tr><td class="line-number">383</td><td>    <span class="token keyword">begin</span></td></tr>
<tr><td class="line-number">384</td><td>      <span class="token keyword">for</span> i <span class="token operator">:=</span> <span class="token number">1</span> <span class="token keyword">to</span> <span class="token number">38</span> <span class="token keyword">do</span></td></tr>
<tr><td class="line-number">385</td><td>        Song_Names <span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">:=</span> <span class="token string">''</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">386</td><td>      Empty <span class="token operator">:=</span> <span class="token keyword">true</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">387</td><td>      FieldNum <span class="token operator">:=</span> <span class="token number">1</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">388</td><td>      Pos <span class="token operator">:=</span> <span class="token number">1</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">389</td><td>    <span class="token keyword">end</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">390</td><td></td></tr>
<tr><td class="line-number">391</td><td>  <span class="token keyword">Procedure</span> Clear<span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">392</td><td>    <span class="token keyword">var</span>  Key</td></tr>
<tr><td class="line-number">393</td><td>         <span class="token punctuation">:</span> char<span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">394</td><td></td></tr>
<tr><td class="line-number">395</td><td>    <span class="token keyword">begin</span></td></tr>
<tr><td class="line-number">396</td><td>      <span class="token keyword">if</span> <span class="token operator">not</span> empty <span class="token keyword">then</span></td></tr>
<tr><td class="line-number">397</td><td>        <span class="token keyword">begin</span></td></tr>
<tr><td class="line-number">398</td><td>          ClearStatLine<span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">399</td><td>          Ding<span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">400</td><td>          <span class="token keyword">if</span> <span class="token operator">not</span> MakeWindow <span class="token punctuation">(</span>UtilWin<span class="token punctuation">,</span> <span class="token number">22</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">60</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span> <span class="token keyword">True</span><span class="token punctuation">,</span> <span class="token keyword">True</span><span class="token punctuation">,</span> <span class="token keyword">False</span><span class="token punctuation">,</span></td></tr>
<tr><td class="line-number">401</td><td>                             White<span class="token punctuation">,</span> Yellow<span class="token punctuation">,</span> LightRed<span class="token punctuation">,</span> <span class="token string">' Clear '</span><span class="token punctuation">)</span></td></tr>
<tr><td class="line-number">402</td><td>          <span class="token keyword">then</span></td></tr>
<tr><td class="line-number">403</td><td>            writeln <span class="token punctuation">(</span><span class="token string">'ERROR: MakeWindow'</span><span class="token punctuation">)</span></td></tr>
<tr><td class="line-number">404</td><td>          <span class="token keyword">else</span></td></tr>
<tr><td class="line-number">405</td><td>            <span class="token keyword">if</span> <span class="token operator">not</span> DisplayWindow <span class="token punctuation">(</span>UtilWin<span class="token punctuation">)</span> <span class="token keyword">then</span></td></tr>
<tr><td class="line-number">406</td><td>              writeln <span class="token punctuation">(</span><span class="token string">'ERROR: DisplayWindow'</span><span class="token punctuation">)</span></td></tr>
<tr><td class="line-number">407</td><td>            <span class="token keyword">else</span></td></tr>
<tr><td class="line-number">408</td><td>              <span class="token keyword">begin</span></td></tr>
<tr><td class="line-number">409</td><td>                Window <span class="token punctuation">(</span><span class="token number">22</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token number">60</span><span class="token punctuation">,</span><span class="token number">13</span><span class="token punctuation">)</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">410</td><td>                Key <span class="token operator">:=</span> <span class="token string">'N'</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">411</td><td>                GotoXY <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">412</td><td>                <span class="token keyword">Write</span> <span class="token punctuation">(</span>Center <span class="token punctuation">(</span><span class="token string">'Are you sure you want to clear'</span><span class="token punctuation">,</span><span class="token number">36</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">413</td><td>                GotoXY <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">414</td><td>                <span class="token keyword">write</span> <span class="token punctuation">(</span>Center<span class="token punctuation">(</span><span class="token string">'the data [y/N]?'</span><span class="token punctuation">,</span><span class="token number">36</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">415</td><td>                Key <span class="token operator">:=</span> ReadKey<span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">416</td><td>                UtilWin <span class="token operator">:=</span> EraseTopWindow<span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">417</td><td>                DisposeWindow <span class="token punctuation">(</span>UtilWin<span class="token punctuation">)</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">418</td><td>                Window <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span>CurrentWidth<span class="token punctuation">,</span>CurrentHeight<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">419</td><td>                <span class="token keyword">if</span> <span class="token punctuation">(</span>UpCase <span class="token punctuation">(</span>Key<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token string">'Y'</span><span class="token punctuation">)</span> <span class="token keyword">then</span></td></tr>
<tr><td class="line-number">420</td><td>                  <span class="token keyword">begin</span></td></tr>
<tr><td class="line-number">421</td><td>                    Cleanup<span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">422</td><td>                    DataOut<span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">423</td><td>                  <span class="token keyword">end</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">424</td><td>              <span class="token keyword">end</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">425</td><td>          StatLine<span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">426</td><td>        <span class="token keyword">end</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">427</td><td>     <span class="token keyword">end</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">428</td><td></td></tr>
<tr><td class="line-number">429</td><td></td></tr>
<tr><td class="line-number">430</td><td></td></tr>
<tr><td class="line-number">431</td><td>  <span class="token keyword">Procedure</span> Quit<span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">432</td><td>    <span class="token keyword">var</span>  Key</td></tr>
<tr><td class="line-number">433</td><td>         <span class="token punctuation">:</span> char<span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">434</td><td></td></tr>
<tr><td class="line-number">435</td><td>    <span class="token keyword">begin</span></td></tr>
<tr><td class="line-number">436</td><td>      <span class="token keyword">if</span> <span class="token operator">not</span> empty <span class="token keyword">then</span></td></tr>
<tr><td class="line-number">437</td><td>        <span class="token keyword">begin</span></td></tr>
<tr><td class="line-number">438</td><td>          ClearStatline<span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">439</td><td>          Ding<span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">440</td><td>          <span class="token keyword">if</span> <span class="token operator">not</span> MakeWindow <span class="token punctuation">(</span>UtilWin<span class="token punctuation">,</span> <span class="token number">22</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">60</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span> <span class="token keyword">True</span><span class="token punctuation">,</span> <span class="token keyword">True</span><span class="token punctuation">,</span> <span class="token keyword">False</span><span class="token punctuation">,</span></td></tr>
<tr><td class="line-number">441</td><td>                             White<span class="token punctuation">,</span> LightBlue<span class="token punctuation">,</span> LightGreen<span class="token punctuation">,</span> <span class="token string">' Quit '</span><span class="token punctuation">)</span></td></tr>
<tr><td class="line-number">442</td><td>          <span class="token keyword">then</span></td></tr>
<tr><td class="line-number">443</td><td>            writeln <span class="token punctuation">(</span><span class="token string">'ERROR: MakeWindow'</span><span class="token punctuation">)</span></td></tr>
<tr><td class="line-number">444</td><td>          <span class="token keyword">else</span></td></tr>
<tr><td class="line-number">445</td><td>            <span class="token keyword">if</span> <span class="token operator">not</span> DisplayWindow <span class="token punctuation">(</span>UtilWin<span class="token punctuation">)</span> <span class="token keyword">then</span></td></tr>
<tr><td class="line-number">446</td><td>              writeln <span class="token punctuation">(</span><span class="token string">'ERROR: DisplayWindow'</span><span class="token punctuation">)</span></td></tr>
<tr><td class="line-number">447</td><td>            <span class="token keyword">else</span></td></tr>
<tr><td class="line-number">448</td><td>              <span class="token keyword">begin</span></td></tr>
<tr><td class="line-number">449</td><td>                Window <span class="token punctuation">(</span><span class="token number">22</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token number">60</span><span class="token punctuation">,</span><span class="token number">13</span><span class="token punctuation">)</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">450</td><td>                Key <span class="token operator">:=</span> <span class="token string">'N'</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">451</td><td>                GotoXY <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">452</td><td>                <span class="token keyword">write</span> <span class="token punctuation">(</span>center <span class="token punctuation">(</span><span class="token string">'Are you sure you want to quit'</span><span class="token punctuation">,</span><span class="token number">36</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">453</td><td>                GotoXY <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">454</td><td>                <span class="token keyword">write</span> <span class="token punctuation">(</span>Center<span class="token punctuation">(</span><span class="token string">'[y/N]?'</span><span class="token punctuation">,</span><span class="token number">36</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">455</td><td>                Key <span class="token operator">:=</span> ReadKey<span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">456</td><td>                <span class="token keyword">if</span> <span class="token punctuation">(</span>UpCase <span class="token punctuation">(</span>Key<span class="token punctuation">)</span> <span class="token operator">&lt;></span> <span class="token string">'Y'</span><span class="token punctuation">)</span> <span class="token keyword">then</span></td></tr>
<tr><td class="line-number">457</td><td>                  QuitFlag <span class="token operator">:=</span> <span class="token keyword">False</span></td></tr>
<tr><td class="line-number">458</td><td>                <span class="token keyword">else</span></td></tr>
<tr><td class="line-number">459</td><td>                  QuitFlag <span class="token operator">:=</span> <span class="token keyword">True</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">460</td><td>                UtilWin <span class="token operator">:=</span> EraseTopWindow<span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">461</td><td>                DisposeWindow <span class="token punctuation">(</span>UtilWin<span class="token punctuation">)</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">462</td><td>              <span class="token keyword">end</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">463</td><td>          Window <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span>CurrentWidth<span class="token punctuation">,</span>CurrentHeight<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">464</td><td>          StatLine<span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">465</td><td>        <span class="token keyword">end</span></td></tr>
<tr><td class="line-number">466</td><td>      <span class="token keyword">else</span></td></tr>
<tr><td class="line-number">467</td><td>        QuitFlag <span class="token operator">:=</span> <span class="token keyword">True</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">468</td><td>    <span class="token keyword">end</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">469</td><td></td></tr>
<tr><td class="line-number">470</td><td></td></tr>
<tr><td class="line-number">471</td><td>  <span class="token keyword">Procedure</span> Print<span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">472</td><td>    <span class="token keyword">Var</span>  i<span class="token punctuation">,</span></td></tr>
<tr><td class="line-number">473</td><td>         Field <span class="token punctuation">:</span> byte<span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">474</td><td>         Yr<span class="token punctuation">,</span> Mo<span class="token punctuation">,</span> Day<span class="token punctuation">,</span> DayOfWeek <span class="token punctuation">:</span>word<span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">475</td><td>         DateStr <span class="token punctuation">:</span><span class="token keyword">string</span> <span class="token punctuation">[</span><span class="token number">30</span><span class="token punctuation">]</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">476</td><td></td></tr>
<tr><td class="line-number">477</td><td>     <span class="token keyword">Procedure</span> PrintField<span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">478</td><td>       <span class="token keyword">begin</span></td></tr>
<tr><td class="line-number">479</td><td>         <span class="token keyword">if</span> Field <span class="token operator">=</span> <span class="token number">1</span> <span class="token keyword">then</span></td></tr>
<tr><td class="line-number">480</td><td>           <span class="token keyword">begin</span></td></tr>
<tr><td class="line-number">481</td><td>             <span class="token keyword">write</span> <span class="token punctuation">(</span>Lst<span class="token punctuation">,</span> Printers<span class="token punctuation">[</span>prntype<span class="token punctuation">]</span><span class="token punctuation">.</span>Bold_On<span class="token punctuation">)</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">482</td><td>             <span class="token keyword">write</span> <span class="token punctuation">(</span>Lst<span class="token punctuation">,</span> <span class="token string">'| '</span><span class="token punctuation">,</span> copy <span class="token punctuation">(</span>Song_Names<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">483</td><td>             <span class="token keyword">write</span> <span class="token punctuation">(</span>Lst<span class="token punctuation">,</span> <span class="token string">' '</span><span class="token punctuation">:</span><span class="token punctuation">(</span><span class="token number">34</span> <span class="token operator">-</span> length <span class="token punctuation">(</span>copy <span class="token punctuation">(</span>Song_Names<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">484</td><td>             <span class="token keyword">write</span> <span class="token punctuation">(</span>Lst<span class="token punctuation">,</span> copy<span class="token punctuation">(</span>Song_Names<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">485</td><td>             <span class="token keyword">if</span> <span class="token punctuation">(</span>length <span class="token punctuation">(</span>copy <span class="token punctuation">(</span>Song_Names<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&lt;></span> <span class="token number">32</span><span class="token punctuation">)</span> <span class="token keyword">then</span></td></tr>
<tr><td class="line-number">486</td><td>               <span class="token keyword">write</span> <span class="token punctuation">(</span>Lst<span class="token punctuation">,</span> <span class="token string">' '</span><span class="token punctuation">:</span><span class="token punctuation">(</span><span class="token number">32</span> <span class="token operator">-</span> length <span class="token punctuation">(</span>copy<span class="token punctuation">(</span>Song_Names<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">487</td><td>             writeln <span class="token punctuation">(</span>Lst<span class="token punctuation">,</span> <span class="token string">'|'</span><span class="token punctuation">,</span> Printers<span class="token punctuation">[</span>PrnType<span class="token punctuation">]</span><span class="token punctuation">.</span>Bold_Off<span class="token punctuation">)</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">488</td><td>           <span class="token keyword">end</span></td></tr>
<tr><td class="line-number">489</td><td>         <span class="token keyword">else</span></td></tr>
<tr><td class="line-number">490</td><td>           <span class="token keyword">begin</span></td></tr>
<tr><td class="line-number">491</td><td>             <span class="token keyword">write</span> <span class="token punctuation">(</span>Lst<span class="token punctuation">,</span> <span class="token string">'| '</span><span class="token punctuation">,</span> Song_Names<span class="token punctuation">[</span>Field<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">492</td><td>             <span class="token keyword">write</span> <span class="token punctuation">(</span>Lst<span class="token punctuation">,</span> <span class="token string">' '</span><span class="token punctuation">:</span><span class="token punctuation">(</span><span class="token number">34</span> <span class="token operator">-</span> length <span class="token punctuation">(</span>copy <span class="token punctuation">(</span>Song_Names<span class="token punctuation">[</span>Field<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">31</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">493</td><td>             <span class="token keyword">write</span> <span class="token punctuation">(</span>Lst<span class="token punctuation">,</span> Song_Names<span class="token punctuation">[</span>Field <span class="token operator">+</span> <span class="token number">19</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">494</td><td>             <span class="token keyword">write</span> <span class="token punctuation">(</span>Lst<span class="token punctuation">,</span> <span class="token string">' '</span><span class="token punctuation">:</span><span class="token punctuation">(</span><span class="token number">32</span> <span class="token operator">-</span> length <span class="token punctuation">(</span>copy<span class="token punctuation">(</span>Song_Names<span class="token punctuation">[</span>Field<span class="token operator">+</span><span class="token number">19</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">31</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">495</td><td>             writeln <span class="token punctuation">(</span>Lst<span class="token punctuation">,</span> <span class="token string">'|'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">496</td><td>           <span class="token keyword">end</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">497</td><td>      <span class="token keyword">end</span><span class="token punctuation">;</span> <span class="token comment">{PrintField}</span></td></tr>
<tr><td class="line-number">498</td><td></td></tr>
<tr><td class="line-number">499</td><td>     <span class="token keyword">Procedure</span> PrintBlank<span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">500</td><td>       <span class="token keyword">begin</span></td></tr>
<tr><td class="line-number">501</td><td>         writeln <span class="token punctuation">(</span>Lst<span class="token punctuation">,</span> <span class="token string">'|'</span><span class="token punctuation">,</span> <span class="token string">' '</span><span class="token punctuation">:</span><span class="token number">67</span><span class="token punctuation">,</span> <span class="token string">'|'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">502</td><td>       <span class="token keyword">end</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">503</td><td></td></tr>
<tr><td class="line-number">504</td><td>     <span class="token keyword">Procedure</span> PrintLarge<span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">505</td><td>       <span class="token keyword">begin</span></td></tr>
<tr><td class="line-number">506</td><td>         <span class="token keyword">write</span> <span class="token punctuation">(</span>Lst<span class="token punctuation">,</span> Printers<span class="token punctuation">[</span>PrnType<span class="token punctuation">]</span><span class="token punctuation">.</span>Bold_On<span class="token punctuation">,</span>Printers<span class="token punctuation">[</span>PrnType<span class="token punctuation">]</span><span class="token punctuation">.</span>One6th<span class="token punctuation">)</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">507</td><td>         writeln <span class="token punctuation">(</span>Lst<span class="token punctuation">,</span> <span class="token string">'  '</span><span class="token punctuation">,</span> Song_Names <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">508</td><td>         <span class="token keyword">write</span> <span class="token punctuation">(</span>Lst<span class="token punctuation">,</span> <span class="token string">'  '</span><span class="token punctuation">,</span> Song_Names <span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">509</td><td>         writeln <span class="token punctuation">(</span>Lst<span class="token punctuation">,</span> Printers<span class="token punctuation">[</span>PrnType<span class="token punctuation">]</span><span class="token punctuation">.</span>Bold_Off<span class="token punctuation">)</span></td></tr>
<tr><td class="line-number">510</td><td>       <span class="token keyword">end</span><span class="token punctuation">;</span> <span class="token comment">{PrintLarge}</span></td></tr>
<tr><td class="line-number">511</td><td></td></tr>
<tr><td class="line-number">512</td><td>     <span class="token keyword">begin</span>  <span class="token comment">{Printer}</span></td></tr>
<tr><td class="line-number">513</td><td>       assign <span class="token punctuation">(</span>lst<span class="token punctuation">,</span> lptname<span class="token punctuation">[</span>lpttype<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">514</td><td>       rewrite <span class="token punctuation">(</span>lst<span class="token punctuation">)</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">515</td><td>       writeln <span class="token punctuation">(</span>Lst<span class="token punctuation">,</span> Printers<span class="token punctuation">[</span>PrnType<span class="token punctuation">]</span><span class="token punctuation">.</span>One8th <span class="token punctuation">,</span> Printers<span class="token punctuation">[</span>PrnType<span class="token punctuation">]</span><span class="token punctuation">.</span>Comp_On<span class="token punctuation">)</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">516</td><td>       <span class="token keyword">for</span> i <span class="token operator">:=</span> <span class="token number">1</span>  <span class="token keyword">to</span> <span class="token number">69</span> <span class="token keyword">do</span></td></tr>
<tr><td class="line-number">517</td><td>         <span class="token keyword">write</span> <span class="token punctuation">(</span>Lst<span class="token punctuation">,</span> <span class="token string">'-'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">518</td><td>       writeln <span class="token punctuation">(</span>Lst<span class="token punctuation">)</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">519</td><td>       <span class="token keyword">for</span> Field <span class="token operator">:=</span> <span class="token number">1</span> <span class="token keyword">to</span> <span class="token number">19</span> <span class="token keyword">do</span></td></tr>
<tr><td class="line-number">520</td><td>         <span class="token keyword">begin</span></td></tr>
<tr><td class="line-number">521</td><td>           PrintField<span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">522</td><td>           <span class="token keyword">if</span> Field <span class="token operator">=</span> <span class="token number">1</span> <span class="token keyword">then</span> PrintBlank<span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">523</td><td>         <span class="token keyword">end</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">524</td><td>       Writeln <span class="token punctuation">(</span>Lst<span class="token punctuation">,</span> Printers<span class="token punctuation">[</span>PrnType<span class="token punctuation">]</span><span class="token punctuation">.</span>Comp_Off<span class="token punctuation">)</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">525</td><td>       PrintLarge<span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">526</td><td>       writeln <span class="token punctuation">(</span>Lst<span class="token punctuation">,</span> Printers<span class="token punctuation">[</span>PrnType<span class="token punctuation">]</span><span class="token punctuation">.</span>One8th<span class="token punctuation">,</span> Printers<span class="token punctuation">[</span>PrnType<span class="token punctuation">]</span><span class="token punctuation">.</span>Comp_On<span class="token punctuation">)</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">527</td><td>       PrintBlank<span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">528</td><td>       writeln <span class="token punctuation">(</span>Lst<span class="token punctuation">,</span> <span class="token string">'| '</span><span class="token punctuation">,</span> bias<span class="token punctuation">[</span>biastype<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">' '</span><span class="token punctuation">:</span><span class="token number">66</span><span class="token operator">-</span>Length<span class="token punctuation">(</span>Bias<span class="token punctuation">[</span>Biastype<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">'|'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">529</td><td>       writeln <span class="token punctuation">(</span>Lst<span class="token punctuation">,</span> <span class="token string">'| Noise Reduction: '</span><span class="token punctuation">,</span>Noise<span class="token punctuation">[</span>Noisetype<span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token string">' '</span><span class="token punctuation">:</span><span class="token number">49</span><span class="token operator">-</span>Length<span class="token punctuation">(</span>Noise<span class="token punctuation">[</span>Noisetype<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">'|'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">530</td><td>       GetDate <span class="token punctuation">(</span>Yr<span class="token punctuation">,</span> Mo<span class="token punctuation">,</span> Day<span class="token punctuation">,</span> DayofWeek<span class="token punctuation">)</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">531</td><td>       DateStr <span class="token operator">:=</span> DayOfWeek_<span class="token punctuation">[</span>DayofWeek<span class="token punctuation">]</span><span class="token operator">+</span><span class="token string">' '</span><span class="token operator">+</span>Month_<span class="token punctuation">[</span>mo<span class="token punctuation">]</span><span class="token operator">+</span><span class="token string">' '</span><span class="token operator">+</span>Long2Str<span class="token punctuation">(</span>Day<span class="token punctuation">)</span> <span class="token operator">+</span><span class="token string">', '</span><span class="token operator">+</span>Long2Str<span class="token punctuation">(</span>Yr<span class="token punctuation">)</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">532</td><td>       writeln <span class="token punctuation">(</span>Lst<span class="token punctuation">,</span> <span class="token string">'|'</span><span class="token punctuation">,</span> <span class="token string">' '</span><span class="token punctuation">:</span><span class="token number">66</span><span class="token operator">-</span>Length<span class="token punctuation">(</span>DateStr<span class="token punctuation">)</span><span class="token punctuation">,</span> DateStr<span class="token punctuation">,</span><span class="token string">' |'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">533</td><td>       <span class="token keyword">for</span> i <span class="token operator">:=</span> <span class="token number">1</span> <span class="token keyword">to</span> <span class="token number">69</span> <span class="token keyword">do</span> <span class="token keyword">write</span> <span class="token punctuation">(</span>Lst<span class="token punctuation">,</span> <span class="token string">'-'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">534</td><td>       <span class="token keyword">for</span> i <span class="token operator">:=</span> <span class="token number">1</span> <span class="token keyword">to</span> <span class="token number">3</span> <span class="token keyword">do</span> writeln <span class="token punctuation">(</span>Lst<span class="token punctuation">)</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">535</td><td>       <span class="token keyword">if</span> New_Page <span class="token keyword">then</span> writeln <span class="token punctuation">(</span>Lst<span class="token punctuation">,</span> chr<span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">536</td><td>       writeln <span class="token punctuation">(</span>Lst<span class="token punctuation">,</span> Printers<span class="token punctuation">[</span>PrnType<span class="token punctuation">]</span><span class="token punctuation">.</span>One6th<span class="token punctuation">,</span> Printers<span class="token punctuation">[</span>PrnType<span class="token punctuation">]</span><span class="token punctuation">.</span>Comp_Off<span class="token punctuation">)</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">537</td><td>       close <span class="token punctuation">(</span>lst<span class="token punctuation">)</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">538</td><td>     <span class="token keyword">end</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">539</td><td></td></tr>
<tr><td class="line-number">540</td><td></td></tr>
<tr><td class="line-number">541</td><td></td></tr>
<tr><td class="line-number">542</td><td></td></tr>
<tr><td class="line-number">543</td><td>  <span class="token keyword">Procedure</span> Menu<span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">544</td><td>    <span class="token keyword">const</span></td></tr>
<tr><td class="line-number">545</td><td>       MenuItem <span class="token punctuation">:</span> <span class="token keyword">array</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token operator">..</span><span class="token number">8</span><span class="token punctuation">]</span> <span class="token keyword">of</span> <span class="token keyword">string</span> <span class="token punctuation">[</span><span class="token number">30</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token string">'Print a Cassette Insert.'</span><span class="token punctuation">,</span> <span class="token string">'Clear Data Now In Memory.'</span><span class="token punctuation">,</span> <span class="token string">'Tape Type:'</span><span class="token punctuation">,</span></td></tr>
<tr><td class="line-number">546</td><td>                                            <span class="token string">'Noise Reduction:'</span><span class="token punctuation">,</span> <span class="token string">'Lpt Port:'</span><span class="token punctuation">,</span></td></tr>
<tr><td class="line-number">547</td><td>                                            <span class="token string">'Install Printer:'</span><span class="token punctuation">,</span><span class="token string">'Save Default Configuration.'</span><span class="token punctuation">,</span></td></tr>
<tr><td class="line-number">548</td><td>                                            <span class="token string">'Quit TAPES and exit to Dos.'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">549</td><td>    <span class="token keyword">var</span></td></tr>
<tr><td class="line-number">550</td><td>       i <span class="token punctuation">:</span> byte<span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">551</td><td>       Dummy <span class="token punctuation">:</span> char <span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">552</td><td></td></tr>
<tr><td class="line-number">553</td><td>        <span class="token keyword">Procedure</span> BiasPrint<span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">554</td><td>          <span class="token keyword">var</span> i<span class="token punctuation">:</span>byte<span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">555</td><td>          <span class="token keyword">begin</span></td></tr>
<tr><td class="line-number">556</td><td>            GotoXY <span class="token punctuation">(</span><span class="token number">22</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">557</td><td>            <span class="token keyword">for</span> i <span class="token operator">:=</span> <span class="token number">1</span> <span class="token keyword">to</span> <span class="token number">3</span> <span class="token keyword">do</span></td></tr>
<tr><td class="line-number">558</td><td>              <span class="token keyword">begin</span></td></tr>
<tr><td class="line-number">559</td><td>                <span class="token keyword">if</span> biastype <span class="token operator">=</span> i <span class="token keyword">then</span></td></tr>
<tr><td class="line-number">560</td><td>                  TextColor <span class="token punctuation">(</span>Yellow<span class="token punctuation">)</span></td></tr>
<tr><td class="line-number">561</td><td>                <span class="token keyword">else</span></td></tr>
<tr><td class="line-number">562</td><td>                  TextColor <span class="token punctuation">(</span>LightGray<span class="token punctuation">)</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">563</td><td>                <span class="token keyword">write</span> <span class="token punctuation">(</span>copy <span class="token punctuation">(</span>bias<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">'   '</span><span class="token punctuation">)</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">564</td><td>             <span class="token keyword">end</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">565</td><td>          <span class="token keyword">end</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">566</td><td></td></tr>
<tr><td class="line-number">567</td><td>        <span class="token keyword">Procedure</span> NoisePrint<span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">568</td><td>          <span class="token keyword">var</span> i<span class="token punctuation">:</span>byte<span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">569</td><td>          <span class="token keyword">begin</span></td></tr>
<tr><td class="line-number">570</td><td>            GotoXY <span class="token punctuation">(</span><span class="token number">22</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">571</td><td>            <span class="token keyword">for</span> i <span class="token operator">:=</span> <span class="token number">1</span> <span class="token keyword">to</span> <span class="token number">4</span> <span class="token keyword">do</span></td></tr>
<tr><td class="line-number">572</td><td>              <span class="token keyword">begin</span></td></tr>
<tr><td class="line-number">573</td><td>                <span class="token keyword">if</span> noisetype <span class="token operator">=</span> i <span class="token keyword">then</span></td></tr>
<tr><td class="line-number">574</td><td>                  TextColor <span class="token punctuation">(</span>Yellow<span class="token punctuation">)</span></td></tr>
<tr><td class="line-number">575</td><td>                <span class="token keyword">else</span></td></tr>
<tr><td class="line-number">576</td><td>                  TextColor <span class="token punctuation">(</span>LightGray<span class="token punctuation">)</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">577</td><td>                <span class="token keyword">write</span> <span class="token punctuation">(</span>noise<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token string">'   '</span><span class="token punctuation">)</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">578</td><td>              <span class="token keyword">end</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">579</td><td>          <span class="token keyword">end</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">580</td><td></td></tr>
<tr><td class="line-number">581</td><td>        <span class="token keyword">procedure</span> lptprint<span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">582</td><td>          <span class="token keyword">var</span> i <span class="token punctuation">:</span> byte<span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">583</td><td>          <span class="token keyword">begin</span></td></tr>
<tr><td class="line-number">584</td><td>            GotoXY <span class="token punctuation">(</span><span class="token number">22</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">585</td><td>            <span class="token keyword">for</span> i <span class="token operator">:=</span> <span class="token number">1</span> <span class="token keyword">to</span> <span class="token number">4</span> <span class="token keyword">do</span></td></tr>
<tr><td class="line-number">586</td><td>              <span class="token keyword">begin</span></td></tr>
<tr><td class="line-number">587</td><td>                <span class="token keyword">if</span> lpttype <span class="token operator">=</span> i <span class="token keyword">then</span></td></tr>
<tr><td class="line-number">588</td><td>                  TextColor <span class="token punctuation">(</span>Yellow<span class="token punctuation">)</span></td></tr>
<tr><td class="line-number">589</td><td>                <span class="token keyword">else</span></td></tr>
<tr><td class="line-number">590</td><td>                  TextColor <span class="token punctuation">(</span>LightGray<span class="token punctuation">)</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">591</td><td>                <span class="token keyword">write</span> <span class="token punctuation">(</span>lptname<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token string">'   '</span><span class="token punctuation">)</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">592</td><td>              <span class="token keyword">end</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">593</td><td>          <span class="token keyword">end</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">594</td><td></td></tr>
<tr><td class="line-number">595</td><td>        <span class="token keyword">procedure</span> prnprint<span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">596</td><td>          <span class="token keyword">var</span> i<span class="token punctuation">:</span> integer<span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">597</td><td></td></tr>
<tr><td class="line-number">598</td><td>          <span class="token keyword">begin</span></td></tr>
<tr><td class="line-number">599</td><td>            GotoXY <span class="token punctuation">(</span><span class="token number">22</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">600</td><td>            <span class="token keyword">for</span> i <span class="token operator">:=</span> <span class="token number">1</span> <span class="token keyword">to</span> <span class="token number">2</span> <span class="token keyword">do</span></td></tr>
<tr><td class="line-number">601</td><td>              <span class="token keyword">begin</span></td></tr>
<tr><td class="line-number">602</td><td>                <span class="token keyword">if</span> prntype <span class="token operator">=</span> i <span class="token keyword">then</span></td></tr>
<tr><td class="line-number">603</td><td>                  textcolor <span class="token punctuation">(</span>yellow<span class="token punctuation">)</span></td></tr>
<tr><td class="line-number">604</td><td>                <span class="token keyword">else</span></td></tr>
<tr><td class="line-number">605</td><td>                  textcolor <span class="token punctuation">(</span>lightgray<span class="token punctuation">)</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">606</td><td>                <span class="token keyword">write</span> <span class="token punctuation">(</span>prnname<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">'   '</span><span class="token punctuation">)</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">607</td><td>             <span class="token keyword">end</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">608</td><td>          <span class="token keyword">end</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">609</td><td></td></tr>
<tr><td class="line-number">610</td><td></td></tr>
<tr><td class="line-number">611</td><td></td></tr>
<tr><td class="line-number">612</td><td>    <span class="token keyword">begin</span></td></tr>
<tr><td class="line-number">613</td><td>      ClearStatLine<span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">614</td><td>      <span class="token keyword">if</span> <span class="token operator">not</span> MakeWindow <span class="token punctuation">(</span>UtilWin<span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">68</span><span class="token punctuation">,</span> <span class="token number">17</span><span class="token punctuation">,</span> <span class="token keyword">True</span><span class="token punctuation">,</span> <span class="token keyword">True</span><span class="token punctuation">,</span> <span class="token keyword">False</span><span class="token punctuation">,</span></td></tr>
<tr><td class="line-number">615</td><td>                         black<span class="token punctuation">,</span> White<span class="token punctuation">,</span> LightBlue<span class="token punctuation">,</span></td></tr>
<tr><td class="line-number">616</td><td>                         <span class="token string">' Press [ESC] to Exit Menu '</span><span class="token punctuation">)</span> <span class="token keyword">then</span></td></tr>
<tr><td class="line-number">617</td><td>          writeln <span class="token punctuation">(</span><span class="token string">'ERROR: MakeWindow'</span><span class="token punctuation">)</span></td></tr>
<tr><td class="line-number">618</td><td>      <span class="token keyword">else</span></td></tr>
<tr><td class="line-number">619</td><td>        <span class="token keyword">if</span> <span class="token operator">not</span> DisplayWindow <span class="token punctuation">(</span>utilWin<span class="token punctuation">)</span> <span class="token keyword">then</span></td></tr>
<tr><td class="line-number">620</td><td>          writeln <span class="token punctuation">(</span><span class="token string">'ERROR: DisplayWindow'</span><span class="token punctuation">)</span></td></tr>
<tr><td class="line-number">621</td><td>        <span class="token keyword">else</span></td></tr>
<tr><td class="line-number">622</td><td>          <span class="token keyword">begin</span></td></tr>
<tr><td class="line-number">623</td><td>            Window <span class="token punctuation">(</span><span class="token number">13</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">,</span><span class="token number">67</span><span class="token punctuation">,</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">624</td><td>            ClrScr<span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">625</td><td>            <span class="token keyword">for</span> i <span class="token operator">:=</span> <span class="token number">1</span> <span class="token keyword">to</span> <span class="token number">8</span> <span class="token keyword">do</span></td></tr>
<tr><td class="line-number">626</td><td>              <span class="token keyword">begin</span></td></tr>
<tr><td class="line-number">627</td><td>                TextColor <span class="token punctuation">(</span>LightRed<span class="token punctuation">)</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">628</td><td>                GotoXY <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">629</td><td>                <span class="token keyword">write</span> <span class="token punctuation">(</span>MenuItem<span class="token punctuation">[</span>i<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">630</td><td>                TextColor <span class="token punctuation">(</span>Green<span class="token punctuation">)</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">631</td><td>                <span class="token keyword">write</span> <span class="token punctuation">(</span>Copy <span class="token punctuation">(</span>MenuItem<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span>Length<span class="token punctuation">(</span>MenuItem<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">632</td><td>              <span class="token keyword">end</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">633</td><td>              BiasPrint<span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">634</td><td>              NoisePrint<span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">635</td><td>              lptPrint<span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">636</td><td>              prnPrint<span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">637</td><td>              <span class="token keyword">repeat</span></td></tr>
<tr><td class="line-number">638</td><td>                key <span class="token operator">:=</span> readkey<span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">639</td><td>                <span class="token keyword">if</span> Key <span class="token operator">=</span> <span class="token string">#0</span> <span class="token keyword">then</span></td></tr>
<tr><td class="line-number">640</td><td>                  Dummy <span class="token operator">:=</span> ReadKey<span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">641</td><td>                <span class="token keyword">case</span> Upcase<span class="token punctuation">(</span>Key<span class="token punctuation">)</span> <span class="token keyword">of</span></td></tr>
<tr><td class="line-number">642</td><td>                  <span class="token string">'P'</span> <span class="token punctuation">:</span> <span class="token keyword">Begin</span></td></tr>
<tr><td class="line-number">643</td><td>                          SaveWindow<span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">644</td><td>                          ClearStatLine<span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">645</td><td>                          GotoXY <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">25</span><span class="token punctuation">)</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">646</td><td>                          TextColor <span class="token punctuation">(</span>Yellow<span class="token punctuation">)</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">647</td><td>                          <span class="token keyword">write</span> <span class="token punctuation">(</span>Center <span class="token punctuation">(</span><span class="token string">' Printing...'</span><span class="token punctuation">,</span><span class="token number">79</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">648</td><td>                          Print<span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">649</td><td>                          GotoXY <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">25</span><span class="token punctuation">)</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">650</td><td>                          ClrEol<span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">651</td><td>                          RestoreWindow<span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">652</td><td>                          New_Page <span class="token operator">:=</span> Not New_Page<span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">653</td><td>                        <span class="token keyword">end</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">654</td><td>                  <span class="token string">'T'</span> <span class="token punctuation">:</span> <span class="token keyword">begin</span></td></tr>
<tr><td class="line-number">655</td><td>                          <span class="token keyword">case</span> BiasType <span class="token keyword">of</span></td></tr>
<tr><td class="line-number">656</td><td>                            <span class="token number">1</span> <span class="token punctuation">:</span> BiasType <span class="token operator">:=</span> <span class="token number">2</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">657</td><td>                            <span class="token number">2</span> <span class="token punctuation">:</span> BiasType <span class="token operator">:=</span> <span class="token number">3</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">658</td><td>                            <span class="token number">3</span> <span class="token punctuation">:</span> BiasType <span class="token operator">:=</span> <span class="token number">1</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">659</td><td>                          <span class="token keyword">end</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">660</td><td>                          biasprint<span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">661</td><td>                        <span class="token keyword">end</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">662</td><td>                  <span class="token string">'N'</span> <span class="token punctuation">:</span> <span class="token keyword">begin</span></td></tr>
<tr><td class="line-number">663</td><td>                          <span class="token keyword">case</span> Noisetype <span class="token keyword">of</span></td></tr>
<tr><td class="line-number">664</td><td>                            <span class="token number">1</span> <span class="token punctuation">:</span> NoiseType <span class="token operator">:=</span> <span class="token number">2</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">665</td><td>                            <span class="token number">2</span> <span class="token punctuation">:</span> NoiseType <span class="token operator">:=</span> <span class="token number">3</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">666</td><td>                            <span class="token number">3</span> <span class="token punctuation">:</span> NoiseType <span class="token operator">:=</span> <span class="token number">4</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">667</td><td>                            <span class="token number">4</span> <span class="token punctuation">:</span> NoiseType <span class="token operator">:=</span> <span class="token number">1</span></td></tr>
<tr><td class="line-number">668</td><td>                          <span class="token keyword">end</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">669</td><td>                          NoisePrint<span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">670</td><td>                        <span class="token keyword">end</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">671</td><td>                  <span class="token string">'L'</span> <span class="token punctuation">:</span> <span class="token keyword">begin</span></td></tr>
<tr><td class="line-number">672</td><td>                          <span class="token keyword">case</span> lpttype <span class="token keyword">of</span></td></tr>
<tr><td class="line-number">673</td><td>                            <span class="token number">1</span> <span class="token punctuation">:</span> lpttype <span class="token operator">:=</span> <span class="token number">2</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">674</td><td>                            <span class="token number">2</span> <span class="token punctuation">:</span> lpttype <span class="token operator">:=</span> <span class="token number">3</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">675</td><td>                            <span class="token number">3</span> <span class="token punctuation">:</span> lpttype <span class="token operator">:=</span> <span class="token number">4</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">676</td><td>                            <span class="token number">4</span> <span class="token punctuation">:</span> lpttype <span class="token operator">:=</span> <span class="token number">1</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">677</td><td>                          <span class="token keyword">end</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">678</td><td>                          lptprint<span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">679</td><td>                        <span class="token keyword">end</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">680</td><td>                  <span class="token string">'I'</span> <span class="token punctuation">:</span> <span class="token keyword">begin</span></td></tr>
<tr><td class="line-number">681</td><td>                          <span class="token keyword">case</span> prntype <span class="token keyword">of</span></td></tr>
<tr><td class="line-number">682</td><td>                            <span class="token number">1</span> <span class="token punctuation">:</span> inc<span class="token punctuation">(</span>prntype<span class="token punctuation">)</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">683</td><td>                            <span class="token number">2</span> <span class="token punctuation">:</span> prntype <span class="token operator">:=</span> <span class="token number">1</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">684</td><td>                          <span class="token keyword">end</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">685</td><td>                          prnPrint<span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">686</td><td>                        <span class="token keyword">end</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">687</td><td>                  <span class="token string">'S'</span> <span class="token punctuation">:</span> <span class="token keyword">begin</span></td></tr>
<tr><td class="line-number">688</td><td>                          SaveConfig<span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">689</td><td>                        <span class="token keyword">end</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">690</td><td>                <span class="token keyword">end</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">691</td><td>              <span class="token keyword">until</span> <span class="token punctuation">(</span>UpCase <span class="token punctuation">(</span>key<span class="token punctuation">)</span> <span class="token operator">in</span> <span class="token punctuation">[</span>ESC<span class="token punctuation">,</span><span class="token string">'C'</span><span class="token punctuation">,</span><span class="token string">'Q'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">692</td><td>          <span class="token keyword">end</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">693</td><td>      UtilWin <span class="token operator">:=</span> EraseTopWindow<span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">694</td><td>      DisposeWindow <span class="token punctuation">(</span>utilWin<span class="token punctuation">)</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">695</td><td>      Window <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span>CurrentWidth<span class="token punctuation">,</span>CurrentHeight<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">696</td><td>      <span class="token keyword">case</span> UpCase<span class="token punctuation">(</span>key<span class="token punctuation">)</span> <span class="token keyword">of</span></td></tr>
<tr><td class="line-number">697</td><td>        <span class="token string">'C'</span> <span class="token punctuation">:</span> Clear<span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">698</td><td>        <span class="token string">'Q'</span> <span class="token punctuation">:</span> Quit<span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">699</td><td>      <span class="token keyword">end</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">700</td><td>      StatLine<span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">701</td><td>    <span class="token keyword">end</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">702</td><td></td></tr>
<tr><td class="line-number">703</td><td></td></tr>
<tr><td class="line-number">704</td><td></td></tr>
<tr><td class="line-number">705</td><td>   <span class="token keyword">Function</span> GetKeyCode <span class="token punctuation">:</span> word<span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">706</td><td>     <span class="token keyword">var</span> code <span class="token punctuation">:</span> word<span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">707</td><td>         key <span class="token punctuation">:</span> char<span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">708</td><td></td></tr>
<tr><td class="line-number">709</td><td>     <span class="token keyword">begin</span></td></tr>
<tr><td class="line-number">710</td><td>       code <span class="token operator">:=</span> <span class="token number">0</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">711</td><td>       Key <span class="token operator">:=</span> ReadKey<span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">712</td><td>       <span class="token keyword">if</span> Key <span class="token operator">=</span> <span class="token string">#0</span> <span class="token keyword">then</span></td></tr>
<tr><td class="line-number">713</td><td>          <span class="token keyword">begin</span></td></tr>
<tr><td class="line-number">714</td><td>            Key <span class="token operator">:=</span> ReadKey<span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">715</td><td>            code <span class="token operator">:=</span> <span class="token number">255</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">716</td><td>          <span class="token keyword">end</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">717</td><td>       GetKeyCode <span class="token operator">:=</span> code <span class="token operator">+</span> ord <span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">718</td><td>     <span class="token keyword">end</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">719</td><td></td></tr>
<tr><td class="line-number">720</td><td></td></tr>
<tr><td class="line-number">721</td><td>   <span class="token keyword">Function</span> GetField <span class="token punctuation">(</span>    X<span class="token punctuation">,</span> Y<span class="token punctuation">,</span>                  <span class="token comment">{Screen Coords}</span></td></tr>
<tr><td class="line-number">722</td><td>                          MaxLen   <span class="token punctuation">:</span> byte<span class="token punctuation">;</span>    <span class="token comment">{Maximum length of field}</span></td></tr>
<tr><td class="line-number">723</td><td>                      <span class="token keyword">var</span> Pos      <span class="token punctuation">:</span> byte<span class="token punctuation">;</span>    <span class="token comment">{Cursor position in field}</span></td></tr>
<tr><td class="line-number">724</td><td>                      <span class="token keyword">var</span> Field    <span class="token punctuation">:</span> fieldtype   <span class="token comment">{string to hold field}</span></td></tr>
<tr><td class="line-number">725</td><td>                     <span class="token punctuation">)</span> <span class="token punctuation">:</span> word<span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">726</td><td>    <span class="token keyword">Var</span>    Len<span class="token punctuation">:</span>byte<span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">727</td><td>           KeyCode <span class="token punctuation">:</span> word<span class="token punctuation">;</span>   <span class="token comment">{current length of field}</span></td></tr>
<tr><td class="line-number">728</td><td>           i<span class="token punctuation">:</span> byte<span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">729</td><td></td></tr>
<tr><td class="line-number">730</td><td>    <span class="token keyword">Procedure</span> DelC<span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">731</td><td>      <span class="token keyword">begin</span></td></tr>
<tr><td class="line-number">732</td><td>        <span class="token keyword">if</span> <span class="token punctuation">(</span>Len <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">and</span> <span class="token punctuation">(</span>Pos <span class="token operator">&lt;=</span> Len<span class="token punctuation">)</span> <span class="token keyword">then</span></td></tr>
<tr><td class="line-number">733</td><td>          <span class="token keyword">begin</span></td></tr>
<tr><td class="line-number">734</td><td>            Delete <span class="token punctuation">(</span>Field<span class="token punctuation">,</span> Pos<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">735</td><td>            <span class="token keyword">Write</span> <span class="token punctuation">(</span>Copy <span class="token punctuation">(</span>Field<span class="token punctuation">,</span> Pos<span class="token punctuation">,</span> Len<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">' '</span><span class="token punctuation">)</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">736</td><td>          <span class="token keyword">end</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">737</td><td>      <span class="token keyword">end</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">738</td><td></td></tr>
<tr><td class="line-number">739</td><td>    <span class="token keyword">Procedure</span> RightC<span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">740</td><td>      <span class="token keyword">begin</span></td></tr>
<tr><td class="line-number">741</td><td>        <span class="token keyword">if</span> <span class="token punctuation">(</span>Pos <span class="token operator">&lt;</span> MaxLen<span class="token punctuation">)</span> <span class="token keyword">then</span></td></tr>
<tr><td class="line-number">742</td><td>          <span class="token keyword">begin</span></td></tr>
<tr><td class="line-number">743</td><td>            Pos <span class="token operator">:=</span> Pos <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">744</td><td>            <span class="token keyword">if</span> <span class="token punctuation">(</span>Pos <span class="token operator">></span> Len<span class="token punctuation">)</span> <span class="token keyword">then</span> Field <span class="token operator">:=</span> Concat <span class="token punctuation">(</span>Field<span class="token punctuation">,</span> <span class="token string">' '</span><span class="token punctuation">)</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">745</td><td>          <span class="token keyword">end</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">746</td><td>      <span class="token keyword">end</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">747</td><td></td></tr>
<tr><td class="line-number">748</td><td>    <span class="token keyword">Procedure</span> LeftC<span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">749</td><td>      <span class="token keyword">begin</span></td></tr>
<tr><td class="line-number">750</td><td>        <span class="token keyword">if</span> <span class="token punctuation">(</span>Pos <span class="token operator">></span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">then</span> Pos <span class="token operator">:=</span> Pos <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">751</td><td>      <span class="token keyword">end</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">752</td><td></td></tr>
<tr><td class="line-number">753</td><td>    <span class="token keyword">Procedure</span> BackSpace<span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">754</td><td>      <span class="token keyword">begin</span></td></tr>
<tr><td class="line-number">755</td><td>        <span class="token keyword">if</span> <span class="token punctuation">(</span>Pos <span class="token operator">></span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">then</span>             <span class="token comment">{if we can backspace}</span></td></tr>
<tr><td class="line-number">756</td><td>          <span class="token keyword">begin</span></td></tr>
<tr><td class="line-number">757</td><td>            <span class="token keyword">if</span> <span class="token punctuation">(</span>Pos <span class="token operator">=</span> MaxLen<span class="token punctuation">)</span> <span class="token operator">and</span> <span class="token punctuation">(</span>Pos <span class="token operator">=</span> Len<span class="token punctuation">)</span> <span class="token keyword">then</span></td></tr>
<tr><td class="line-number">758</td><td>               Pos <span class="token operator">:=</span> Pos <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">759</td><td>            Pos <span class="token operator">:=</span> Pos <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">760</td><td>            Delete <span class="token punctuation">(</span>Field<span class="token punctuation">,</span> Pos<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">{Delete the character}</span></td></tr>
<tr><td class="line-number">761</td><td>            GotoXY <span class="token punctuation">(</span>X <span class="token operator">+</span> <span class="token punctuation">(</span>Pos<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> Y<span class="token punctuation">)</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">762</td><td>            <span class="token keyword">Write</span> <span class="token punctuation">(</span>Copy <span class="token punctuation">(</span>Field<span class="token punctuation">,</span> Pos<span class="token punctuation">,</span> Len<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">' '</span><span class="token punctuation">)</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">763</td><td>          <span class="token keyword">end</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">764</td><td>     <span class="token keyword">end</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">765</td><td></td></tr>
<tr><td class="line-number">766</td><td>    <span class="token keyword">Procedure</span> DelEndofLine<span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">767</td><td>      <span class="token keyword">begin</span></td></tr>
<tr><td class="line-number">768</td><td>        <span class="token keyword">if</span> <span class="token punctuation">(</span>Len <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">and</span> <span class="token punctuation">(</span>Pos <span class="token operator">&lt;=</span> Len<span class="token punctuation">)</span> <span class="token keyword">then</span></td></tr>
<tr><td class="line-number">769</td><td>          <span class="token keyword">begin</span></td></tr>
<tr><td class="line-number">770</td><td>            Delete <span class="token punctuation">(</span>Field<span class="token punctuation">,</span> Pos<span class="token punctuation">,</span> Len<span class="token punctuation">)</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">771</td><td>            <span class="token keyword">write</span> <span class="token punctuation">(</span><span class="token string">' '</span><span class="token punctuation">:</span>Len <span class="token operator">-</span> Pos<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">772</td><td>          <span class="token keyword">end</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">773</td><td>      <span class="token keyword">end</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">774</td><td></td></tr>
<tr><td class="line-number">775</td><td>    <span class="token keyword">Procedure</span> DelField<span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">776</td><td>      <span class="token keyword">begin</span></td></tr>
<tr><td class="line-number">777</td><td>        Pos <span class="token operator">:=</span> <span class="token number">1</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">778</td><td>        Field <span class="token operator">:=</span> <span class="token string">' '</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">779</td><td>        GotoXY <span class="token punctuation">(</span>X <span class="token operator">+</span> <span class="token punctuation">(</span>Pos<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> Y<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">write</span> <span class="token punctuation">(</span><span class="token string">' '</span><span class="token punctuation">:</span>Len<span class="token punctuation">)</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">780</td><td>      <span class="token keyword">end</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">781</td><td></td></tr>
<tr><td class="line-number">782</td><td>    <span class="token keyword">Procedure</span> PrintableChar<span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">783</td><td>      <span class="token keyword">var</span> c <span class="token punctuation">:</span> char<span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">784</td><td>      <span class="token keyword">begin</span></td></tr>
<tr><td class="line-number">785</td><td>        c <span class="token operator">:=</span> chr <span class="token punctuation">(</span>keycode<span class="token punctuation">)</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">786</td><td>        <span class="token keyword">if</span> <span class="token punctuation">(</span>InsertMode<span class="token punctuation">)</span> <span class="token operator">and</span> <span class="token punctuation">(</span>Len <span class="token operator">&lt;</span> MaxLen<span class="token punctuation">)</span> <span class="token keyword">then</span>        <span class="token comment">{if the string is not too long}</span></td></tr>
<tr><td class="line-number">787</td><td>           <span class="token keyword">begin</span></td></tr>
<tr><td class="line-number">788</td><td>             Insert <span class="token punctuation">(</span>c<span class="token punctuation">,</span> Field<span class="token punctuation">,</span> Pos<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">{insert the character}</span></td></tr>
<tr><td class="line-number">789</td><td>             <span class="token keyword">Write</span> <span class="token punctuation">(</span>Copy <span class="token punctuation">(</span>Field<span class="token punctuation">,</span> Pos<span class="token punctuation">,</span> Len<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">790</td><td>             <span class="token keyword">if</span> <span class="token punctuation">(</span>Pos <span class="token operator">&lt;</span> Maxlen<span class="token punctuation">)</span> <span class="token keyword">then</span> Pos <span class="token operator">:=</span> Pos <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">791</td><td>           <span class="token keyword">end</span></td></tr>
<tr><td class="line-number">792</td><td>        <span class="token keyword">else</span></td></tr>
<tr><td class="line-number">793</td><td>          <span class="token keyword">begin</span></td></tr>
<tr><td class="line-number">794</td><td>            Delete <span class="token punctuation">(</span>Field<span class="token punctuation">,</span> Pos<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">795</td><td>            Insert <span class="token punctuation">(</span>c<span class="token punctuation">,</span> Field<span class="token punctuation">,</span> Pos<span class="token punctuation">)</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">796</td><td>            <span class="token keyword">if</span> <span class="token punctuation">(</span>Pos <span class="token operator">&lt;</span> MaxLen<span class="token punctuation">)</span> <span class="token keyword">then</span> Pos <span class="token operator">:=</span> Pos <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">797</td><td>            <span class="token keyword">write</span> <span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">798</td><td>          <span class="token keyword">end</span></td></tr>
<tr><td class="line-number">799</td><td>      <span class="token keyword">end</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">800</td><td></td></tr>
<tr><td class="line-number">801</td><td>    <span class="token keyword">Procedure</span> TabChar <span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">802</td><td>      <span class="token keyword">var</span> i <span class="token punctuation">:</span> byte<span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">803</td><td>      <span class="token keyword">begin</span></td></tr>
<tr><td class="line-number">804</td><td>        i <span class="token operator">:=</span> <span class="token number">0</span> <span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">805</td><td>        <span class="token keyword">if</span> <span class="token punctuation">(</span>InsertMode<span class="token punctuation">)</span> <span class="token keyword">then</span></td></tr>
<tr><td class="line-number">806</td><td>          <span class="token keyword">begin</span></td></tr>
<tr><td class="line-number">807</td><td>            <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>Len <span class="token operator">&lt;</span> MaxLen<span class="token punctuation">)</span> <span class="token operator">and</span> <span class="token punctuation">(</span>i <span class="token operator">&lt;</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token keyword">do</span></td></tr>
<tr><td class="line-number">808</td><td>              <span class="token keyword">begin</span></td></tr>
<tr><td class="line-number">809</td><td>                Insert <span class="token punctuation">(</span><span class="token string">' '</span><span class="token punctuation">,</span> Field<span class="token punctuation">,</span> Pos<span class="token punctuation">)</span> <span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">810</td><td>                Len <span class="token operator">:=</span> Length <span class="token punctuation">(</span>Field<span class="token punctuation">)</span> <span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">811</td><td>                inc <span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">812</td><td>              <span class="token keyword">end</span> <span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">813</td><td>            <span class="token keyword">Write</span> <span class="token punctuation">(</span>Copy <span class="token punctuation">(</span>Field<span class="token punctuation">,</span> Pos<span class="token punctuation">,</span> Len<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">814</td><td>            Pos <span class="token operator">:=</span> Pos<span class="token operator">+</span>i <span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">815</td><td>            <span class="token keyword">if</span> Pos <span class="token operator">></span> MaxLen <span class="token keyword">then</span> Pos <span class="token operator">:=</span> MaxLen<span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">816</td><td>          <span class="token keyword">end</span></td></tr>
<tr><td class="line-number">817</td><td>        <span class="token keyword">else</span></td></tr>
<tr><td class="line-number">818</td><td>          <span class="token keyword">while</span> <span class="token punctuation">(</span>Len <span class="token operator">&lt;</span> MaxLen<span class="token punctuation">)</span> <span class="token operator">and</span> <span class="token punctuation">(</span>i <span class="token operator">&lt;=</span><span class="token number">5</span><span class="token punctuation">)</span> <span class="token keyword">do</span></td></tr>
<tr><td class="line-number">819</td><td>            <span class="token keyword">begin</span></td></tr>
<tr><td class="line-number">820</td><td>              Delete <span class="token punctuation">(</span>Field<span class="token punctuation">,</span> Pos<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">821</td><td>              Insert <span class="token punctuation">(</span><span class="token string">' '</span><span class="token punctuation">,</span> Field<span class="token punctuation">,</span> Pos<span class="token punctuation">)</span> <span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">822</td><td>              <span class="token keyword">if</span> <span class="token punctuation">(</span>Pos <span class="token operator">&lt;</span> MaxLen<span class="token punctuation">)</span> <span class="token keyword">then</span> inc <span class="token punctuation">(</span>Pos<span class="token punctuation">)</span> <span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">823</td><td>              <span class="token keyword">write</span> <span class="token punctuation">(</span><span class="token string">' '</span><span class="token punctuation">)</span> <span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">824</td><td>            <span class="token keyword">end</span> <span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">825</td><td>      <span class="token keyword">end</span> <span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">826</td><td></td></tr>
<tr><td class="line-number">827</td><td>    <span class="token keyword">begin</span></td></tr>
<tr><td class="line-number">828</td><td>      GotoXY <span class="token punctuation">(</span>X<span class="token punctuation">,</span> Y<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">Write</span> <span class="token punctuation">(</span>Field<span class="token punctuation">)</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">829</td><td>      <span class="token keyword">repeat</span>                                     <span class="token comment">{until Status &lt;> 0}</span></td></tr>
<tr><td class="line-number">830</td><td>         GotoXY <span class="token punctuation">(</span>X<span class="token operator">+</span> <span class="token punctuation">(</span>Pos<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> Y<span class="token punctuation">)</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">831</td><td>         Len <span class="token operator">:=</span> Length <span class="token punctuation">(</span>Field<span class="token punctuation">)</span><span class="token punctuation">;</span>                  <span class="token comment">{How long is the string?}</span></td></tr>
<tr><td class="line-number">832</td><td>         KeyCode <span class="token operator">:=</span> GetKeyCode<span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">833</td><td>         <span class="token keyword">case</span> KeyCode <span class="token keyword">of</span></td></tr>
<tr><td class="line-number">834</td><td>            DEL   <span class="token punctuation">:</span> DelC<span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">835</td><td>            LEFT  <span class="token punctuation">:</span> LeftC<span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">836</td><td>            RIGHT <span class="token punctuation">:</span> RightC<span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">837</td><td>            TABKey<span class="token punctuation">:</span> TabChar <span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">838</td><td>            HOME  <span class="token punctuation">:</span> Pos <span class="token operator">:=</span> <span class="token number">1</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">839</td><td>            ENDD  <span class="token punctuation">:</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>Len <span class="token operator">&lt;</span> MaxLen<span class="token punctuation">)</span> <span class="token keyword">then</span> Pos <span class="token operator">:=</span> Len<span class="token operator">+</span><span class="token number">1</span></td></tr>
<tr><td class="line-number">840</td><td>                    <span class="token keyword">else</span> Pos <span class="token operator">:=</span> Len<span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">841</td><td>            DELEOL <span class="token punctuation">:</span> DelEndofLine<span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">842</td><td>            DELFLD <span class="token punctuation">:</span> DelField<span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">843</td><td>            INS    <span class="token punctuation">:</span> <span class="token keyword">begin</span></td></tr>
<tr><td class="line-number">844</td><td>                       InsertMode <span class="token operator">:=</span> Not <span class="token punctuation">(</span>InsertMode<span class="token punctuation">)</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">845</td><td>                       PrintInsertMode<span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">846</td><td>                     <span class="token keyword">end</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">847</td><td>            CR     <span class="token punctuation">:</span> <span class="token keyword">begin</span></td></tr>
<tr><td class="line-number">848</td><td>                       Pos <span class="token operator">:=</span> <span class="token number">1</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">849</td><td>                       KeyCode <span class="token operator">:=</span> DOWN<span class="token punctuation">;</span>           <span class="token comment">{it was a RETURN}</span></td></tr>
<tr><td class="line-number">850</td><td>                     <span class="token keyword">end</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">851</td><td>            BKSPC  <span class="token punctuation">:</span> BackSpace<span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">852</td><td>            ESCkey <span class="token punctuation">:</span> Menu<span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">853</td><td>            <span class="token keyword">else</span>   <span class="token keyword">if</span> <span class="token punctuation">(</span>KeyCode <span class="token operator">&lt;</span> <span class="token number">256</span><span class="token punctuation">)</span> <span class="token keyword">then</span></td></tr>
<tr><td class="line-number">854</td><td>                     <span class="token keyword">begin</span></td></tr>
<tr><td class="line-number">855</td><td>                       PrintableChar<span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">856</td><td>                       Empty <span class="token operator">:=</span> <span class="token keyword">false</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">857</td><td>                     <span class="token keyword">end</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">858</td><td>        <span class="token keyword">end</span> <span class="token comment">{case}</span></td></tr>
<tr><td class="line-number">859</td><td>      <span class="token keyword">until</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>KeyCode <span class="token operator">></span> <span class="token number">255</span><span class="token punctuation">)</span> <span class="token operator">or</span> <span class="token punctuation">(</span>QuitFlag<span class="token punctuation">)</span> <span class="token operator">or</span> <span class="token punctuation">(</span>Empty<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">860</td><td>      GetField <span class="token operator">:=</span> KeyCode<span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">861</td><td>    <span class="token keyword">end</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">862</td><td></td></tr>
<tr><td class="line-number">863</td><td></td></tr>
<tr><td class="line-number">864</td><td>  <span class="token keyword">Procedure</span> WhatField <span class="token punctuation">(</span><span class="token keyword">Var</span> Num_Chars<span class="token punctuation">,</span> FieldNum <span class="token punctuation">:</span> byte<span class="token punctuation">)</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">865</td><td>    <span class="token keyword">begin</span></td></tr>
<tr><td class="line-number">866</td><td>      <span class="token keyword">If</span> FieldNum <span class="token operator">></span> <span class="token number">19</span> <span class="token keyword">then</span>         <span class="token comment">{if field is on the right side (B)}</span></td></tr>
<tr><td class="line-number">867</td><td>        <span class="token keyword">begin</span></td></tr>
<tr><td class="line-number">868</td><td>          Htab <span class="token operator">:=</span> <span class="token number">46</span><span class="token punctuation">;</span> Vtab <span class="token operator">:=</span> FieldNum <span class="token operator">-</span> <span class="token number">15</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">869</td><td>        <span class="token keyword">end</span></td></tr>
<tr><td class="line-number">870</td><td>      <span class="token keyword">else</span>                       <span class="token comment">{or if it is on the left side (A)}</span></td></tr>
<tr><td class="line-number">871</td><td>        <span class="token keyword">begin</span></td></tr>
<tr><td class="line-number">872</td><td>          Htab <span class="token operator">:=</span> <span class="token number">6</span><span class="token punctuation">;</span> Vtab <span class="token operator">:=</span> FieldNum <span class="token operator">+</span> <span class="token number">4</span></td></tr>
<tr><td class="line-number">873</td><td>        <span class="token keyword">end</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">874</td><td>      <span class="token keyword">if</span> <span class="token punctuation">(</span>FieldNum <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">or</span> <span class="token punctuation">(</span>FieldNum <span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">)</span> <span class="token keyword">then</span>  <span class="token comment">{it is a Title}</span></td></tr>
<tr><td class="line-number">875</td><td>        <span class="token keyword">begin</span></td></tr>
<tr><td class="line-number">876</td><td>          Num_Chars <span class="token operator">:=</span> <span class="token number">37</span><span class="token punctuation">;</span>                  <span class="token comment">{it can be 37 chars long}</span></td></tr>
<tr><td class="line-number">877</td><td>          Htab <span class="token operator">:=</span> Htab <span class="token operator">-</span> <span class="token number">4</span><span class="token punctuation">;</span>                <span class="token comment">{titles are longer...}</span></td></tr>
<tr><td class="line-number">878</td><td>          Vtab <span class="token operator">:=</span> <span class="token number">4</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">879</td><td>        <span class="token keyword">end</span></td></tr>
<tr><td class="line-number">880</td><td>      <span class="token keyword">else</span>                                 <span class="token comment">{it is a song}</span></td></tr>
<tr><td class="line-number">881</td><td>        Num_Chars <span class="token operator">:=</span> <span class="token number">31</span><span class="token punctuation">;</span>                    <span class="token comment">{it can be 31 chars long}</span></td></tr>
<tr><td class="line-number">882</td><td>    <span class="token keyword">end</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">883</td><td></td></tr>
<tr><td class="line-number">884</td><td></td></tr>
<tr><td class="line-number">885</td><td></td></tr>
<tr><td class="line-number">886</td><td>  <span class="token keyword">Procedure</span> FKeys<span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">887</td><td>    <span class="token keyword">Var</span></td></tr>
<tr><td class="line-number">888</td><td>         Num_Chars  <span class="token punctuation">:</span> byte<span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">889</td><td>         EscCode    <span class="token punctuation">:</span> char<span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">890</td><td></td></tr>
<tr><td class="line-number">891</td><td>    <span class="token keyword">begin</span></td></tr>
<tr><td class="line-number">892</td><td>      <span class="token keyword">repeat</span></td></tr>
<tr><td class="line-number">893</td><td>        WhatField <span class="token punctuation">(</span>Num_Chars<span class="token punctuation">,</span> FieldNum<span class="token punctuation">)</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">894</td><td>        <span class="token keyword">if</span> <span class="token punctuation">(</span>Pos <span class="token operator">></span> length <span class="token punctuation">(</span>Song_Names <span class="token punctuation">[</span>FieldNum<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">then</span></td></tr>
<tr><td class="line-number">895</td><td>          Pos <span class="token operator">:=</span> length <span class="token punctuation">(</span>Song_Names <span class="token punctuation">[</span>FieldNum<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">896</td><td>        Status <span class="token operator">:=</span> GetField <span class="token punctuation">(</span>Htab<span class="token punctuation">,</span> Vtab<span class="token punctuation">,</span> Num_Chars<span class="token punctuation">,</span> Pos<span class="token punctuation">,</span> Song_Names <span class="token punctuation">[</span>FieldNum<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">897</td><td>        <span class="token keyword">Case</span> Status <span class="token keyword">of</span></td></tr>
<tr><td class="line-number">898</td><td>          DOWN     <span class="token punctuation">:</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>FieldNum <span class="token operator">=</span> <span class="token number">38</span><span class="token punctuation">)</span> <span class="token keyword">then</span>        <span class="token comment">{or CR}</span></td></tr>
<tr><td class="line-number">899</td><td>                        FieldNum <span class="token operator">:=</span> <span class="token number">1</span></td></tr>
<tr><td class="line-number">900</td><td>                     <span class="token keyword">else</span></td></tr>
<tr><td class="line-number">901</td><td>                        FieldNum <span class="token operator">:=</span> FieldNum <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">902</td><td>          Up       <span class="token punctuation">:</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>FieldNum <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">then</span></td></tr>
<tr><td class="line-number">903</td><td>                        FieldNum <span class="token operator">:=</span> <span class="token number">38</span></td></tr>
<tr><td class="line-number">904</td><td>                     <span class="token keyword">else</span></td></tr>
<tr><td class="line-number">905</td><td>                        FieldNum <span class="token operator">:=</span> FieldNum <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">906</td><td>          TOP      <span class="token punctuation">:</span> <span class="token keyword">begin</span></td></tr>
<tr><td class="line-number">907</td><td>                       <span class="token keyword">case</span> FieldNum <span class="token keyword">of</span></td></tr>
<tr><td class="line-number">908</td><td>                         <span class="token number">1</span>  <span class="token punctuation">:</span> FieldNum <span class="token operator">:=</span> <span class="token number">20</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">909</td><td>                         <span class="token number">20</span> <span class="token punctuation">:</span> FieldNum <span class="token operator">:=</span> <span class="token number">1</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">910</td><td>                       <span class="token keyword">else</span></td></tr>
<tr><td class="line-number">911</td><td>                         <span class="token keyword">if</span> FieldNum <span class="token operator">></span> <span class="token number">20</span> <span class="token keyword">then</span></td></tr>
<tr><td class="line-number">912</td><td>                           FieldNum <span class="token operator">:=</span> <span class="token number">20</span></td></tr>
<tr><td class="line-number">913</td><td>                         <span class="token keyword">else</span></td></tr>
<tr><td class="line-number">914</td><td>                           FieldNum <span class="token operator">:=</span> <span class="token number">1</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">915</td><td>                       <span class="token keyword">end</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">916</td><td>                       Pos <span class="token operator">:=</span> <span class="token number">1</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">917</td><td>                     <span class="token keyword">end</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">918</td><td>          BOTTOM   <span class="token punctuation">:</span> <span class="token keyword">begin</span></td></tr>
<tr><td class="line-number">919</td><td>                       <span class="token keyword">case</span> FieldNum <span class="token keyword">of</span></td></tr>
<tr><td class="line-number">920</td><td>                         <span class="token number">1</span> <span class="token punctuation">:</span> FieldNum <span class="token operator">:=</span> <span class="token number">20</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">921</td><td>                         <span class="token number">20</span> <span class="token punctuation">:</span> FieldNum <span class="token operator">:=</span> <span class="token number">1</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">922</td><td>                       <span class="token keyword">else</span></td></tr>
<tr><td class="line-number">923</td><td>                         <span class="token keyword">if</span> FieldNum <span class="token operator">></span> <span class="token number">20</span> <span class="token keyword">then</span></td></tr>
<tr><td class="line-number">924</td><td>                           FieldNum <span class="token operator">:=</span> <span class="token number">1</span></td></tr>
<tr><td class="line-number">925</td><td>                         <span class="token keyword">else</span></td></tr>
<tr><td class="line-number">926</td><td>                           FieldNum <span class="token operator">:=</span> <span class="token number">20</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">927</td><td>                       <span class="token keyword">end</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">928</td><td>                       Pos <span class="token operator">:=</span> <span class="token number">1</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">929</td><td>                     <span class="token keyword">end</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">930</td><td>          F10      <span class="token punctuation">:</span> Quit<span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">931</td><td>        <span class="token keyword">end</span> <span class="token comment">{case}</span></td></tr>
<tr><td class="line-number">932</td><td>      <span class="token keyword">until</span> <span class="token punctuation">(</span>QuitFlag<span class="token punctuation">)</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">933</td><td>    <span class="token keyword">end</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">934</td><td></td></tr>
<tr><td class="line-number">935</td><td><span class="token comment">{-------------------------  Main Program  ---------------------------------}</span></td></tr>
<tr><td class="line-number">936</td><td></td></tr>
<tr><td class="line-number">937</td><td><span class="token keyword">Begin</span></td></tr>
<tr><td class="line-number">938</td><td>  window <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span> CurrentWidth<span class="token punctuation">,</span> CurrentHeight<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">939</td><td>  <span class="token keyword">if</span> CurrentDisplay <span class="token operator">>=</span> Ega <span class="token keyword">then</span></td></tr>
<tr><td class="line-number">940</td><td>    <span class="token keyword">if</span> Font8x8Selected <span class="token keyword">then</span></td></tr>
<tr><td class="line-number">941</td><td>      <span class="token keyword">begin</span></td></tr>
<tr><td class="line-number">942</td><td>        Line43 <span class="token operator">:=</span> <span class="token keyword">True</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">943</td><td>        SelectFont8x8 <span class="token punctuation">(</span><span class="token keyword">False</span><span class="token punctuation">)</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">944</td><td>      <span class="token keyword">end</span></td></tr>
<tr><td class="line-number">945</td><td>    <span class="token keyword">else</span></td></tr>
<tr><td class="line-number">946</td><td>      Line43 <span class="token operator">:=</span> <span class="token keyword">False</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">947</td><td>  DirectVideo <span class="token operator">:=</span> <span class="token keyword">True</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">948</td><td>  New_Page <span class="token operator">:=</span> <span class="token keyword">false</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">949</td><td>  InsertMode <span class="token operator">:=</span> <span class="token keyword">True</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">950</td><td>  QuitFlag <span class="token operator">:=</span> <span class="token keyword">False</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">951</td><td>  CleanUp<span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">952</td><td>  TitlePage<span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">953</td><td>  i <span class="token operator">:=</span> <span class="token number">0</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">954</td><td>  <span class="token keyword">repeat</span></td></tr>
<tr><td class="line-number">955</td><td>    i <span class="token operator">:=</span> i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">956</td><td>  <span class="token keyword">until</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>KeyPressed<span class="token punctuation">)</span> <span class="token operator">or</span> <span class="token punctuation">(</span>i <span class="token operator">></span> <span class="token number">60000</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">957</td><td>  <span class="token keyword">if</span> KeyPressed <span class="token keyword">then</span> Key <span class="token operator">:=</span> ReadKey<span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">958</td><td>  ScreenOut<span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">959</td><td>  DataOut<span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">960</td><td>  FKeys<span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">961</td><td>  Window <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> CurrentWidth<span class="token punctuation">,</span> CurrentHeight<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">962</td><td>  TitlePage<span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">963</td><td>  <span class="token keyword">if</span> Line43 <span class="token keyword">then</span></td></tr>
<tr><td class="line-number">964</td><td>    SelectFont8x8 <span class="token punctuation">(</span><span class="token keyword">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">965</td><td>  NormalCursor<span class="token punctuation">;</span></td></tr>
<tr><td class="line-number">966</td><td><span class="token keyword">end</span><span class="token punctuation">.</span></td></tr>
<tr><td class="line-number">967</td><td></td></tr>
</table></code></pre>
</body></html>
