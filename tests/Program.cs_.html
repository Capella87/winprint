<div style="color:#000000;background-color:#FFFFFF;"><pre>
<span style="color:#0000FF;">using</span> System;
<span style="color:#0000FF;">using</span> System.Collections.Generic;
<span style="color:#0000FF;">using</span> System.Linq;
<span style="color:#0000FF;">using</span> System.Windows.Forms;
<span style="color:#0000FF;">using</span> CommandLine;
<span style="color:#0000FF;">using</span> CommandLine.Text;
<span style="color:#0000FF;">using</span> WinPrint.Core.Models;

<span style="color:#0000FF;">namespace</span> WinPrint {
    <span style="color:#0000FF;">static</span> <span style="color:#0000FF;">class</span> Program {
        <span style="color:#808080;">///</span> <span style="color:#808080;">&lt;summary&gt;</span>
        <span style="color:#808080;">///</span><span style="color:#008000;">  The main entry point for the application.</span>
        <span style="color:#808080;">///</span> <span style="color:#808080;">&lt;/summary&gt;</span>
        [STAThread]
        <span style="color:#0000FF;">static</span> <span style="color:#0000FF;">void</span> Main(<span style="color:#0000FF;">string</span>[] args) {
            <span style="color:#008000;">//var settings = new CefSettings();</span>
            <span style="color:#008000;">//settings.BrowserSubprocessPath = @&quot;x86\CefSharp.BrowserSubprocess.exe&quot;;</span>
            <span style="color:#008000;">//Cef.Initialize(settings, performDependencyCheck: false, browserProcessHandler: null);</span>

            <span style="color:#0000FF;">if</span> (args.Length &gt; <span>0</span>) {
                <span style="color:#0000FF;">var</span> parser = <span style="color:#0000FF;">new</span> Parser(with =&gt; with.EnableDashDash = <span style="color:#0000FF;">true</span>);
                <span style="color:#0000FF;">var</span> result = parser.ParseArguments&lt;Options&gt;(args);
                result
                    .WithParsed&lt;Options&gt;(o =&gt; {
                        <span style="color:#008000;">// copy Files</span>
                        ModelLocator.Current.Options.Files = o.Files.ToList();
                        ModelLocator.Current.Options.Landscape = o.Landscape;
                        ModelLocator.Current.Options.Printer = o.Printer;
                        ModelLocator.Current.Options.PaperSize = o.PaperSize;
                        ModelLocator.Current.Options.Gui = o.Gui;
                        <span style="color:#008000;">// TODO: Add other command line options supported by command line version</span>
                    })
                    .WithNotParsed((errs) =&gt; DisplayHelp(result, errs));
                parser.Dispose();
            }

            Application.SetHighDpiMode(HighDpiMode.SystemAware);
            Application.EnableVisualStyles();
            Application.SetCompatibleTextRenderingDefault(<span style="color:#0000FF;">false</span>);


<span style="color:#0000FF;">#pragma</span> warning disable CA2000 // Dispose objects before losing scope
            Application.Run(<span style="color:#0000FF;">new</span> MainWindow());
<span style="color:#0000FF;">#pragma</span> warning restore CA2000 // Dispose objects before losing scope
        }

        <span style="color:#0000FF;">static</span> <span style="color:#0000FF;">void</span> DisplayHelp&lt;T&gt;(ParserResult&lt;T&gt; result, IEnumerable&lt;Error&gt; errs) {
            <span style="color:#0000FF;">var</span> helpText = HelpText.AutoBuild(result, h =&gt; {
                h.AutoHelp = <span style="color:#0000FF;">true</span>;
                h.AutoVersion = <span style="color:#0000FF;">true</span>;
                <span style="color:#008000;">//h.AddPostOptionsLine(&quot;Files\tOne or more filenames of files to be printed.&quot;);</span>
                <span style="color:#0000FF;">return</span> HelpText.DefaultParsingErrorsHandler(result, h);
            }, e =&gt; e);
            MessageBox.Show(helpText);
            System.Environment.Exit(<span>0</span>);
        }
    }
}

</pre></div>