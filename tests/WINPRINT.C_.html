<!DOCTYPE html><html><head><title>C:\Users\ckindel\source\winprint\tests\WINPRINT.C</title>
<meta charset="utf-8"/>
<link href="file:///C:/Users/ckindel/source/node_modules/prismjs/themes/prism-coy.css" rel="stylesheet"/>
<link href="file:/C:/Users/ckindel/source/winprint/proto/winforms/WinPrint/bin/Debug/netcoreapp3.0/prism-winprint-overrides.css" rel="stylesheet"/>
</head><body>
<pre class="language-c line-numbers "><code class="language-csharp">
<span class="token comment">/*
      WINPRINT.C -- Main routines for WinPrint

      WinPrint - A Text File Printing Program for Windows

      (c) Copyright 1989-1991, Charles E. Kindel, Jr.
      
   REVISIONS

   DATE        VERSION     CHANGES
   1/10/90     0.5         First working copy.  Does not support fonts, or other fancy stuff.
   1/17/90     0.7         Added font dialog box.
   1/20/90     0.75        Completed font implentation (i think).
   1/20/90     0.8         Read filenames from command line, truncate file names in SelectList.
                           Allow wildcard selection to selectlist.
                           Read write default configuration.
   1/21/90     0.85        New Font box.  If rasterfont, allow user to select point size.
   1/22/90     0.86        Margins Box.
   1/23/90     0.87        Options box. No more Margins box.
                           Header/footer styles.
                           Date printed/revised.

   1/25/90     0.88        Info box.  New size (wider and not as tall).
                           Separate margins/hf box.
                           Fonts for Headers/footers.
                           At least get selection of landscape/portrait done.
                           Got rid of WinPrintDlg.
                           Icon and close.

   1/31/90     0.89        Info box !?!?!
                           Command Line.
                           Load/Save config
                           Help.

   2/13/90     0.90        Shareware registration system.
                           Printer Selection.
                           - When this version is finished start major testing and documentation.
                           - Go to 0.91 (BETA 1) when no known bugs.

   2/25/90     0.91        BETA 1
                           Select Printer - saved with current config.
                           Current config name is now saved at open... and save...
                           Verify save implemented.
                           Version expires on 3/15/90.

   2/27/90     0.91A       Minor fixes to .91
   3/6/90      0.91B       Fixed stack overflow with postscript driver.
                           Fixed save w/ no configname problem.
                           Fixed /p:&lt;printer> problem
                           Made WM_CLOSE not prompt if bOptions.close is true.
                           Fixed problem with FF as last character of file.

   3/8/90      0.99        No known bugs
                           Help text all fixed up.
                           Made help system more memory efficient.
                           Shareware release.
                           
   3/10/90     1.00        Release 1. Name changed to WinPrint.

   3/19/90     1.01        Fixed bug regarding invalid setup name on command line.
                           Fixed bug regarding /GO with no file name on command line.
                           Made selected files list box select bar stay on filename last added.
                           Documentation fixes.

   3/24/90     1.02        /GO bug fixed.

   4/13/90     1.03        Windows 3.0 problem with Option Dlg box.
                           Now compiles cleanly with /W3 option.
                           Working of problem in ws_fonts regarding LaserMaster.
                           LaserMaster problem appears to be in driver.

   5/16/90     1.04        Might have fixed 3.0 problem!  Seems to be with proportional font!

   5/17/90     1.05        New shadows.  (DrawShadow)

   5/17/90     1.06        Fixed up shadow routine for Mike Werner.

   5/18/90     1.07        Another attempt at 3.0 compatibility.  No go.

   5/30/90     1.10        Charles Petzold informed me that under Windows 3.0, in order to
                           use a dialog box as a main window (as WinPrint does), the
                           cbWndExtra field in the WNDCLASS structure must be set to
                           DLGWINDOWEXTRA.  This identifier is not defined in Windows 2.1,
                           so I used a value of 1024 in this version.  My guess is that this
                           is a safe value, but there still might be problems.  Until I find
                           out the value of DLGWINDOWEXTRA, there is a risk in running this
                           version.  I have not been able to crash this version...yet.

   6/2/90      1.30        Version that can be uploaded to CIS...

   6/2/90      1.31        Fixed bug in margin dialog introduced in Win3.0.

   7/20/90     1.32        Address change for Bellevue
                           Full 3.0 compatibility.
                           Changed all sprintf's to wsprintf's and
                           str* to lstr*

   10/3/91     1.40        Made full Windows 3.0 application.
                           New makefile.

*/</span>
<span class="token comment">/* ------------------ IMPORTS ------------------- */</span>

<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"precomp.h"</span></span>

<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"winprint.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"fontutil.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"isz.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"dlgs.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"ws_dlg.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"ws_init.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"version.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"dlghelp.h"</span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"wintime.h"</span></span>

<span class="token comment">/* ----------------- GLOBAL DATA --------------------- */</span>
HWND        hwndMain <span class="token punctuation">;</span>
HANDLE      hInst <span class="token punctuation">;</span>
BOOL        fWin31 <span class="token punctuation">;</span>

<span class="token comment">//LPSTR       rglpsz[LAST_IDS - FIRST_IDS + 1] ;</span>

<span class="token keyword">char</span>        szVerNum <span class="token punctuation">[</span><span class="token number">32</span><span class="token punctuation">]</span> <span class="token punctuation">;</span>

<span class="token keyword">char</span>        szRegisteredName <span class="token punctuation">[</span>REG_NAME_LEN<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token punctuation">;</span>
<span class="token keyword">char</span>        szCurrentConfig <span class="token punctuation">[</span>CFG_NAME_LEN<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token punctuation">;</span>

BOOL        bConfigOnCmdLine <span class="token punctuation">;</span>
BOOL        fGo <span class="token punctuation">;</span>
BOOL        bModify <span class="token punctuation">;</span>

HANDLE      ghDevMode <span class="token punctuation">;</span>    <span class="token comment">/* current devmode */</span>
HANDLE      ghDevNames <span class="token punctuation">;</span>   <span class="token comment">/* current devnames */</span>

HICON       hicoNoOrient <span class="token operator">=</span> <span class="token constant">NULL</span> <span class="token punctuation">;</span>
HICON       hicoPortrait <span class="token operator">=</span> <span class="token constant">NULL</span> <span class="token punctuation">;</span>
HICON       hicoLandscape<span class="token operator">=</span> <span class="token constant">NULL</span> <span class="token punctuation">;</span>

OPTIONS     Options <span class="token punctuation">;</span>
OPTIONS     TempOp <span class="token punctuation">;</span>

BOOL        fPrinting <span class="token punctuation">;</span>

HFONT       hfontSmall <span class="token punctuation">;</span>

BOOL        fSavePrinter <span class="token operator">=</span> TRUE <span class="token punctuation">;</span>

<span class="token keyword">short</span>      nLogicalPixelsY <span class="token punctuation">;</span>
<span class="token keyword">short</span>      wPrinterBugs <span class="token punctuation">;</span>

BOOL       fFixedPitchOnly <span class="token operator">=</span> TRUE <span class="token punctuation">;</span>

<span class="token keyword">int</span> PASCAL <span class="token function">WinMain</span><span class="token punctuation">(</span> HINSTANCE hInstance<span class="token punctuation">,</span> HINSTANCE hPrevInstance<span class="token punctuation">,</span> LPSTR lpszCmdLine<span class="token punctuation">,</span> <span class="token keyword">int</span> nCmdShow <span class="token punctuation">)</span> 
<span class="token punctuation">{</span>
   HWND     hwndMain <span class="token punctuation">;</span>
   MSG      msg <span class="token punctuation">;</span>
   HACCEL   haccl <span class="token punctuation">;</span>

<span class="token macro property">#<span class="token directive keyword">ifdef</span> EXPIRE</span>
<span class="token keyword">char</span>     szDate <span class="token punctuation">[</span><span class="token number">80</span><span class="token punctuation">]</span> <span class="token punctuation">;</span>
<span class="token macro property">#<span class="token directive keyword">endif</span></span>

   hInst <span class="token operator">=</span> hInstance <span class="token punctuation">;</span>

   <span class="token comment">/*
    * Are we running Windows 3.1 or higher?
    */</span>
   fWin31 <span class="token operator">=</span> <span class="token punctuation">(</span>BOOL<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token function">LOWORD</span><span class="token punctuation">(</span> <span class="token function">GetVersion</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">)</span> <span class="token operator">>=</span> <span class="token number">0x0A03</span><span class="token punctuation">)</span> <span class="token punctuation">;</span>

   <span class="token function">D</span><span class="token punctuation">(</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>hWDB <span class="token operator">=</span> <span class="token function">wdbOpenSession</span><span class="token punctuation">(</span> <span class="token constant">NULL</span><span class="token punctuation">,</span>
                                 <span class="token string">"WINPRINT"</span><span class="token punctuation">,</span> <span class="token string">"wdb.ini"</span><span class="token punctuation">,</span> <span class="token number">0</span> <span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token punctuation">{</span>
         <span class="token function">DPS</span><span class="token punctuation">(</span> hWDB<span class="token punctuation">,</span> <span class="token string">"WDB is active!"</span> <span class="token punctuation">)</span> <span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
   <span class="token punctuation">)</span> <span class="token punctuation">;</span>

   <span class="token keyword">if</span> <span class="token punctuation">(</span> VER_BUILD <span class="token punctuation">)</span>
      <span class="token function">wsprintf</span><span class="token punctuation">(</span> szVerNum<span class="token punctuation">,</span> <span class="token punctuation">(</span>LPSTR<span class="token punctuation">)</span><span class="token string">"%d.%.2d.%.3d"</span><span class="token punctuation">,</span>
                VER_MAJOR<span class="token punctuation">,</span> VER_MINOR<span class="token punctuation">,</span> VER_BUILD <span class="token punctuation">)</span> <span class="token punctuation">;</span>
   <span class="token keyword">else</span>
      <span class="token function">wsprintf</span><span class="token punctuation">(</span> szVerNum<span class="token punctuation">,</span> <span class="token punctuation">(</span>LPSTR<span class="token punctuation">)</span><span class="token string">"%d.%.2d"</span><span class="token punctuation">,</span> VER_MAJOR<span class="token punctuation">,</span> VER_MINOR <span class="token punctuation">)</span> <span class="token punctuation">;</span>

   <span class="token function">DP1</span><span class="token punctuation">(</span> hWDB<span class="token punctuation">,</span> "

<span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span> <span class="token operator">%</span>s <span class="token operator">%</span>s <span class="token operator">%</span>s <span class="token punctuation">(</span>Windows Version <span class="token number">0</span>x<span class="token operator">%</span><span class="token number">04</span>X<span class="token punctuation">)</span>"<span class="token punctuation">,</span>
              <span class="token punctuation">(</span>LPSTR<span class="token punctuation">)</span><span class="token function">GRCS</span><span class="token punctuation">(</span>IDS_APPNAME<span class="token punctuation">)</span><span class="token punctuation">,</span>
              <span class="token punctuation">(</span>LPSTR<span class="token punctuation">)</span><span class="token function">GRCS</span><span class="token punctuation">(</span>IDS_VERSION<span class="token punctuation">)</span><span class="token punctuation">,</span>
              <span class="token punctuation">(</span>LPSTR<span class="token punctuation">)</span>szVerNum<span class="token punctuation">,</span>
              <span class="token function">LOWORD</span><span class="token punctuation">(</span><span class="token function">GetVersion</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">)</span> <span class="token punctuation">;</span>


   <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>hPrevInstance<span class="token punctuation">)</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>WinPrintInit <span class="token punctuation">(</span>hInstance<span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token punctuation">{</span>
         <span class="token function">DP1</span><span class="token punctuation">(</span> hWDB<span class="token punctuation">,</span> <span class="token string">"WinPrintInit failed"</span> <span class="token punctuation">)</span> <span class="token punctuation">;</span>

         <span class="token function">ErrorResBox</span><span class="token punctuation">(</span> <span class="token constant">NULL</span><span class="token punctuation">,</span> hInstance<span class="token punctuation">,</span>
                      MB_ICONHAND <span class="token operator">|</span> MB_SYSTEMMODAL<span class="token punctuation">,</span>IDS_APPNAME<span class="token punctuation">,</span> 
                      IDS_ERR_NOMEMORY <span class="token punctuation">)</span> <span class="token punctuation">;</span>

         <span class="token keyword">return</span> FALSE <span class="token punctuation">;</span>
      <span class="token punctuation">}</span>

   fFixedPitchOnly <span class="token operator">=</span> <span class="token function">GetPrivateProfileInt</span><span class="token punctuation">(</span> <span class="token function">GRCS</span><span class="token punctuation">(</span>IDS_INI_MAIN<span class="token punctuation">)</span><span class="token punctuation">,</span>
                                  <span class="token function">GRCS</span><span class="token punctuation">(</span>IDS_INI_FIXEDPITCHONLY<span class="token punctuation">)</span><span class="token punctuation">,</span>
                                  TRUE<span class="token punctuation">,</span>
                                  <span class="token function">GRCS</span><span class="token punctuation">(</span>IDS_INI_FILENAME<span class="token punctuation">)</span> <span class="token punctuation">)</span> <span class="token punctuation">;</span>


   <span class="token comment">/*
      * Get a really useful font
      */</span>
   hfontSmall <span class="token operator">=</span> <span class="token function">ReallyCreateFont</span><span class="token punctuation">(</span> <span class="token constant">NULL</span><span class="token punctuation">,</span> <span class="token string">"Helv"</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> RCF_NORMAL <span class="token punctuation">)</span> <span class="token punctuation">;</span>

   <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token number">0</span> <span class="token operator">==</span> <span class="token punctuation">(</span>hwndMain <span class="token operator">=</span> CreateDialog <span class="token punctuation">(</span>hInstance<span class="token punctuation">,</span> <span class="token function">MAKEINTRESOURCE</span><span class="token punctuation">(</span> DLG_MAIN <span class="token punctuation">)</span><span class="token punctuation">,</span>
                     <span class="token number">0</span><span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
   <span class="token punctuation">{</span>
      <span class="token function">DP1</span><span class="token punctuation">(</span> hWDB<span class="token punctuation">,</span> <span class="token string">"CreateDialog failed"</span> <span class="token punctuation">)</span> <span class="token punctuation">;</span>

      <span class="token function">ErrorResBox</span><span class="token punctuation">(</span> <span class="token constant">NULL</span><span class="token punctuation">,</span> hInstance<span class="token punctuation">,</span>
                   MB_ICONHAND <span class="token operator">|</span> MB_SYSTEMMODAL<span class="token punctuation">,</span>IDS_APPNAME<span class="token punctuation">,</span> 
                   IDS_ERR_NOMEMORY <span class="token punctuation">)</span> <span class="token punctuation">;</span>

      <span class="token keyword">return</span> FALSE <span class="token punctuation">;</span>
   <span class="token punctuation">}</span>

   SendMessage <span class="token punctuation">(</span>hwndMain<span class="token punctuation">,</span> WM_MYINIT<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0L</span><span class="token punctuation">)</span> <span class="token punctuation">;</span>  <span class="token comment">/* MYINIT is defined as WM_USER + 1 */</span>
   ShowWindow <span class="token punctuation">(</span>hwndMain<span class="token punctuation">,</span> nCmdShow<span class="token punctuation">)</span> <span class="token punctuation">;</span>

   <span class="token function">PostMessage</span><span class="token punctuation">(</span>hwndMain<span class="token punctuation">,</span> WM_GO<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0L</span><span class="token punctuation">)</span> <span class="token punctuation">;</span>

   haccl <span class="token operator">=</span> <span class="token function">LoadAccelerators</span><span class="token punctuation">(</span> hInstance<span class="token punctuation">,</span> <span class="token function">MAKEINTRESOURCE</span><span class="token punctuation">(</span> <span class="token number">1</span> <span class="token punctuation">)</span> <span class="token punctuation">)</span> <span class="token punctuation">;</span>

   <span class="token keyword">while</span> <span class="token punctuation">(</span>GetMessage <span class="token punctuation">(</span><span class="token operator">&amp;</span>msg<span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
   <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">TranslateAccelerator</span><span class="token punctuation">(</span> hwndMain<span class="token punctuation">,</span> haccl<span class="token punctuation">,</span> <span class="token operator">&amp;</span>msg <span class="token punctuation">)</span><span class="token punctuation">)</span>
         <span class="token function">DispatchMessage</span><span class="token punctuation">(</span> <span class="token operator">&amp;</span>msg <span class="token punctuation">)</span> <span class="token punctuation">;</span>
      <span class="token keyword">else</span>
         <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">IsDialogMessage</span><span class="token punctuation">(</span> hwndMain<span class="token punctuation">,</span> <span class="token operator">&amp;</span>msg <span class="token punctuation">)</span><span class="token punctuation">)</span>  
         <span class="token punctuation">{</span>
            <span class="token function">TranslateMessage</span><span class="token punctuation">(</span> <span class="token operator">&amp;</span>msg <span class="token punctuation">)</span> <span class="token punctuation">;</span>
            <span class="token function">DispatchMessage</span><span class="token punctuation">(</span> <span class="token operator">&amp;</span>msg <span class="token punctuation">)</span> <span class="token punctuation">;</span>
         <span class="token punctuation">}</span>
   <span class="token punctuation">}</span>

   <span class="token function">DeleteObject</span><span class="token punctuation">(</span> hfontSmall <span class="token punctuation">)</span> <span class="token punctuation">;</span>

   <span class="token keyword">return</span> msg<span class="token punctuation">.</span>wParam <span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">//*************************************************************</span>
<span class="token comment">//</span>
<span class="token comment">//  GetRCString</span>
<span class="token comment">//</span>
<span class="token comment">//  Purpose:</span>
<span class="token comment">//      Retrieves a string from the resource STRINGTABLE</span>
<span class="token comment">//      This routine will read (minimum) up to 384 characters before it</span>
<span class="token comment">//      begins to overwrite.  MAX length per/read is 128!!</span>
<span class="token comment">//</span>
<span class="token comment">//  Parameters:</span>
<span class="token comment">//      UINT wID</span>
<span class="token comment">//      </span>
<span class="token comment">//</span>
<span class="token comment">//  Return: (LPSTR)</span>
<span class="token comment">//      Pointer to a static buffer that contains the string</span>
<span class="token comment">//</span>
<span class="token comment">//  Comments:</span>
<span class="token comment">//</span>
<span class="token comment">//</span>
<span class="token comment">//  History:    Date       Author     Comment</span>
<span class="token comment">//               2/12/92   MSM        Created</span>
<span class="token comment">//</span>
<span class="token comment">//*************************************************************</span>

<span class="token macro property">#<span class="token directive keyword">define</span> BUF_SIZE    2048</span>

LPSTR WINAPI <span class="token function">GetRCString</span><span class="token punctuation">(</span>UINT wID<span class="token punctuation">,</span> HINSTANCE hInst<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">static</span> <span class="token keyword">char</span> szString<span class="token punctuation">[</span> BUF_SIZE <span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">static</span> LPSTR lpIndex <span class="token operator">=</span> <span class="token punctuation">(</span>LPSTR<span class="token punctuation">)</span>szString<span class="token punctuation">;</span>
    <span class="token keyword">static</span> WORD  wEmpty <span class="token operator">=</span> BUF_SIZE<span class="token punctuation">;</span>
    LPSTR lp<span class="token punctuation">;</span>
    WORD  wLen<span class="token punctuation">;</span>

read_string<span class="token operator">:</span>
    <span class="token comment">// Add 1 for the NULL terminator</span>
    wLen <span class="token operator">=</span> <span class="token function">LoadString</span><span class="token punctuation">(</span> hInst<span class="token punctuation">,</span> wID<span class="token punctuation">,</span> lpIndex<span class="token punctuation">,</span> wEmpty <span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>wLen <span class="token operator">==</span> wEmpty<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        wEmpty <span class="token operator">=</span> BUF_SIZE<span class="token punctuation">;</span>
        lpIndex <span class="token operator">=</span> <span class="token punctuation">(</span>LPSTR<span class="token punctuation">)</span>szString<span class="token punctuation">;</span>
        <span class="token keyword">goto</span> read_string<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>wLen<span class="token operator">==</span><span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token function">DP1</span><span class="token punctuation">(</span> hWDB<span class="token punctuation">,</span> <span class="token string">"LoadString failed!  ID = %d"</span><span class="token punctuation">,</span> wID <span class="token punctuation">)</span><span class="token punctuation">;</span>
        lpIndex<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    lp <span class="token operator">=</span> lpIndex<span class="token punctuation">;</span>

    lpIndex <span class="token operator">+=</span> wLen<span class="token punctuation">;</span>
    wEmpty <span class="token operator">-=</span> wLen<span class="token punctuation">;</span>

    <span class="token keyword">return</span> lp<span class="token punctuation">;</span>

<span class="token punctuation">}</span> <span class="token comment">//*** GetRCString</span>


BOOL FAR PASCAL <span class="token function">CmpOptions</span><span class="token punctuation">(</span> VOID <span class="token punctuation">)</span>
<span class="token punctuation">{</span>
   <span class="token keyword">if</span> <span class="token punctuation">(</span>Options<span class="token punctuation">.</span>lfCurFont<span class="token punctuation">.</span>lfHeight <span class="token operator">!=</span> TempOp<span class="token punctuation">.</span>lfCurFont<span class="token punctuation">.</span>lfHeight <span class="token operator">||</span>
       Options<span class="token punctuation">.</span>lfCurFont<span class="token punctuation">.</span>lfWeight <span class="token operator">!=</span> TempOp<span class="token punctuation">.</span>lfCurFont<span class="token punctuation">.</span>lfWeight <span class="token operator">||</span> 
       Options<span class="token punctuation">.</span>lfCurFont<span class="token punctuation">.</span>lfItalic <span class="token operator">!=</span> TempOp<span class="token punctuation">.</span>lfCurFont<span class="token punctuation">.</span>lfItalic <span class="token operator">||</span> 
       Options<span class="token punctuation">.</span>lfCurFont<span class="token punctuation">.</span>lfCharSet <span class="token operator">!=</span> TempOp<span class="token punctuation">.</span>lfCurFont<span class="token punctuation">.</span>lfCharSet <span class="token operator">||</span> 
       Options<span class="token punctuation">.</span>lfCurFont<span class="token punctuation">.</span>lfPitchAndFamily <span class="token operator">!=</span> TempOp<span class="token punctuation">.</span>lfCurFont<span class="token punctuation">.</span>lfPitchAndFamily <span class="token punctuation">)</span>
      <span class="token keyword">return</span> FALSE <span class="token punctuation">;</span>

   <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">lstrcmpi</span><span class="token punctuation">(</span> Options<span class="token punctuation">.</span>lfCurFont<span class="token punctuation">.</span>lfFaceName<span class="token punctuation">,</span> TempOp<span class="token punctuation">.</span>lfCurFont<span class="token punctuation">.</span>lfFaceName <span class="token punctuation">)</span><span class="token punctuation">)</span>
   <span class="token punctuation">{</span>
      <span class="token function">DP1</span><span class="token punctuation">(</span> hWDB<span class="token punctuation">,</span> <span class="token string">"CurFont"</span> <span class="token punctuation">)</span> <span class="token punctuation">;</span>
      <span class="token keyword">return</span> FALSE <span class="token punctuation">;</span>
   <span class="token punctuation">}</span>

   <span class="token keyword">if</span> <span class="token punctuation">(</span>Options<span class="token punctuation">.</span>lfHFFont<span class="token punctuation">.</span>lfHeight <span class="token operator">!=</span> TempOp<span class="token punctuation">.</span>lfHFFont<span class="token punctuation">.</span>lfHeight <span class="token operator">||</span>
       Options<span class="token punctuation">.</span>lfHFFont<span class="token punctuation">.</span>lfWeight <span class="token operator">!=</span> TempOp<span class="token punctuation">.</span>lfHFFont<span class="token punctuation">.</span>lfWeight <span class="token operator">||</span> 
       Options<span class="token punctuation">.</span>lfHFFont<span class="token punctuation">.</span>lfItalic <span class="token operator">!=</span> TempOp<span class="token punctuation">.</span>lfHFFont<span class="token punctuation">.</span>lfItalic <span class="token operator">||</span> 
       Options<span class="token punctuation">.</span>lfHFFont<span class="token punctuation">.</span>lfCharSet <span class="token operator">!=</span> TempOp<span class="token punctuation">.</span>lfHFFont<span class="token punctuation">.</span>lfCharSet <span class="token operator">||</span> 
       Options<span class="token punctuation">.</span>lfHFFont<span class="token punctuation">.</span>lfPitchAndFamily <span class="token operator">!=</span> TempOp<span class="token punctuation">.</span>lfHFFont<span class="token punctuation">.</span>lfPitchAndFamily <span class="token punctuation">)</span>
      <span class="token keyword">return</span> FALSE <span class="token punctuation">;</span>

   <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">lstrcmpi</span><span class="token punctuation">(</span> Options<span class="token punctuation">.</span>lfHFFont<span class="token punctuation">.</span>lfFaceName<span class="token punctuation">,</span> TempOp<span class="token punctuation">.</span>lfHFFont<span class="token punctuation">.</span>lfFaceName <span class="token punctuation">)</span><span class="token punctuation">)</span>
   <span class="token punctuation">{</span>
      <span class="token function">DP1</span><span class="token punctuation">(</span> hWDB<span class="token punctuation">,</span> <span class="token string">"HFFont"</span> <span class="token punctuation">)</span> <span class="token punctuation">;</span>
      <span class="token keyword">return</span> FALSE <span class="token punctuation">;</span>
   <span class="token punctuation">}</span>

   <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">memicmp</span><span class="token punctuation">(</span> <span class="token operator">&amp;</span>Options<span class="token punctuation">.</span>wHeaderMask<span class="token punctuation">,</span> <span class="token operator">&amp;</span>TempOp<span class="token punctuation">.</span>wHeaderMask<span class="token punctuation">,</span>
                <span class="token keyword">sizeof</span><span class="token punctuation">(</span> OPTIONS <span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">2</span> <span class="token operator">*</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>LOGFONT<span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">)</span>
   <span class="token punctuation">{</span>
      <span class="token function">DP1</span><span class="token punctuation">(</span> hWDB<span class="token punctuation">,</span> <span class="token string">"They differ in other"</span> <span class="token punctuation">)</span> <span class="token punctuation">;</span>
      <span class="token keyword">return</span> FALSE <span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
   <span class="token keyword">return</span> TRUE <span class="token punctuation">;</span>
<span class="token punctuation">}</span>   

</code></pre>
</body></html>
