From: <Saved by Blink>
Snapshot-Content-Location: http://localhost:49203/
Subject: c:\Users\ckindel\source\winprint\tests\MainWindow.cs
Date: Fri, 20 Dec 2019 00:03:37 -0000
MIME-Version: 1.0
Content-Type: multipart/related;
	type="text/html";
	boundary="----MultipartBoundary--ctxYLHKYprwXxXVmXMNQ4i1MAESqIAZlGBQc6BGSfT----"


------MultipartBoundary--ctxYLHKYprwXxXVmXMNQ4i1MAESqIAZlGBQc6BGSfT----
Content-Type: text/html
Content-ID: <frame-135B41C0F9D8444B500FD1C6380843A0@mhtml.blink>
Content-Transfer-Encoding: quoted-printable
Content-Location: http://localhost:49203/

<html><head><meta http-equiv=3D"Content-Type" content=3D"text/html; charset=
=3DUTF-8"><link rel=3D"stylesheet" type=3D"text/css" href=3D"cid:css-b4cd29=
d4-bb14-44d1-a954-dcf901ed225f@mhtml.blink" /><title>c:\Users\ckindel\sourc=
e\winprint\tests\MainWindow.cs</title></head><body><table class=3D"hljs"><t=
body><tr><td class=3D"line-number">1</td><td class=3D"line-text"><span clas=
s=3D"hljs-keyword">using</span> System;
</td></tr>
<tr><td class=3D"line-number">2</td><td class=3D"line-text"><span class=3D"=
hljs-keyword">using</span> System.Collections.Generic;
</td></tr>
<tr><td class=3D"line-number">3</td><td class=3D"line-text"><span class=3D"=
hljs-keyword">using</span> System.ComponentModel;
</td></tr>
<tr><td class=3D"line-number">4</td><td class=3D"line-text"><span class=3D"=
hljs-keyword">using</span> System.Diagnostics;
</td></tr>
<tr><td class=3D"line-number">5</td><td class=3D"line-text"><span class=3D"=
hljs-keyword">using</span> System.Drawing;
</td></tr>
<tr><td class=3D"line-number">6</td><td class=3D"line-text"><span class=3D"=
hljs-keyword">using</span> System.Drawing.Printing;
</td></tr>
<tr><td class=3D"line-number">7</td><td class=3D"line-text"><span class=3D"=
hljs-keyword">using</span> System.IO;
</td></tr>
<tr><td class=3D"line-number">8</td><td class=3D"line-text"><span class=3D"=
hljs-keyword">using</span> System.Linq;
</td></tr>
<tr><td class=3D"line-number">9</td><td class=3D"line-text"><span class=3D"=
hljs-keyword">using</span> System.Windows.Forms;
</td></tr>
<tr><td class=3D"line-number">10</td><td class=3D"line-text"><span class=3D=
"hljs-keyword">using</span> WinPrint.Core;
</td></tr>
<tr><td class=3D"line-number">11</td><td class=3D"line-text"><span class=3D=
"hljs-keyword">using</span> WinPrint.Core.Models;
</td></tr>
<tr><td class=3D"line-number">12</td><td class=3D"line-text"><span class=3D=
"hljs-keyword">using</span> WinPrint.Core.Services;
</td></tr>
<tr><td class=3D"line-number">13</td><td class=3D"line-text">
</td></tr>
<tr><td class=3D"line-number">14</td><td class=3D"line-text"><span class=3D=
"hljs-keyword">namespace</span> <span class=3D"hljs-title">WinPrint</span> =
{
</td></tr>
<tr><td class=3D"line-number">15</td><td class=3D"line-text">    <span clas=
s=3D"hljs-keyword">public</span> <span class=3D"hljs-keyword">partial</span=
> <span class=3D"hljs-keyword">class</span> <span class=3D"hljs-title">Main=
Window</span> : <span class=3D"hljs-title">Form</span> {
</td></tr>
<tr><td class=3D"line-number">16</td><td class=3D"line-text">
</td></tr>
<tr><td class=3D"line-number">17</td><td class=3D"line-text">        <span =
class=3D"hljs-comment">// The Windows printer document</span>
</td></tr>
<tr><td class=3D"line-number">18</td><td class=3D"line-text">        <span =
class=3D"hljs-keyword">private</span> PrintDocument printDoc =3D <span clas=
s=3D"hljs-keyword">new</span> PrintDocument();
</td></tr>
<tr><td class=3D"line-number">19</td><td class=3D"line-text">
</td></tr>
<tr><td class=3D"line-number">20</td><td class=3D"line-text">        <span =
class=3D"hljs-comment">// Winprint Print Preview control</span>
</td></tr>
<tr><td class=3D"line-number">21</td><td class=3D"line-text">        <span =
class=3D"hljs-keyword">private</span> PrintPreview printPreview;
</td></tr>
<tr><td class=3D"line-number">22</td><td class=3D"line-text">
</td></tr>
<tr><td class=3D"line-number">23</td><td class=3D"line-text">        <span =
class=3D"hljs-comment">//private string file =3D "..\\..\\..\\..\\..\\..\\t=
ests\\formfeeds.txt";</span>
</td></tr>
<tr><td class=3D"line-number">24</td><td class=3D"line-text">        <span =
class=3D"hljs-comment">//private string file =3D "..\\..\\..\\..\\..\\..\\t=
ests\\TEST.TXT";</span>
</td></tr>
<tr><td class=3D"line-number">25</td><td class=3D"line-text">        <span =
class=3D"hljs-comment">//private string file =3D "..\\..\\..\\..\\..\\..\\t=
ests\\long html doc as text.TXT";</span>
</td></tr>
<tr><td class=3D"line-number">26</td><td class=3D"line-text">        <span =
class=3D"hljs-comment">//private string file =3D @"C:\Users\ckindel\source\=
winprint\tests\test.html";</span>
</td></tr>
<tr><td class=3D"line-number">27</td><td class=3D"line-text">        <span =
class=3D"hljs-keyword">private</span> <span class=3D"hljs-keyword">string</=
span> file =3D <span class=3D"hljs-string">""</span>; <span class=3D"hljs-c=
omment">//@"..\..\..\..\..\..\proto\winforms\WinPrint\ViewModels\SheetViewM=
odel.cs";</span>
</td></tr>
<tr><td class=3D"line-number">28</td><td class=3D"line-text">
</td></tr>
<tr><td class=3D"line-number">29</td><td class=3D"line-text">        [<span=
 class=3D"hljs-meta">System.Diagnostics.CodeAnalysis.SuppressMessage(<span =
class=3D"hljs-meta-string">"Globalization"</span>, <span class=3D"hljs-meta=
-string">"CA1303:Do not pass literals as localized parameters"</span>, Just=
ification =3D <span class=3D"hljs-meta-string">"&lt;Pending&gt;"</span>)</s=
pan>]
</td></tr>
<tr><td class=3D"line-number">30</td><td class=3D"line-text">        <span =
class=3D"hljs-function"><span class=3D"hljs-keyword">public</span> <span cl=
ass=3D"hljs-title">MainWindow</span>(<span class=3D"hljs-params"></span>)</=
span> {
</td></tr>
<tr><td class=3D"line-number">31</td><td class=3D"line-text">            In=
itializeComponent();
</td></tr>
<tr><td class=3D"line-number">32</td><td class=3D"line-text">
</td></tr>
<tr><td class=3D"line-number">33</td><td class=3D"line-text">            Ic=
on =3D Resources.printer_and_fax_w;
</td></tr>
<tr><td class=3D"line-number">34</td><td class=3D"line-text">
</td></tr>
<tr><td class=3D"line-number">35</td><td class=3D"line-text">            pr=
intPreview =3D <span class=3D"hljs-keyword">new</span> PrintPreview();
</td></tr>
<tr><td class=3D"line-number">36</td><td class=3D"line-text">            pr=
intPreview.Anchor =3D <span class=3D"hljs-keyword">this</span>.dummyButton.=
Anchor;
</td></tr>
<tr><td class=3D"line-number">37</td><td class=3D"line-text">            pr=
intPreview.BackColor =3D <span class=3D"hljs-keyword">this</span>.dummyButt=
on.BackColor;
</td></tr>
<tr><td class=3D"line-number">38</td><td class=3D"line-text">            pr=
intPreview.Location =3D <span class=3D"hljs-keyword">this</span>.dummyButto=
n.Location;
</td></tr>
<tr><td class=3D"line-number">39</td><td class=3D"line-text">            pr=
intPreview.Margin =3D <span class=3D"hljs-keyword">this</span>.dummyButton.=
Margin;
</td></tr>
<tr><td class=3D"line-number">40</td><td class=3D"line-text">            pr=
intPreview.Name =3D <span class=3D"hljs-string">"printPreview"</span>;
</td></tr>
<tr><td class=3D"line-number">41</td><td class=3D"line-text">            pr=
intPreview.Size =3D <span class=3D"hljs-keyword">this</span>.dummyButton.Si=
ze;
</td></tr>
<tr><td class=3D"line-number">42</td><td class=3D"line-text">            pr=
intPreview.TabIndex =3D <span class=3D"hljs-number">1</span>;<span class=3D=
"hljs-comment">// this.dummyButton.TabIndex;</span>
</td></tr>
<tr><td class=3D"line-number">43</td><td class=3D"line-text">            pr=
intPreview.TabStop =3D <span class=3D"hljs-literal">true</span>;
</td></tr>
<tr><td class=3D"line-number">44</td><td class=3D"line-text">
</td></tr>
<tr><td class=3D"line-number">45</td><td class=3D"line-text">
</td></tr>
<tr><td class=3D"line-number">46</td><td class=3D"line-text">            <s=
pan class=3D"hljs-keyword">if</span> (LicenseManager.UsageMode !=3D License=
UsageMode.Designtime) {
</td></tr>
<tr><td class=3D"line-number">47</td><td class=3D"line-text">              =
  <span class=3D"hljs-keyword">this</span>.panelRight.Controls.Remove(<span=
 class=3D"hljs-keyword">this</span>.dummyButton);
</td></tr>
<tr><td class=3D"line-number">48</td><td class=3D"line-text">              =
  <span class=3D"hljs-keyword">this</span>.panelRight.Controls.Add(<span cl=
ass=3D"hljs-keyword">this</span>.printPreview);
</td></tr>
<tr><td class=3D"line-number">49</td><td class=3D"line-text">              =
  printersCB.Enabled =3D <span class=3D"hljs-literal">false</span>;
</td></tr>
<tr><td class=3D"line-number">50</td><td class=3D"line-text">              =
  paperSizesCB.Enabled =3D <span class=3D"hljs-literal">false</span>;
</td></tr>
<tr><td class=3D"line-number">51</td><td class=3D"line-text">            }
</td></tr>
<tr><td class=3D"line-number">52</td><td class=3D"line-text">        }
</td></tr>
<tr><td class=3D"line-number">53</td><td class=3D"line-text">
</td></tr>
<tr><td class=3D"line-number">54</td><td class=3D"line-text">        <span =
class=3D"hljs-comment">// Flag: Has Dispose already been called?</span>
</td></tr>
<tr><td class=3D"line-number">55</td><td class=3D"line-text">        <span =
class=3D"hljs-keyword">bool</span> disposed =3D <span class=3D"hljs-literal=
">false</span>;
</td></tr>
<tr><td class=3D"line-number">56</td><td class=3D"line-text">        <span =
class=3D"hljs-comment">// Protected implementation of Dispose pattern.</spa=
n>
</td></tr>
<tr><td class=3D"line-number">57</td><td class=3D"line-text">        <span =
class=3D"hljs-comment"><span class=3D"hljs-doctag">///</span> <span class=
=3D"hljs-doctag">&lt;summary&gt;</span></span>
</td></tr>
<tr><td class=3D"line-number">58</td><td class=3D"line-text">        <span =
class=3D"hljs-comment"><span class=3D"hljs-doctag">///</span>  Clean up any=
 resources being used.</span>
</td></tr>
<tr><td class=3D"line-number">59</td><td class=3D"line-text">        <span =
class=3D"hljs-comment"><span class=3D"hljs-doctag">///</span> <span class=
=3D"hljs-doctag">&lt;/summary&gt;</span></span>
</td></tr>
<tr><td class=3D"line-number">60</td><td class=3D"line-text">        <span =
class=3D"hljs-comment"><span class=3D"hljs-doctag">///</span> <span class=
=3D"hljs-doctag">&lt;param name=3D"disposing"&gt;</span>true if managed res=
ources should be disposed; otherwise, false.<span class=3D"hljs-doctag">&lt=
;/param&gt;</span></span>
</td></tr>
<tr><td class=3D"line-number">61</td><td class=3D"line-text">        <span =
class=3D"hljs-function"><span class=3D"hljs-keyword">protected</span> <span=
 class=3D"hljs-keyword">override</span> <span class=3D"hljs-keyword">void</=
span> <span class=3D"hljs-title">Dispose</span>(<span class=3D"hljs-params"=
><span class=3D"hljs-keyword">bool</span> disposing</span>)</span> {
</td></tr>
<tr><td class=3D"line-number">62</td><td class=3D"line-text">            <s=
pan class=3D"hljs-keyword">if</span> (disposed)
</td></tr>
<tr><td class=3D"line-number">63</td><td class=3D"line-text">              =
  <span class=3D"hljs-keyword">return</span>;
</td></tr>
<tr><td class=3D"line-number">64</td><td class=3D"line-text">
</td></tr>
<tr><td class=3D"line-number">65</td><td class=3D"line-text">            <s=
pan class=3D"hljs-keyword">if</span> (disposing &amp;&amp; (components !=3D=
 <span class=3D"hljs-literal">null</span>)) {
</td></tr>
<tr><td class=3D"line-number">66</td><td class=3D"line-text">              =
  components.Dispose();
</td></tr>
<tr><td class=3D"line-number">67</td><td class=3D"line-text">              =
  <span class=3D"hljs-comment">//if (streamToPrint !=3D null) streamToPrint=
.Dispose();</span>
</td></tr>
<tr><td class=3D"line-number">68</td><td class=3D"line-text">              =
  <span class=3D"hljs-keyword">if</span> (printDoc !=3D <span class=3D"hljs=
-literal">null</span>) printDoc.Dispose();
</td></tr>
<tr><td class=3D"line-number">69</td><td class=3D"line-text">              =
  <span class=3D"hljs-keyword">if</span> (printPreview !=3D <span class=3D"=
hljs-literal">null</span>) printPreview.Dispose();
</td></tr>
<tr><td class=3D"line-number">70</td><td class=3D"line-text">            }
</td></tr>
<tr><td class=3D"line-number">71</td><td class=3D"line-text">            di=
sposed =3D <span class=3D"hljs-literal">true</span>;
</td></tr>
<tr><td class=3D"line-number">72</td><td class=3D"line-text">            <s=
pan class=3D"hljs-keyword">base</span>.Dispose(disposing);
</td></tr>
<tr><td class=3D"line-number">73</td><td class=3D"line-text">        }
</td></tr>
<tr><td class=3D"line-number">74</td><td class=3D"line-text">
</td></tr>
<tr><td class=3D"line-number">75</td><td class=3D"line-text">        <span =
class=3D"hljs-function"><span class=3D"hljs-keyword">private</span> SheetVi=
ewModel <span class=3D"hljs-title">CreatePreviewSheetViewModel</span>(<span=
 class=3D"hljs-params"></span>)</span> {
</td></tr>
<tr><td class=3D"line-number">76</td><td class=3D"line-text">            De=
bug.WriteLine(<span class=3D"hljs-string">"CreateSheetViewModel"</span>);
</td></tr>
<tr><td class=3D"line-number">77</td><td class=3D"line-text">            Sh=
eetViewModel svm =3D <span class=3D"hljs-keyword">new</span> SheetViewModel=
();
</td></tr>
<tr><td class=3D"line-number">78</td><td class=3D"line-text">
</td></tr>
<tr><td class=3D"line-number">79</td><td class=3D"line-text">            sv=
m.SetSettings(ModelLocator.Current.Settings.Sheets.GetValueOrDefault(ModelL=
ocator.Current.Settings.DefaultSheet.ToString()));
</td></tr>
<tr><td class=3D"line-number">80</td><td class=3D"line-text">
</td></tr>
<tr><td class=3D"line-number">81</td><td class=3D"line-text">            la=
ndscapeCheckbox.Checked =3D svm.Landscape;
</td></tr>
<tr><td class=3D"line-number">82</td><td class=3D"line-text">            en=
ableHeader.Checked =3D svm.Header.Enabled;
</td></tr>
<tr><td class=3D"line-number">83</td><td class=3D"line-text">            he=
aderTextBox.Text =3D svm.Header.Text;
</td></tr>
<tr><td class=3D"line-number">84</td><td class=3D"line-text">            en=
ableFooter.Checked =3D svm.Footer.Enabled;
</td></tr>
<tr><td class=3D"line-number">85</td><td class=3D"line-text">            fo=
oterTextBox.Text =3D svm.Footer.Text;
</td></tr>
<tr><td class=3D"line-number">86</td><td class=3D"line-text">
</td></tr>
<tr><td class=3D"line-number">87</td><td class=3D"line-text">            to=
pMargin.Value =3D svm.Margins.Top / <span class=3D"hljs-number">100</span>M=
;
</td></tr>
<tr><td class=3D"line-number">88</td><td class=3D"line-text">            le=
ftMargin.Value =3D svm.Margins.Left / <span class=3D"hljs-number">100</span=
>M;
</td></tr>
<tr><td class=3D"line-number">89</td><td class=3D"line-text">            ri=
ghtMargin.Value =3D svm.Margins.Right / <span class=3D"hljs-number">100</sp=
an>M;
</td></tr>
<tr><td class=3D"line-number">90</td><td class=3D"line-text">            bo=
ttomMargin.Value =3D svm.Margins.Bottom / <span class=3D"hljs-number">100</=
span>M;
</td></tr>
<tr><td class=3D"line-number">91</td><td class=3D"line-text">
</td></tr>
<tr><td class=3D"line-number">92</td><td class=3D"line-text">            pa=
geSeparator.Checked =3D svm.PageSepartor;
</td></tr>
<tr><td class=3D"line-number">93</td><td class=3D"line-text">            ro=
ws.Value =3D svm.Rows;
</td></tr>
<tr><td class=3D"line-number">94</td><td class=3D"line-text">            co=
lumns.Value =3D svm.Columns;
</td></tr>
<tr><td class=3D"line-number">95</td><td class=3D"line-text">            pa=
dding.Value =3D svm.Padding / <span class=3D"hljs-number">100</span>M;
</td></tr>
<tr><td class=3D"line-number">96</td><td class=3D"line-text">
</td></tr>
<tr><td class=3D"line-number">97</td><td class=3D"line-text">            sv=
m.PropertyChanged +=3D (s, e) =3D&gt; BeginInvoke((Action)(() =3D&gt; {
</td></tr>
<tr><td class=3D"line-number">98</td><td class=3D"line-text">              =
  Debug.WriteLine(<span class=3D"hljs-string">$"SheetViewModel.PropertyChan=
ged: <span class=3D"hljs-subst">{e.PropertyName}</span>"</span>);
</td></tr>
<tr><td class=3D"line-number">99</td><td class=3D"line-text">              =
  <span class=3D"hljs-keyword">switch</span> (e.PropertyName) {
</td></tr>
<tr><td class=3D"line-number">100</td><td class=3D"line-text">             =
       <span class=3D"hljs-keyword">case</span> <span class=3D"hljs-string"=
>"Landscape"</span>:
</td></tr>
<tr><td class=3D"line-number">101</td><td class=3D"line-text">             =
           Debug.WriteLine(<span class=3D"hljs-string">$"  Checking checkbo=
x: <span class=3D"hljs-subst">{ModelLocator.Current.Settings.Sheets.GetValu=
eOrDefault(ModelLocator.Current.Settings.DefaultSheet.ToString()).Landscape=
}</span>"</span>);
</td></tr>
<tr><td class=3D"line-number">102</td><td class=3D"line-text">             =
           landscapeCheckbox.Checked =3D svm.Landscape;
</td></tr>
<tr><td class=3D"line-number">103</td><td class=3D"line-text">             =
           <span class=3D"hljs-keyword">break</span>;
</td></tr>
<tr><td class=3D"line-number">104</td><td class=3D"line-text">
</td></tr>
<tr><td class=3D"line-number">105</td><td class=3D"line-text">             =
       <span class=3D"hljs-keyword">case</span> <span class=3D"hljs-string"=
>"Header"</span>:
</td></tr>
<tr><td class=3D"line-number">106</td><td class=3D"line-text">             =
           headerTextBox.Text =3D svm.Header.Text;
</td></tr>
<tr><td class=3D"line-number">107</td><td class=3D"line-text">             =
           <span class=3D"hljs-keyword">break</span>;
</td></tr>
<tr><td class=3D"line-number">108</td><td class=3D"line-text">
</td></tr>
<tr><td class=3D"line-number">109</td><td class=3D"line-text">             =
       <span class=3D"hljs-keyword">case</span> <span class=3D"hljs-string"=
>"Footer"</span>:
</td></tr>
<tr><td class=3D"line-number">110</td><td class=3D"line-text">             =
           footerTextBox.Text =3D svm.Footer.Text;
</td></tr>
<tr><td class=3D"line-number">111</td><td class=3D"line-text">             =
           <span class=3D"hljs-keyword">break</span>;
</td></tr>
<tr><td class=3D"line-number">112</td><td class=3D"line-text">
</td></tr>
<tr><td class=3D"line-number">113</td><td class=3D"line-text">             =
       <span class=3D"hljs-keyword">case</span> <span class=3D"hljs-string"=
>"Margins"</span>:
</td></tr>
<tr><td class=3D"line-number">114</td><td class=3D"line-text">             =
           topMargin.Value =3D svm.Margins.Top / <span class=3D"hljs-number=
">100</span>M;
</td></tr>
<tr><td class=3D"line-number">115</td><td class=3D"line-text">             =
           leftMargin.Value =3D svm.Margins.Left / <span class=3D"hljs-numb=
er">100</span>M;
</td></tr>
<tr><td class=3D"line-number">116</td><td class=3D"line-text">             =
           rightMargin.Value =3D svm.Margins.Right / <span class=3D"hljs-nu=
mber">100</span>M;
</td></tr>
<tr><td class=3D"line-number">117</td><td class=3D"line-text">             =
           bottomMargin.Value =3D svm.Margins.Bottom / <span class=3D"hljs-=
number">100</span>M;
</td></tr>
<tr><td class=3D"line-number">118</td><td class=3D"line-text">
</td></tr>
<tr><td class=3D"line-number">119</td><td class=3D"line-text">             =
           <span class=3D"hljs-comment">// Keep PrintDocument updated for W=
inForms.PrintPreview</span>
</td></tr>
<tr><td class=3D"line-number">120</td><td class=3D"line-text">             =
           printDoc.PrinterSettings.DefaultPageSettings.Margins =3D (Margin=
s)svm.Margins.Clone();
</td></tr>
<tr><td class=3D"line-number">121</td><td class=3D"line-text">             =
           <span class=3D"hljs-keyword">break</span>;
</td></tr>
<tr><td class=3D"line-number">122</td><td class=3D"line-text">
</td></tr>
<tr><td class=3D"line-number">123</td><td class=3D"line-text">             =
       <span class=3D"hljs-keyword">case</span> <span class=3D"hljs-string"=
>"PageSeparator"</span>:
</td></tr>
<tr><td class=3D"line-number">124</td><td class=3D"line-text">             =
           pageSeparator.Checked =3D svm.PageSepartor;
</td></tr>
<tr><td class=3D"line-number">125</td><td class=3D"line-text">             =
           <span class=3D"hljs-keyword">break</span>;
</td></tr>
<tr><td class=3D"line-number">126</td><td class=3D"line-text">
</td></tr>
<tr><td class=3D"line-number">127</td><td class=3D"line-text">             =
       <span class=3D"hljs-keyword">case</span> <span class=3D"hljs-string"=
>"Rows"</span>:
</td></tr>
<tr><td class=3D"line-number">128</td><td class=3D"line-text">             =
           rows.Value =3D svm.Rows;
</td></tr>
<tr><td class=3D"line-number">129</td><td class=3D"line-text">             =
           <span class=3D"hljs-keyword">break</span>;
</td></tr>
<tr><td class=3D"line-number">130</td><td class=3D"line-text">
</td></tr>
<tr><td class=3D"line-number">131</td><td class=3D"line-text">             =
       <span class=3D"hljs-keyword">case</span> <span class=3D"hljs-string"=
>"Columns"</span>:
</td></tr>
<tr><td class=3D"line-number">132</td><td class=3D"line-text">             =
           columns.Value =3D svm.Columns;
</td></tr>
<tr><td class=3D"line-number">133</td><td class=3D"line-text">             =
           <span class=3D"hljs-keyword">break</span>;
</td></tr>
<tr><td class=3D"line-number">134</td><td class=3D"line-text">
</td></tr>
<tr><td class=3D"line-number">135</td><td class=3D"line-text">             =
       <span class=3D"hljs-keyword">case</span> <span class=3D"hljs-string"=
>"Padding"</span>:
</td></tr>
<tr><td class=3D"line-number">136</td><td class=3D"line-text">             =
           padding.Value =3D svm.Padding / <span class=3D"hljs-number">100<=
/span>M;
</td></tr>
<tr><td class=3D"line-number">137</td><td class=3D"line-text">             =
           <span class=3D"hljs-keyword">break</span>;
</td></tr>
<tr><td class=3D"line-number">138</td><td class=3D"line-text">             =
   }
</td></tr>
<tr><td class=3D"line-number">139</td><td class=3D"line-text">            }=
));
</td></tr>
<tr><td class=3D"line-number">140</td><td class=3D"line-text">
</td></tr>
<tr><td class=3D"line-number">141</td><td class=3D"line-text">            s=
vm.SettingsChanged +=3D (s, reflow) =3D&gt; BeginInvoke((Action)(() =3D&gt;=
 {
</td></tr>
<tr><td class=3D"line-number">142</td><td class=3D"line-text">             =
   Debug.WriteLine(<span class=3D"hljs-string">$"SheetViewModel.SettingsCha=
nged: <span class=3D"hljs-subst">{reflow}</span>"</span>);
</td></tr>
<tr><td class=3D"line-number">143</td><td class=3D"line-text">             =
   <span class=3D"hljs-keyword">if</span> (reflow)
</td></tr>
<tr><td class=3D"line-number">144</td><td class=3D"line-text">             =
       SheetSettingsChanged();
</td></tr>
<tr><td class=3D"line-number">145</td><td class=3D"line-text">             =
   <span class=3D"hljs-keyword">else</span>
</td></tr>
<tr><td class=3D"line-number">146</td><td class=3D"line-text">             =
       printPreview.Invalidate(<span class=3D"hljs-literal">false</span>);
</td></tr>
<tr><td class=3D"line-number">147</td><td class=3D"line-text">            }=
));
</td></tr>
<tr><td class=3D"line-number">148</td><td class=3D"line-text">
</td></tr>
<tr><td class=3D"line-number">149</td><td class=3D"line-text">            p=
rintPreview.SheetViewModel =3D svm;
</td></tr>
<tr><td class=3D"line-number">150</td><td class=3D"line-text">
</td></tr>
<tr><td class=3D"line-number">151</td><td class=3D"line-text">            <=
span class=3D"hljs-comment">// <span class=3D"hljs-doctag">TODO:</span> Bat=
ch Print</span>
</td></tr>
<tr><td class=3D"line-number">152</td><td class=3D"line-text">            <=
span class=3D"hljs-keyword">if</span> (ModelLocator.Current.Options.Files !=
=3D <span class=3D"hljs-literal">null</span> &amp;&amp;
</td></tr>
<tr><td class=3D"line-number">153</td><td class=3D"line-text">             =
   ModelLocator.Current.Options.Files.Any() &amp;&amp;
</td></tr>
<tr><td class=3D"line-number">154</td><td class=3D"line-text">             =
   !<span class=3D"hljs-keyword">string</span>.IsNullOrEmpty(ModelLocator.C=
urrent.Options.Files.ToList()[<span class=3D"hljs-number">0</span>])) {
</td></tr>
<tr><td class=3D"line-number">155</td><td class=3D"line-text">             =
   List&lt;<span class=3D"hljs-keyword">string</span>&gt; list =3D ModelLoc=
ator.Current.Options.Files.ToList();
</td></tr>
<tr><td class=3D"line-number">156</td><td class=3D"line-text">             =
   file =3D list[<span class=3D"hljs-number">0</span>];
</td></tr>
<tr><td class=3D"line-number">157</td><td class=3D"line-text">            }
</td></tr>
<tr><td class=3D"line-number">158</td><td class=3D"line-text">
</td></tr>
<tr><td class=3D"line-number">159</td><td class=3D"line-text">            s=
vm.File =3D file;
</td></tr>
<tr><td class=3D"line-number">160</td><td class=3D"line-text">            <=
span class=3D"hljs-keyword">this</span>.Text =3D <span class=3D"hljs-string=
">$"WinPrint - <span class=3D"hljs-subst">{file}</span>"</span>;
</td></tr>
<tr><td class=3D"line-number">161</td><td class=3D"line-text">            <=
span class=3D"hljs-keyword">return</span> svm;
</td></tr>
<tr><td class=3D"line-number">162</td><td class=3D"line-text">        }
</td></tr>
<tr><td class=3D"line-number">163</td><td class=3D"line-text">
</td></tr>
<tr><td class=3D"line-number">164</td><td class=3D"line-text">        <span=
 class=3D"hljs-function"><span class=3D"hljs-keyword">private</span> <span =
class=3D"hljs-keyword">void</span> <span class=3D"hljs-title">landscapeChec=
kbox_CheckedChanged</span>(<span class=3D"hljs-params"><span class=3D"hljs-=
keyword">object</span> sender, EventArgs e</span>)</span> {
</td></tr>
<tr><td class=3D"line-number">165</td><td class=3D"line-text">            D=
ebug.WriteLine(<span class=3D"hljs-string">$"landscapeCheckbox_CheckedChang=
ed: <span class=3D"hljs-subst">{landscapeCheckbox.Checked}</span>"</span>);
</td></tr>
<tr><td class=3D"line-number">166</td><td class=3D"line-text">            <=
span class=3D"hljs-keyword">if</span> (printersCB.Enabled) {
</td></tr>
<tr><td class=3D"line-number">167</td><td class=3D"line-text">             =
   <span class=3D"hljs-comment">// <span class=3D"hljs-doctag">TODO:</span>=
 This should find the Preview SheetViewModel instance and set the property =
on this, not</span>
</td></tr>
<tr><td class=3D"line-number">168</td><td class=3D"line-text">             =
   <span class=3D"hljs-comment">// the model</span>
</td></tr>
<tr><td class=3D"line-number">169</td><td class=3D"line-text">             =
   ModelLocator.Current.Settings.Sheets.GetValueOrDefault(ModelLocator.Curr=
ent.Settings.DefaultSheet.ToString()).Landscape =3D
</td></tr>
<tr><td class=3D"line-number">170</td><td class=3D"line-text">             =
       printDoc.DefaultPageSettings.Landscape =3D
</td></tr>
<tr><td class=3D"line-number">171</td><td class=3D"line-text">             =
       landscapeCheckbox.Checked;
</td></tr>
<tr><td class=3D"line-number">172</td><td class=3D"line-text">
</td></tr>
<tr><td class=3D"line-number">173</td><td class=3D"line-text">             =
   <span class=3D"hljs-comment">// We do NOT force settings reflow here; as=
 it will come through with a SettingsChanged from viewmodel</span>
</td></tr>
<tr><td class=3D"line-number">174</td><td class=3D"line-text">             =
   <span class=3D"hljs-comment">//SheetSettingsChanged();</span>
</td></tr>
<tr><td class=3D"line-number">175</td><td class=3D"line-text">            }
</td></tr>
<tr><td class=3D"line-number">176</td><td class=3D"line-text">        }
</td></tr>
<tr><td class=3D"line-number">177</td><td class=3D"line-text">
</td></tr>
<tr><td class=3D"line-number">178</td><td class=3D"line-text">        <span=
 class=3D"hljs-function"><span class=3D"hljs-keyword">private</span> <span =
class=3D"hljs-keyword">void</span> <span class=3D"hljs-title">MainWindow_Lo=
ad</span>(<span class=3D"hljs-params"><span class=3D"hljs-keyword">object</=
span> sender, EventArgs e</span>)</span> {
</td></tr>
<tr><td class=3D"line-number">179</td><td class=3D"line-text">            <=
span class=3D"hljs-keyword">this</span>.Cursor =3D Cursors.WaitCursor;
</td></tr>
<tr><td class=3D"line-number">180</td><td class=3D"line-text">            <=
span class=3D"hljs-comment">// Load settings</span>
</td></tr>
<tr><td class=3D"line-number">181</td><td class=3D"line-text">            D=
ebug.WriteLine(<span class=3D"hljs-string">"First reference to ModelLocator=
.Current.Settings"</span>);
</td></tr>
<tr><td class=3D"line-number">182</td><td class=3D"line-text">            <=
span class=3D"hljs-keyword">var</span> sheets =3D ModelLocator.Current.Sett=
ings.Sheets;
</td></tr>
<tr><td class=3D"line-number">183</td><td class=3D"line-text">
</td></tr>
<tr><td class=3D"line-number">184</td><td class=3D"line-text">            M=
odelLocator.Current.Settings.PropertyChanged +=3D (s, e) =3D&gt; BeginInvok=
e((Action)(() =3D&gt; {
</td></tr>
<tr><td class=3D"line-number">185</td><td class=3D"line-text">             =
   Debug.WriteLine(<span class=3D"hljs-string">$"Settings.PropertyChanged: =
<span class=3D"hljs-subst">{e.PropertyName}</span>"</span>);
</td></tr>
<tr><td class=3D"line-number">186</td><td class=3D"line-text">             =
   <span class=3D"hljs-keyword">switch</span> (e.PropertyName) {
</td></tr>
<tr><td class=3D"line-number">187</td><td class=3D"line-text">             =
       <span class=3D"hljs-keyword">case</span> <span class=3D"hljs-string"=
>"DefaultSheet"</span>:
</td></tr>
<tr><td class=3D"line-number">188</td><td class=3D"line-text">             =
           comboBoxSheet.Text =3D ModelLocator.Current.Settings.Sheets.GetV=
alueOrDefault(ModelLocator.Current.Settings.DefaultSheet.ToString()).Name;
</td></tr>
<tr><td class=3D"line-number">189</td><td class=3D"line-text">             =
           ChangeSheet();
</td></tr>
<tr><td class=3D"line-number">190</td><td class=3D"line-text">             =
           <span class=3D"hljs-keyword">break</span>;
</td></tr>
<tr><td class=3D"line-number">191</td><td class=3D"line-text">             =
   }
</td></tr>
<tr><td class=3D"line-number">192</td><td class=3D"line-text">            }=
));
</td></tr>
<tr><td class=3D"line-number">193</td><td class=3D"line-text">
</td></tr>
<tr><td class=3D"line-number">194</td><td class=3D"line-text">            c=
omboBoxSheet.DisplayMember =3D <span class=3D"hljs-string">"Value"</span>;
</td></tr>
<tr><td class=3D"line-number">195</td><td class=3D"line-text">            c=
omboBoxSheet.ValueMember =3D <span class=3D"hljs-string">"Key"</span>;
</td></tr>
<tr><td class=3D"line-number">196</td><td class=3D"line-text">            <=
span class=3D"hljs-keyword">foreach</span> (<span class=3D"hljs-keyword">va=
r</span> s <span class=3D"hljs-keyword">in</span> sheets) {
</td></tr>
<tr><td class=3D"line-number">197</td><td class=3D"line-text">             =
   comboBoxSheet.Items.Add(<span class=3D"hljs-keyword">new</span> KeyValue=
Pair&lt;<span class=3D"hljs-keyword">string</span>, <span class=3D"hljs-key=
word">string</span>&gt;(s.Key, s.Value.Name));
</td></tr>
<tr><td class=3D"line-number">198</td><td class=3D"line-text">            }
</td></tr>
<tr><td class=3D"line-number">199</td><td class=3D"line-text">
</td></tr>
<tr><td class=3D"line-number">200</td><td class=3D"line-text">            <=
span class=3D"hljs-comment">// Select default printer and paper size</span>
</td></tr>
<tr><td class=3D"line-number">201</td><td class=3D"line-text">            <=
span class=3D"hljs-keyword">foreach</span> (<span class=3D"hljs-keyword">st=
ring</span> printer <span class=3D"hljs-keyword">in</span> System.Drawing.P=
rinting.PrinterSettings.InstalledPrinters) {
</td></tr>
<tr><td class=3D"line-number">202</td><td class=3D"line-text">             =
   printersCB.Items.Add(printer);
</td></tr>
<tr><td class=3D"line-number">203</td><td class=3D"line-text">             =
   <span class=3D"hljs-comment">//printersCB.Text =3D "OneNote";</span>
</td></tr>
<tr><td class=3D"line-number">204</td><td class=3D"line-text">             =
   <span class=3D"hljs-keyword">if</span> (printDoc.PrinterSettings.IsDefau=
ltPrinter)
</td></tr>
<tr><td class=3D"line-number">205</td><td class=3D"line-text">             =
       printersCB.Text =3D printDoc.PrinterSettings.PrinterName;
</td></tr>
<tr><td class=3D"line-number">206</td><td class=3D"line-text">            }
</td></tr>
<tr><td class=3D"line-number">207</td><td class=3D"line-text">            p=
rintDoc.PrinterSettings.PrinterName =3D (<span class=3D"hljs-keyword">strin=
g</span>)printersCB.SelectedItem;
</td></tr>
<tr><td class=3D"line-number">208</td><td class=3D"line-text">            <=
span class=3D"hljs-keyword">foreach</span> (PaperSize ps <span class=3D"hlj=
s-keyword">in</span> printDoc.PrinterSettings.PaperSizes) {
</td></tr>
<tr><td class=3D"line-number">209</td><td class=3D"line-text">             =
   paperSizesCB.Items.Add(ps);
</td></tr>
<tr><td class=3D"line-number">210</td><td class=3D"line-text">            }
</td></tr>
<tr><td class=3D"line-number">211</td><td class=3D"line-text">            p=
aperSizesCB.Text =3D printDoc.DefaultPageSettings.PaperSize.ToString();
</td></tr>
<tr><td class=3D"line-number">212</td><td class=3D"line-text">
</td></tr>
<tr><td class=3D"line-number">213</td><td class=3D"line-text">            <=
span class=3D"hljs-comment">// We kept these disabled during load</span>
</td></tr>
<tr><td class=3D"line-number">214</td><td class=3D"line-text">            p=
rintersCB.Enabled =3D <span class=3D"hljs-literal">true</span>;
</td></tr>
<tr><td class=3D"line-number">215</td><td class=3D"line-text">            p=
aperSizesCB.Enabled =3D <span class=3D"hljs-literal">true</span>;
</td></tr>
<tr><td class=3D"line-number">216</td><td class=3D"line-text">
</td></tr>
<tr><td class=3D"line-number">217</td><td class=3D"line-text">            <=
span class=3D"hljs-comment">// Select default Sheet </span>
</td></tr>
<tr><td class=3D"line-number">218</td><td class=3D"line-text">            c=
omboBoxSheet.Text =3D ModelLocator.Current.Settings.Sheets.GetValueOrDefaul=
t(ModelLocator.Current.Settings.DefaultSheet.ToString()).Name;
</td></tr>
<tr><td class=3D"line-number">219</td><td class=3D"line-text">
</td></tr>
<tr><td class=3D"line-number">220</td><td class=3D"line-text">            <=
span class=3D"hljs-keyword">if</span> (ModelLocator.Current.Options.Files !=
=3D <span class=3D"hljs-literal">null</span>)
</td></tr>
<tr><td class=3D"line-number">221</td><td class=3D"line-text">             =
   <span class=3D"hljs-comment">//&amp;&amp;</span>
</td></tr>
<tr><td class=3D"line-number">222</td><td class=3D"line-text">             =
   <span class=3D"hljs-comment">//  ModelLocator.Current.Options.Files.Any(=
) &amp;&amp;</span>
</td></tr>
<tr><td class=3D"line-number">223</td><td class=3D"line-text">             =
   <span class=3D"hljs-comment">//  !string.IsNullOrEmpty(ModelLocator.Curr=
ent.Options.Files.ToList&lt;string&gt;()[0])) </span>
</td></tr>
<tr><td class=3D"line-number">224</td><td class=3D"line-text">            {
</td></tr>
<tr><td class=3D"line-number">225</td><td class=3D"line-text">             =
   file =3D ModelLocator.Current.Options.Files.ToList()[<span class=3D"hljs=
-number">0</span>];
</td></tr>
<tr><td class=3D"line-number">226</td><td class=3D"line-text">            }
</td></tr>
<tr><td class=3D"line-number">227</td><td class=3D"line-text">
</td></tr>
<tr><td class=3D"line-number">228</td><td class=3D"line-text">            p=
rintPreview.Select();
</td></tr>
<tr><td class=3D"line-number">229</td><td class=3D"line-text">            <=
span class=3D"hljs-keyword">this</span>.Size =3D <span class=3D"hljs-keywor=
d">new</span> Size(ModelLocator.Current.Settings.Size.Width, ModelLocator.C=
urrent.Settings.Size.Height);
</td></tr>
<tr><td class=3D"line-number">230</td><td class=3D"line-text">            <=
span class=3D"hljs-keyword">this</span>.Location =3D <span class=3D"hljs-ke=
yword">new</span> Point(ModelLocator.Current.Settings.Location.X, ModelLoca=
tor.Current.Settings.Location.Y);
</td></tr>
<tr><td class=3D"line-number">231</td><td class=3D"line-text">            <=
span class=3D"hljs-keyword">this</span>.WindowState =3D (System.Windows.For=
ms.FormWindowState)ModelLocator.Current.Settings.WindowState;
</td></tr>
<tr><td class=3D"line-number">232</td><td class=3D"line-text">
</td></tr>
<tr><td class=3D"line-number">233</td><td class=3D"line-text">            <=
span class=3D"hljs-keyword">this</span>.Cursor =3D Cursors.Default;
</td></tr>
<tr><td class=3D"line-number">234</td><td class=3D"line-text">
</td></tr>
<tr><td class=3D"line-number">235</td><td class=3D"line-text">            <=
span class=3D"hljs-keyword">if</span> (<span class=3D"hljs-keyword">string<=
/span>.IsNullOrEmpty(file)) {
</td></tr>
<tr><td class=3D"line-number">236</td><td class=3D"line-text">             =
   <span class=3D"hljs-keyword">using</span> (OpenFileDialog openFileDialog=
 =3D <span class=3D"hljs-keyword">new</span> OpenFileDialog()) {
</td></tr>
<tr><td class=3D"line-number">237</td><td class=3D"line-text">             =
      =20
</td></tr>
<tr><td class=3D"line-number">238</td><td class=3D"line-text">             =
       openFileDialog.InitialDirectory =3D <span class=3D"hljs-string">$"<s=
pan class=3D"hljs-subst">{Environment.GetFolderPath(Environment.SpecialFold=
er.UserProfile)}</span>\\source\\winprint\\tests"</span>;
</td></tr>
<tr><td class=3D"line-number">239</td><td class=3D"line-text">             =
       openFileDialog.Filter =3D <span class=3D"hljs-string">"code files (*=
.c*)|*.c*|txt files (*.txt)|*.txt|All files (*.*)|*.*"</span>;
</td></tr>
<tr><td class=3D"line-number">240</td><td class=3D"line-text">             =
       openFileDialog.FilterIndex =3D <span class=3D"hljs-number">3</span>;
</td></tr>
<tr><td class=3D"line-number">241</td><td class=3D"line-text">             =
       openFileDialog.RestoreDirectory =3D <span class=3D"hljs-literal">tru=
e</span>;
</td></tr>
<tr><td class=3D"line-number">242</td><td class=3D"line-text">             =
       <span class=3D"hljs-keyword">if</span> (openFileDialog.ShowDialog() =
=3D=3D DialogResult.OK) {
</td></tr>
<tr><td class=3D"line-number">243</td><td class=3D"line-text">             =
           file =3D openFileDialog.FileNames.ToList&lt;<span class=3D"hljs-=
keyword">string</span>&gt;()[<span class=3D"hljs-number">0</span>];
</td></tr>
<tr><td class=3D"line-number">244</td><td class=3D"line-text">             =
       }
</td></tr>
<tr><td class=3D"line-number">245</td><td class=3D"line-text">             =
   }
</td></tr>
<tr><td class=3D"line-number">246</td><td class=3D"line-text">            }
</td></tr>
<tr><td class=3D"line-number">247</td><td class=3D"line-text">            <=
span class=3D"hljs-comment">// Go!</span>
</td></tr>
<tr><td class=3D"line-number">248</td><td class=3D"line-text">            C=
hangeSheet();
</td></tr>
<tr><td class=3D"line-number">249</td><td class=3D"line-text">
</td></tr>
<tr><td class=3D"line-number">250</td><td class=3D"line-text">        }
</td></tr>
<tr><td class=3D"line-number">251</td><td class=3D"line-text">
</td></tr>
<tr><td class=3D"line-number">252</td><td class=3D"line-text">        <span=
 class=3D"hljs-function"><span class=3D"hljs-keyword">private</span> <span =
class=3D"hljs-keyword">void</span> <span class=3D"hljs-title">ChangeSheet</=
span>(<span class=3D"hljs-params"></span>)</span> {
</td></tr>
<tr><td class=3D"line-number">253</td><td class=3D"line-text">            <=
span class=3D"hljs-keyword">this</span>.Cursor =3D Cursors.WaitCursor;
</td></tr>
<tr><td class=3D"line-number">254</td><td class=3D"line-text">            p=
rintPreview.SheetViewModel =3D CreatePreviewSheetViewModel();
</td></tr>
<tr><td class=3D"line-number">255</td><td class=3D"line-text">            <=
span class=3D"hljs-keyword">this</span>.Cursor =3D Cursors.Default;
</td></tr>
<tr><td class=3D"line-number">256</td><td class=3D"line-text">            S=
heetSettingsChanged();
</td></tr>
<tr><td class=3D"line-number">257</td><td class=3D"line-text">        }
</td></tr>
<tr><td class=3D"line-number">258</td><td class=3D"line-text">
</td></tr>
<tr><td class=3D"line-number">259</td><td class=3D"line-text">        <span=
 class=3D"hljs-function"><span class=3D"hljs-keyword">private</span> <span =
class=3D"hljs-keyword">void</span> <span class=3D"hljs-title">MainWindow_Fo=
rmClosing</span>(<span class=3D"hljs-params"><span class=3D"hljs-keyword">o=
bject</span> sender, FormClosingEventArgs e</span>)</span> {
</td></tr>
<tr><td class=3D"line-number">260</td><td class=3D"line-text">            <=
span class=3D"hljs-comment">// Save Window state</span>
</td></tr>
<tr><td class=3D"line-number">261</td><td class=3D"line-text">            <=
span class=3D"hljs-keyword">if</span> (<span class=3D"hljs-keyword">this</s=
pan>.WindowState =3D=3D System.Windows.Forms.FormWindowState.Normal) {
</td></tr>
<tr><td class=3D"line-number">262</td><td class=3D"line-text">             =
   ModelLocator.Current.Settings.Size =3D <span class=3D"hljs-keyword">new<=
/span> Core.Models.WindowSize(<span class=3D"hljs-keyword">this</span>.Size=
.Width, <span class=3D"hljs-keyword">this</span>.Size.Height);
</td></tr>
<tr><td class=3D"line-number">263</td><td class=3D"line-text">             =
   ModelLocator.Current.Settings.Location =3D <span class=3D"hljs-keyword">=
new</span> Core.Models.WindowLocation(<span class=3D"hljs-keyword">this</sp=
an>.Location.X, <span class=3D"hljs-keyword">this</span>.Location.Y);
</td></tr>
<tr><td class=3D"line-number">264</td><td class=3D"line-text">            }
</td></tr>
<tr><td class=3D"line-number">265</td><td class=3D"line-text">            <=
span class=3D"hljs-keyword">else</span> {
</td></tr>
<tr><td class=3D"line-number">266</td><td class=3D"line-text">             =
   ModelLocator.Current.Settings.Size =3D <span class=3D"hljs-keyword">new<=
/span> Core.Models.WindowSize(<span class=3D"hljs-keyword">this</span>.Rest=
oreBounds.Width, <span class=3D"hljs-keyword">this</span>.RestoreBounds.Hei=
ght);
</td></tr>
<tr><td class=3D"line-number">267</td><td class=3D"line-text">             =
   ModelLocator.Current.Settings.Location =3D <span class=3D"hljs-keyword">=
new</span> Core.Models.WindowLocation(<span class=3D"hljs-keyword">this</sp=
an>.RestoreBounds.X, <span class=3D"hljs-keyword">this</span>.RestoreBounds=
.Y);
</td></tr>
<tr><td class=3D"line-number">268</td><td class=3D"line-text">            }
</td></tr>
<tr><td class=3D"line-number">269</td><td class=3D"line-text">            M=
odelLocator.Current.Settings.WindowState =3D (Core.Models.FormWindowState)<=
span class=3D"hljs-keyword">this</span>.WindowState;
</td></tr>
<tr><td class=3D"line-number">270</td><td class=3D"line-text">            S=
erviceLocator.Current.SettingsService.SaveSettings(ModelLocator.Current.Set=
tings);
</td></tr>
<tr><td class=3D"line-number">271</td><td class=3D"line-text">        }
</td></tr>
<tr><td class=3D"line-number">272</td><td class=3D"line-text">
</td></tr>
<tr><td class=3D"line-number">273</td><td class=3D"line-text">        <span=
 class=3D"hljs-function"><span class=3D"hljs-keyword">internal</span> <span=
 class=3D"hljs-keyword">void</span> <span class=3D"hljs-title">SheetSetting=
sChanged</span>(<span class=3D"hljs-params"></span>)</span> {
</td></tr>
<tr><td class=3D"line-number">274</td><td class=3D"line-text">            D=
ebug.WriteLine(<span class=3D"hljs-string">"SheetSettingsChanged()"</span>)=
;
</td></tr>
<tr><td class=3D"line-number">275</td><td class=3D"line-text">
</td></tr>
<tr><td class=3D"line-number">276</td><td class=3D"line-text">            <=
span class=3D"hljs-keyword">this</span>.Cursor =3D Cursors.WaitCursor;
</td></tr>
<tr><td class=3D"line-number">277</td><td class=3D"line-text">            <=
span class=3D"hljs-comment">// Set landscape. This causes other DefaultPage=
Settings to change</span>
</td></tr>
<tr><td class=3D"line-number">278</td><td class=3D"line-text">            p=
rintDoc.DefaultPageSettings.Landscape =3D landscapeCheckbox.Checked;
</td></tr>
<tr><td class=3D"line-number">279</td><td class=3D"line-text">            p=
rintPreview.SheetViewModel.Reflow(printDoc.DefaultPageSettings);
</td></tr>
<tr><td class=3D"line-number">280</td><td class=3D"line-text">            p=
rintPreview.Invalidate(<span class=3D"hljs-literal">true</span>);
</td></tr>
<tr><td class=3D"line-number">281</td><td class=3D"line-text">            S=
izePreview();
</td></tr>
<tr><td class=3D"line-number">282</td><td class=3D"line-text">
</td></tr>
<tr><td class=3D"line-number">283</td><td class=3D"line-text">            <=
span class=3D"hljs-keyword">this</span>.Cursor =3D Cursors.Default;
</td></tr>
<tr><td class=3D"line-number">284</td><td class=3D"line-text">        }
</td></tr>
<tr><td class=3D"line-number">285</td><td class=3D"line-text">
</td></tr>
<tr><td class=3D"line-number">286</td><td class=3D"line-text">        <span=
 class=3D"hljs-function"><span class=3D"hljs-keyword">internal</span> <span=
 class=3D"hljs-keyword">void</span> <span class=3D"hljs-title">SizePreview<=
/span>(<span class=3D"hljs-params"></span>)</span> {
</td></tr>
<tr><td class=3D"line-number">287</td><td class=3D"line-text">            D=
ebug.WriteLine(<span class=3D"hljs-string">"SizePreview()"</span>);
</td></tr>
<tr><td class=3D"line-number">288</td><td class=3D"line-text">            <=
span class=3D"hljs-keyword">if</span> (printPreview =3D=3D <span class=3D"h=
ljs-literal">null</span> || printPreview.SheetViewModel =3D=3D <span class=
=3D"hljs-literal">null</span>) <span class=3D"hljs-keyword">return</span>;
</td></tr>
<tr><td class=3D"line-number">289</td><td class=3D"line-text">            S=
ize size =3D panelRight.Size;
</td></tr>
<tr><td class=3D"line-number">290</td><td class=3D"line-text">            s=
ize.Height -=3D headerTextBox.Height * <span class=3D"hljs-number">3</span>=
;
</td></tr>
<tr><td class=3D"line-number">291</td><td class=3D"line-text">            s=
ize.Width -=3D headerTextBox.Height;
</td></tr>
<tr><td class=3D"line-number">292</td><td class=3D"line-text">
</td></tr>
<tr><td class=3D"line-number">293</td><td class=3D"line-text">            <=
span class=3D"hljs-keyword">double</span> w =3D printPreview.SheetViewModel=
.Bounds.Width;
</td></tr>
<tr><td class=3D"line-number">294</td><td class=3D"line-text">            <=
span class=3D"hljs-keyword">double</span> h =3D printPreview.SheetViewModel=
.Bounds.Height;
</td></tr>
<tr><td class=3D"line-number">295</td><td class=3D"line-text">
</td></tr>
<tr><td class=3D"line-number">296</td><td class=3D"line-text">            <=
span class=3D"hljs-keyword">var</span> scalingX =3D (<span class=3D"hljs-ke=
yword">double</span>)size.Width / (<span class=3D"hljs-keyword">double</spa=
n>)w;
</td></tr>
<tr><td class=3D"line-number">297</td><td class=3D"line-text">            <=
span class=3D"hljs-keyword">var</span> scalingY =3D (<span class=3D"hljs-ke=
yword">double</span>)size.Height / (<span class=3D"hljs-keyword">double</sp=
an>)h;
</td></tr>
<tr><td class=3D"line-number">298</td><td class=3D"line-text">
</td></tr>
<tr><td class=3D"line-number">299</td><td class=3D"line-text">            <=
span class=3D"hljs-comment">// Now, we have two scaling ratios, which one p=
roduces the smaller image? The one that has the smallest scaling factor.</s=
pan>
</td></tr>
<tr><td class=3D"line-number">300</td><td class=3D"line-text">            <=
span class=3D"hljs-keyword">var</span> scale =3D Math.Min(scalingY, scaling=
X);
</td></tr>
<tr><td class=3D"line-number">301</td><td class=3D"line-text">
</td></tr>
<tr><td class=3D"line-number">302</td><td class=3D"line-text">            p=
rintPreview.Size =3D <span class=3D"hljs-keyword">new</span> Size((<span cl=
ass=3D"hljs-keyword">int</span>)(w * scale), (<span class=3D"hljs-keyword">=
int</span>)(h * scale));
</td></tr>
<tr><td class=3D"line-number">303</td><td class=3D"line-text">
</td></tr>
<tr><td class=3D"line-number">304</td><td class=3D"line-text">            <=
span class=3D"hljs-comment">// Now center</span>
</td></tr>
<tr><td class=3D"line-number">305</td><td class=3D"line-text">            p=
rintPreview.Location =3D <span class=3D"hljs-keyword">new</span> Point((pan=
elRight.Width / <span class=3D"hljs-number">2</span>) - (printPreview.Width=
 / <span class=3D"hljs-number">2</span>),
</td></tr>
<tr><td class=3D"line-number">306</td><td class=3D"line-text">             =
   (panelRight.Height / <span class=3D"hljs-number">2</span>) - (printPrevi=
ew.Height / <span class=3D"hljs-number">2</span>));
</td></tr>
<tr><td class=3D"line-number">307</td><td class=3D"line-text">        }
</td></tr>
<tr><td class=3D"line-number">308</td><td class=3D"line-text">
</td></tr>
<tr><td class=3D"line-number">309</td><td class=3D"line-text">        <span=
 class=3D"hljs-function"><span class=3D"hljs-keyword">private</span> <span =
class=3D"hljs-keyword">void</span> <span class=3D"hljs-title">MainWindow_La=
yout</span>(<span class=3D"hljs-params"><span class=3D"hljs-keyword">object=
</span> sender, LayoutEventArgs e</span>)</span> {
</td></tr>
<tr><td class=3D"line-number">310</td><td class=3D"line-text">            <=
span class=3D"hljs-comment">// This event is raised once at startup with th=
e AffectedControl</span>
</td></tr>
<tr><td class=3D"line-number">311</td><td class=3D"line-text">            <=
span class=3D"hljs-comment">// and AffectedProperty properties on the Layou=
tEventArgs as null. </span>
</td></tr>
<tr><td class=3D"line-number">312</td><td class=3D"line-text">            <=
span class=3D"hljs-comment">// The event provides size preferences for that=
 case.</span>
</td></tr>
<tr><td class=3D"line-number">313</td><td class=3D"line-text">            <=
span class=3D"hljs-keyword">if</span> ((e.AffectedControl !=3D <span class=
=3D"hljs-literal">null</span>) &amp;&amp; (e.AffectedProperty !=3D <span cl=
ass=3D"hljs-literal">null</span>)) {
</td></tr>
<tr><td class=3D"line-number">314</td><td class=3D"line-text">             =
   <span class=3D"hljs-comment">// Ensure that the affected property is the=
 Bounds property</span>
</td></tr>
<tr><td class=3D"line-number">315</td><td class=3D"line-text">             =
   <span class=3D"hljs-comment">// of the form.</span>
</td></tr>
<tr><td class=3D"line-number">316</td><td class=3D"line-text">             =
   <span class=3D"hljs-keyword">if</span> (e.AffectedProperty.ToString().Eq=
uals(<span class=3D"hljs-string">"Bounds"</span>, StringComparison.Invarian=
tCultureIgnoreCase)) {
</td></tr>
<tr><td class=3D"line-number">317</td><td class=3D"line-text">             =
       Debug.WriteLine(<span class=3D"hljs-string">"MainWindow_Layout bound=
s changed"</span>);
</td></tr>
<tr><td class=3D"line-number">318</td><td class=3D"line-text">             =
   }
</td></tr>
<tr><td class=3D"line-number">319</td><td class=3D"line-text">            }
</td></tr>
<tr><td class=3D"line-number">320</td><td class=3D"line-text">        }
</td></tr>
<tr><td class=3D"line-number">321</td><td class=3D"line-text">
</td></tr>
<tr><td class=3D"line-number">322</td><td class=3D"line-text">        <span=
 class=3D"hljs-function"><span class=3D"hljs-keyword">private</span> <span =
class=3D"hljs-keyword">void</span> <span class=3D"hljs-title">headerTextBox=
_TextChanged</span>(<span class=3D"hljs-params"><span class=3D"hljs-keyword=
">object</span> sender, EventArgs e</span>)</span> {
</td></tr>
<tr><td class=3D"line-number">323</td><td class=3D"line-text">            M=
odelLocator.Current.Settings.Sheets.GetValueOrDefault(
</td></tr>
<tr><td class=3D"line-number">324</td><td class=3D"line-text">             =
   ModelLocator.Current.Settings.DefaultSheet.ToString()).Header.Text =3D h=
eaderTextBox.Text;
</td></tr>
<tr><td class=3D"line-number">325</td><td class=3D"line-text">        }
</td></tr>
<tr><td class=3D"line-number">326</td><td class=3D"line-text">
</td></tr>
<tr><td class=3D"line-number">327</td><td class=3D"line-text">        <span=
 class=3D"hljs-function"><span class=3D"hljs-keyword">private</span> <span =
class=3D"hljs-keyword">void</span> <span class=3D"hljs-title">footerTextBox=
_TextChanged</span>(<span class=3D"hljs-params"><span class=3D"hljs-keyword=
">object</span> sender, EventArgs e</span>)</span> {
</td></tr>
<tr><td class=3D"line-number">328</td><td class=3D"line-text">            M=
odelLocator.Current.Settings.Sheets.GetValueOrDefault(
</td></tr>
<tr><td class=3D"line-number">329</td><td class=3D"line-text">             =
   ModelLocator.Current.Settings.DefaultSheet.ToString()).Footer.Text =3D f=
ooterTextBox.Text;
</td></tr>
<tr><td class=3D"line-number">330</td><td class=3D"line-text">        }
</td></tr>
<tr><td class=3D"line-number">331</td><td class=3D"line-text">
</td></tr>
<tr><td class=3D"line-number">332</td><td class=3D"line-text">        <span=
 class=3D"hljs-function"><span class=3D"hljs-keyword">private</span> <span =
class=3D"hljs-keyword">void</span> <span class=3D"hljs-title">printersCB_Se=
lectedIndexChanged</span>(<span class=3D"hljs-params"><span class=3D"hljs-k=
eyword">object</span> sender, EventArgs e</span>)</span> {
</td></tr>
<tr><td class=3D"line-number">333</td><td class=3D"line-text">            <=
span class=3D"hljs-keyword">if</span> (printersCB.Enabled) {
</td></tr>
<tr><td class=3D"line-number">334</td><td class=3D"line-text">             =
   Debug.WriteLine(<span class=3D"hljs-string">"printersCB_SelectedIndexCha=
nged"</span>);
</td></tr>
<tr><td class=3D"line-number">335</td><td class=3D"line-text">             =
   printDoc.PrinterSettings.PrinterName =3D (<span class=3D"hljs-keyword">s=
tring</span>)printersCB.SelectedItem;
</td></tr>
<tr><td class=3D"line-number">336</td><td class=3D"line-text">             =
   paperSizesCB.Items.Clear();
</td></tr>
<tr><td class=3D"line-number">337</td><td class=3D"line-text">             =
   <span class=3D"hljs-keyword">foreach</span> (PaperSize ps <span class=3D=
"hljs-keyword">in</span> printDoc.PrinterSettings.PaperSizes) {
</td></tr>
<tr><td class=3D"line-number">338</td><td class=3D"line-text">             =
       paperSizesCB.Items.Add(ps);
</td></tr>
<tr><td class=3D"line-number">339</td><td class=3D"line-text">             =
   }
</td></tr>
<tr><td class=3D"line-number">340</td><td class=3D"line-text">             =
   paperSizesCB.Text =3D printDoc.DefaultPageSettings.PaperSize.ToString();
</td></tr>
<tr><td class=3D"line-number">341</td><td class=3D"line-text">            }
</td></tr>
<tr><td class=3D"line-number">342</td><td class=3D"line-text">        }
</td></tr>
<tr><td class=3D"line-number">343</td><td class=3D"line-text">
</td></tr>
<tr><td class=3D"line-number">344</td><td class=3D"line-text">        <span=
 class=3D"hljs-function"><span class=3D"hljs-keyword">private</span> <span =
class=3D"hljs-keyword">void</span> <span class=3D"hljs-title">paperSizesCB_=
SelectedIndexChanged</span>(<span class=3D"hljs-params"><span class=3D"hljs=
-keyword">object</span> sender, EventArgs e</span>)</span> {
</td></tr>
<tr><td class=3D"line-number">345</td><td class=3D"line-text">            <=
span class=3D"hljs-keyword">if</span> (printersCB.Enabled) {
</td></tr>
<tr><td class=3D"line-number">346</td><td class=3D"line-text">             =
   Debug.WriteLine(<span class=3D"hljs-string">"paperSizesCB_SelectedIndexC=
hanged"</span>);
</td></tr>
<tr><td class=3D"line-number">347</td><td class=3D"line-text">             =
   <span class=3D"hljs-comment">// Set the paper size based upon the select=
ion in the combo box.</span>
</td></tr>
<tr><td class=3D"line-number">348</td><td class=3D"line-text">             =
   <span class=3D"hljs-keyword">if</span> (paperSizesCB.SelectedIndex !=3D =
<span class=3D"hljs-number">-1</span>) {
</td></tr>
<tr><td class=3D"line-number">349</td><td class=3D"line-text">             =
       printDoc.DefaultPageSettings.PaperSize =3D printDoc.PrinterSettings.=
PaperSizes[paperSizesCB.SelectedIndex];
</td></tr>
<tr><td class=3D"line-number">350</td><td class=3D"line-text">             =
   }
</td></tr>
<tr><td class=3D"line-number">351</td><td class=3D"line-text">             =
   SheetSettingsChanged();
</td></tr>
<tr><td class=3D"line-number">352</td><td class=3D"line-text">            }
</td></tr>
<tr><td class=3D"line-number">353</td><td class=3D"line-text">        }
</td></tr>
<tr><td class=3D"line-number">354</td><td class=3D"line-text">
</td></tr>
<tr><td class=3D"line-number">355</td><td class=3D"line-text">        [<spa=
n class=3D"hljs-meta">System.Diagnostics.CodeAnalysis.SuppressMessage(<span=
 class=3D"hljs-meta-string">"Design"</span>, <span class=3D"hljs-meta-strin=
g">"CA1031:Do not catch general exception types"</span>, Justification =3D =
<span class=3D"hljs-meta-string">"&lt;Pending&gt;"</span>)</span>]
</td></tr>
<tr><td class=3D"line-number">356</td><td class=3D"line-text">        <span=
 class=3D"hljs-function"><span class=3D"hljs-keyword">private</span> <span =
class=3D"hljs-keyword">void</span> <span class=3D"hljs-title">printButton_C=
lick</span>(<span class=3D"hljs-params"><span class=3D"hljs-keyword">object=
</span> sender, EventArgs e</span>)</span> {
</td></tr>
<tr><td class=3D"line-number">357</td><td class=3D"line-text">            <=
span class=3D"hljs-keyword">using</span> <span class=3D"hljs-keyword">var</=
span> print =3D <span class=3D"hljs-keyword">new</span> Core.Print();
</td></tr>
<tr><td class=3D"line-number">358</td><td class=3D"line-text">            <=
span class=3D"hljs-comment">// <span class=3D"hljs-doctag">TODO:</span> It'=
s hokey that Landscape is the only printer setting that's treated specially=
</span>
</td></tr>
<tr><td class=3D"line-number">359</td><td class=3D"line-text">            <=
span class=3D"hljs-comment">// </span>
</td></tr>
<tr><td class=3D"line-number">360</td><td class=3D"line-text">            p=
rint.PrintDocument.DefaultPageSettings.Landscape =3D landscapeCheckbox.Chec=
ked;
</td></tr>
<tr><td class=3D"line-number">361</td><td class=3D"line-text">            p=
rint.SheetVM.File =3D file;
</td></tr>
<tr><td class=3D"line-number">362</td><td class=3D"line-text">            p=
rint.SheetVM.SetSettings(ModelLocator.Current.Settings.Sheets.GetValueOrDef=
ault(ModelLocator.Current.Settings.DefaultSheet.ToString()));
</td></tr>
<tr><td class=3D"line-number">363</td><td class=3D"line-text">            p=
rint.SetPrinter(printDoc.PrinterSettings.PrinterName);
</td></tr>
<tr><td class=3D"line-number">364</td><td class=3D"line-text">            p=
rint.SetPaperSize(printDoc.DefaultPageSettings.PaperSize.PaperName);
</td></tr>
<tr><td class=3D"line-number">365</td><td class=3D"line-text">
</td></tr>
<tr><td class=3D"line-number">366</td><td class=3D"line-text">            <=
span class=3D"hljs-comment">// <span class=3D"hljs-doctag">TODO:</span> Dec=
ide how to make showing the print dialog a setting (or if needed at all)</s=
pan>
</td></tr>
<tr><td class=3D"line-number">367</td><td class=3D"line-text">            <=
span class=3D"hljs-comment">// the only reason I can think of now is from/t=
o page support.</span>
</td></tr>
<tr><td class=3D"line-number">368</td><td class=3D"line-text">            <=
span class=3D"hljs-keyword">bool</span> showPrintDialog =3D <span class=3D"=
hljs-literal">true</span>;
</td></tr>
<tr><td class=3D"line-number">369</td><td class=3D"line-text">            <=
span class=3D"hljs-keyword">if</span> (showPrintDialog) {
</td></tr>
<tr><td class=3D"line-number">370</td><td class=3D"line-text">             =
   <span class=3D"hljs-keyword">using</span> PrintDialog printDialog =3D <s=
pan class=3D"hljs-keyword">new</span> PrintDialog();
</td></tr>
<tr><td class=3D"line-number">371</td><td class=3D"line-text">             =
   printDialog.AllowSomePages =3D <span class=3D"hljs-literal">true</span>;
</td></tr>
<tr><td class=3D"line-number">372</td><td class=3D"line-text">             =
   printDialog.ShowHelp =3D <span class=3D"hljs-literal">true</span>;
</td></tr>
<tr><td class=3D"line-number">373</td><td class=3D"line-text">             =
   <span class=3D"hljs-comment">// printDialog.AllowSelection =3D true;</sp=
an>
</td></tr>
<tr><td class=3D"line-number">374</td><td class=3D"line-text">
</td></tr>
<tr><td class=3D"line-number">375</td><td class=3D"line-text">             =
   printDialog.Document =3D print.PrintDocument;
</td></tr>
<tr><td class=3D"line-number">376</td><td class=3D"line-text">             =
   printDialog.PrinterSettings.FromPage =3D <span class=3D"hljs-number">1</=
span>;
</td></tr>
<tr><td class=3D"line-number">377</td><td class=3D"line-text">             =
   <span class=3D"hljs-comment">// Ideally we'd get NumSheets from print.Sh=
eetSVM but that would cause a</span>
</td></tr>
<tr><td class=3D"line-number">378</td><td class=3D"line-text">             =
   <span class=3D"hljs-comment">// un-needed Reflow. So use the printPrevie=
w VM.</span>
</td></tr>
<tr><td class=3D"line-number">379</td><td class=3D"line-text">             =
   printDialog.PrinterSettings.ToPage =3D printPreview.SheetViewModel.NumSh=
eets;
</td></tr>
<tr><td class=3D"line-number">380</td><td class=3D"line-text">             =
   <span class=3D"hljs-comment">//If the result is OK then print the docume=
nt.</span>
</td></tr>
<tr><td class=3D"line-number">381</td><td class=3D"line-text">             =
   <span class=3D"hljs-keyword">if</span> (printDialog.ShowDialog() =3D=3D =
DialogResult.OK &amp;&amp; printDialog.PrinterSettings.PrintRange =3D=3D Pr=
intRange.SomePages) {
</td></tr>
<tr><td class=3D"line-number">382</td><td class=3D"line-text">             =
       print.PrintDocument.PrinterSettings.PrintRange =3D printDialog.Print=
erSettings.PrintRange;
</td></tr>
<tr><td class=3D"line-number">383</td><td class=3D"line-text">             =
       print.PrintDocument.PrinterSettings.FromPage =3D printDialog.Printer=
Settings.FromPage;
</td></tr>
<tr><td class=3D"line-number">384</td><td class=3D"line-text">             =
       print.PrintDocument.PrinterSettings.ToPage =3D printDialog.PrinterSe=
ttings.ToPage;
</td></tr>
<tr><td class=3D"line-number">385</td><td class=3D"line-text">             =
   }
</td></tr>
<tr><td class=3D"line-number">386</td><td class=3D"line-text">            }
</td></tr>
<tr><td class=3D"line-number">387</td><td class=3D"line-text">            p=
rint.DoPrint();
</td></tr>
<tr><td class=3D"line-number">388</td><td class=3D"line-text">        }
</td></tr>
<tr><td class=3D"line-number">389</td><td class=3D"line-text">
</td></tr>
<tr><td class=3D"line-number">390</td><td class=3D"line-text">        <span=
 class=3D"hljs-function"><span class=3D"hljs-keyword">private</span> <span =
class=3D"hljs-keyword">void</span> <span class=3D"hljs-title">panelRight_Re=
size</span>(<span class=3D"hljs-params"><span class=3D"hljs-keyword">object=
</span> sender, EventArgs e</span>)</span> {
</td></tr>
<tr><td class=3D"line-number">391</td><td class=3D"line-text">            S=
izePreview();
</td></tr>
<tr><td class=3D"line-number">392</td><td class=3D"line-text">        }
</td></tr>
<tr><td class=3D"line-number">393</td><td class=3D"line-text">
</td></tr>
<tr><td class=3D"line-number">394</td><td class=3D"line-text">        <span=
 class=3D"hljs-function"><span class=3D"hljs-keyword">private</span> <span =
class=3D"hljs-keyword">void</span> <span class=3D"hljs-title">enableHeader_=
CheckedChanged</span>(<span class=3D"hljs-params"><span class=3D"hljs-keywo=
rd">object</span> sender, EventArgs e</span>)</span> {
</td></tr>
<tr><td class=3D"line-number">395</td><td class=3D"line-text">            D=
ebug.WriteLine(<span class=3D"hljs-string">$"enableHeader_CheckedChanged: <=
span class=3D"hljs-subst">{enableHeader.Checked}</span>"</span>);
</td></tr>
<tr><td class=3D"line-number">396</td><td class=3D"line-text">            <=
span class=3D"hljs-keyword">if</span> (printersCB.Enabled) {
</td></tr>
<tr><td class=3D"line-number">397</td><td class=3D"line-text">             =
   <span class=3D"hljs-comment">// <span class=3D"hljs-doctag">TODO:</span>=
 This should find the Preview SheetViewModel instance and set the property =
on this, not</span>
</td></tr>
<tr><td class=3D"line-number">398</td><td class=3D"line-text">             =
   <span class=3D"hljs-comment">// the model</span>
</td></tr>
<tr><td class=3D"line-number">399</td><td class=3D"line-text">             =
   ModelLocator.Current.Settings.Sheets.GetValueOrDefault(ModelLocator.Curr=
ent.Settings.DefaultSheet.ToString()).Header.Enabled =3D
</td></tr>
<tr><td class=3D"line-number">400</td><td class=3D"line-text">             =
       enableHeader.Checked;
</td></tr>
<tr><td class=3D"line-number">401</td><td class=3D"line-text">            }
</td></tr>
<tr><td class=3D"line-number">402</td><td class=3D"line-text">        }
</td></tr>
<tr><td class=3D"line-number">403</td><td class=3D"line-text">
</td></tr>
<tr><td class=3D"line-number">404</td><td class=3D"line-text">        <span=
 class=3D"hljs-function"><span class=3D"hljs-keyword">private</span> <span =
class=3D"hljs-keyword">void</span> <span class=3D"hljs-title">enableFooter_=
CheckedChanged</span>(<span class=3D"hljs-params"><span class=3D"hljs-keywo=
rd">object</span> sender, EventArgs e</span>)</span> {
</td></tr>
<tr><td class=3D"line-number">405</td><td class=3D"line-text">            D=
ebug.WriteLine(<span class=3D"hljs-string">$"enableFooter_CheckedChanged: <=
span class=3D"hljs-subst">{enableFooter.Checked}</span>"</span>);
</td></tr>
<tr><td class=3D"line-number">406</td><td class=3D"line-text">            <=
span class=3D"hljs-keyword">if</span> (printersCB.Enabled) {
</td></tr>
<tr><td class=3D"line-number">407</td><td class=3D"line-text">             =
   <span class=3D"hljs-comment">// <span class=3D"hljs-doctag">TODO:</span>=
 This should find the Preview SheetViewModel instance and set the property =
on this, not</span>
</td></tr>
<tr><td class=3D"line-number">408</td><td class=3D"line-text">             =
   <span class=3D"hljs-comment">// the model</span>
</td></tr>
<tr><td class=3D"line-number">409</td><td class=3D"line-text">             =
   ModelLocator.Current.Settings.Sheets.GetValueOrDefault(ModelLocator.Curr=
ent.Settings.DefaultSheet.ToString()).Footer.Enabled =3D
</td></tr>
<tr><td class=3D"line-number">410</td><td class=3D"line-text">             =
       enableFooter.Checked;
</td></tr>
<tr><td class=3D"line-number">411</td><td class=3D"line-text">            }
</td></tr>
<tr><td class=3D"line-number">412</td><td class=3D"line-text">        }
</td></tr>
<tr><td class=3D"line-number">413</td><td class=3D"line-text">
</td></tr>
<tr><td class=3D"line-number">414</td><td class=3D"line-text">        <span=
 class=3D"hljs-function"><span class=3D"hljs-keyword">private</span> <span =
class=3D"hljs-keyword">void</span> <span class=3D"hljs-title">comboBoxSheet=
_SelectedIndexChanged</span>(<span class=3D"hljs-params"><span class=3D"hlj=
s-keyword">object</span> sender, EventArgs e</span>)</span> {
</td></tr>
<tr><td class=3D"line-number">415</td><td class=3D"line-text">            K=
eyValuePair&lt;<span class=3D"hljs-keyword">string</span>, <span class=3D"h=
ljs-keyword">string</span>&gt; si =3D (KeyValuePair&lt;<span class=3D"hljs-=
keyword">string</span>, <span class=3D"hljs-keyword">string</span>&gt;)comb=
oBoxSheet.SelectedItem;
</td></tr>
<tr><td class=3D"line-number">416</td><td class=3D"line-text">            D=
ebug.WriteLine(<span class=3D"hljs-string">$"comboBoxSheet_SelectedIndexCha=
nged: <span class=3D"hljs-subst">{si.Key}</span>, <span class=3D"hljs-subst=
">{si.Value}</span>"</span>);
</td></tr>
<tr><td class=3D"line-number">417</td><td class=3D"line-text">            <=
span class=3D"hljs-keyword">if</span> (printersCB.Enabled) {
</td></tr>
<tr><td class=3D"line-number">418</td><td class=3D"line-text">             =
   ModelLocator.Current.Settings.DefaultSheet =3D Guid.Parse(si.Key);
</td></tr>
<tr><td class=3D"line-number">419</td><td class=3D"line-text">             =
   <span class=3D"hljs-comment">//ChangeSheet(ModelLocator.Current.Settings=
.Sheets[si.Key]);</span>
</td></tr>
<tr><td class=3D"line-number">420</td><td class=3D"line-text">            }
</td></tr>
<tr><td class=3D"line-number">421</td><td class=3D"line-text">        }
</td></tr>
<tr><td class=3D"line-number">422</td><td class=3D"line-text">
</td></tr>
<tr><td class=3D"line-number">423</td><td class=3D"line-text">        <span=
 class=3D"hljs-function"><span class=3D"hljs-keyword">private</span> <span =
class=3D"hljs-keyword">void</span> <span class=3D"hljs-title">topMargin_Val=
ueChanged</span>(<span class=3D"hljs-params"><span class=3D"hljs-keyword">o=
bject</span> sender, EventArgs e</span>)</span> {
</td></tr>
<tr><td class=3D"line-number">424</td><td class=3D"line-text">            M=
argins margins =3D (Margins)ModelLocator.Current.Settings.Sheets.GetValueOr=
Default(ModelLocator.Current.Settings.DefaultSheet.ToString()).Margins.Clon=
e();
</td></tr>
<tr><td class=3D"line-number">425</td><td class=3D"line-text">            m=
argins.Top =3D (<span class=3D"hljs-keyword">int</span>)(topMargin.Value * =
<span class=3D"hljs-number">100</span>M);
</td></tr>
<tr><td class=3D"line-number">426</td><td class=3D"line-text">            M=
odelLocator.Current.Settings.Sheets.GetValueOrDefault(ModelLocator.Current.=
Settings.DefaultSheet.ToString()).Margins =3D margins;
</td></tr>
<tr><td class=3D"line-number">427</td><td class=3D"line-text">        }
</td></tr>
<tr><td class=3D"line-number">428</td><td class=3D"line-text">
</td></tr>
<tr><td class=3D"line-number">429</td><td class=3D"line-text">        <span=
 class=3D"hljs-function"><span class=3D"hljs-keyword">private</span> <span =
class=3D"hljs-keyword">void</span> <span class=3D"hljs-title">leftMargin_Va=
lueChanged</span>(<span class=3D"hljs-params"><span class=3D"hljs-keyword">=
object</span> sender, EventArgs e</span>)</span> {
</td></tr>
<tr><td class=3D"line-number">430</td><td class=3D"line-text">            M=
argins margins =3D (Margins)ModelLocator.Current.Settings.Sheets.GetValueOr=
Default(ModelLocator.Current.Settings.DefaultSheet.ToString()).Margins.Clon=
e();
</td></tr>
<tr><td class=3D"line-number">431</td><td class=3D"line-text">            m=
argins.Left =3D (<span class=3D"hljs-keyword">int</span>)(leftMargin.Value =
* <span class=3D"hljs-number">100</span>M);
</td></tr>
<tr><td class=3D"line-number">432</td><td class=3D"line-text">            M=
odelLocator.Current.Settings.Sheets.GetValueOrDefault(ModelLocator.Current.=
Settings.DefaultSheet.ToString()).Margins =3D margins;
</td></tr>
<tr><td class=3D"line-number">433</td><td class=3D"line-text">        }
</td></tr>
<tr><td class=3D"line-number">434</td><td class=3D"line-text">
</td></tr>
<tr><td class=3D"line-number">435</td><td class=3D"line-text">        <span=
 class=3D"hljs-function"><span class=3D"hljs-keyword">private</span> <span =
class=3D"hljs-keyword">void</span> <span class=3D"hljs-title">rightMargin_V=
alueChanged</span>(<span class=3D"hljs-params"><span class=3D"hljs-keyword"=
>object</span> sender, EventArgs e</span>)</span> {
</td></tr>
<tr><td class=3D"line-number">436</td><td class=3D"line-text">            M=
argins margins =3D (Margins)ModelLocator.Current.Settings.Sheets.GetValueOr=
Default(ModelLocator.Current.Settings.DefaultSheet.ToString()).Margins.Clon=
e();
</td></tr>
<tr><td class=3D"line-number">437</td><td class=3D"line-text">            m=
argins.Right =3D (<span class=3D"hljs-keyword">int</span>)(rightMargin.Valu=
e * <span class=3D"hljs-number">100</span>M);
</td></tr>
<tr><td class=3D"line-number">438</td><td class=3D"line-text">            M=
odelLocator.Current.Settings.Sheets.GetValueOrDefault(ModelLocator.Current.=
Settings.DefaultSheet.ToString()).Margins =3D margins;
</td></tr>
<tr><td class=3D"line-number">439</td><td class=3D"line-text">        }
</td></tr>
<tr><td class=3D"line-number">440</td><td class=3D"line-text">
</td></tr>
<tr><td class=3D"line-number">441</td><td class=3D"line-text">        <span=
 class=3D"hljs-function"><span class=3D"hljs-keyword">private</span> <span =
class=3D"hljs-keyword">void</span> <span class=3D"hljs-title">bottomMargin_=
ValueChanged</span>(<span class=3D"hljs-params"><span class=3D"hljs-keyword=
">object</span> sender, EventArgs e</span>)</span> {
</td></tr>
<tr><td class=3D"line-number">442</td><td class=3D"line-text">            M=
argins margins =3D (Margins)ModelLocator.Current.Settings.Sheets.GetValueOr=
Default(ModelLocator.Current.Settings.DefaultSheet.ToString()).Margins.Clon=
e();
</td></tr>
<tr><td class=3D"line-number">443</td><td class=3D"line-text">            m=
argins.Bottom =3D (<span class=3D"hljs-keyword">int</span>)(bottomMargin.Va=
lue * <span class=3D"hljs-number">100</span>M);
</td></tr>
<tr><td class=3D"line-number">444</td><td class=3D"line-text">            M=
odelLocator.Current.Settings.Sheets.GetValueOrDefault(ModelLocator.Current.=
Settings.DefaultSheet.ToString()).Margins =3D margins;
</td></tr>
<tr><td class=3D"line-number">445</td><td class=3D"line-text">        }
</td></tr>
<tr><td class=3D"line-number">446</td><td class=3D"line-text">
</td></tr>
<tr><td class=3D"line-number">447</td><td class=3D"line-text">        <span=
 class=3D"hljs-function"><span class=3D"hljs-keyword">private</span> <span =
class=3D"hljs-keyword">void</span> <span class=3D"hljs-title">pageSeparator=
_CheckedChanged</span>(<span class=3D"hljs-params"><span class=3D"hljs-keyw=
ord">object</span> sender, EventArgs e</span>)</span> {
</td></tr>
<tr><td class=3D"line-number">448</td><td class=3D"line-text">            M=
odelLocator.Current.Settings.Sheets.GetValueOrDefault(ModelLocator.Current.=
Settings.DefaultSheet.ToString()).PageSeparator =3D pageSeparator.Checked;
</td></tr>
<tr><td class=3D"line-number">449</td><td class=3D"line-text">        }
</td></tr>
<tr><td class=3D"line-number">450</td><td class=3D"line-text">
</td></tr>
<tr><td class=3D"line-number">451</td><td class=3D"line-text">        <span=
 class=3D"hljs-function"><span class=3D"hljs-keyword">private</span> <span =
class=3D"hljs-keyword">void</span> <span class=3D"hljs-title">rows_ValueCha=
nged</span>(<span class=3D"hljs-params"><span class=3D"hljs-keyword">object=
</span> sender, EventArgs e</span>)</span> {
</td></tr>
<tr><td class=3D"line-number">452</td><td class=3D"line-text">            M=
odelLocator.Current.Settings.Sheets.GetValueOrDefault(ModelLocator.Current.=
Settings.DefaultSheet.ToString()).Rows =3D (<span class=3D"hljs-keyword">in=
t</span>)rows.Value;
</td></tr>
<tr><td class=3D"line-number">453</td><td class=3D"line-text">        }
</td></tr>
<tr><td class=3D"line-number">454</td><td class=3D"line-text">
</td></tr>
<tr><td class=3D"line-number">455</td><td class=3D"line-text">        <span=
 class=3D"hljs-function"><span class=3D"hljs-keyword">private</span> <span =
class=3D"hljs-keyword">void</span> <span class=3D"hljs-title">columns_Value=
Changed</span>(<span class=3D"hljs-params"><span class=3D"hljs-keyword">obj=
ect</span> sender, EventArgs e</span>)</span> {
</td></tr>
<tr><td class=3D"line-number">456</td><td class=3D"line-text">            M=
odelLocator.Current.Settings.Sheets.GetValueOrDefault(ModelLocator.Current.=
Settings.DefaultSheet.ToString()).Columns =3D (<span class=3D"hljs-keyword"=
>int</span>)columns.Value;
</td></tr>
<tr><td class=3D"line-number">457</td><td class=3D"line-text">
</td></tr>
<tr><td class=3D"line-number">458</td><td class=3D"line-text">        }
</td></tr>
<tr><td class=3D"line-number">459</td><td class=3D"line-text">
</td></tr>
<tr><td class=3D"line-number">460</td><td class=3D"line-text">        <span=
 class=3D"hljs-function"><span class=3D"hljs-keyword">private</span> <span =
class=3D"hljs-keyword">void</span> <span class=3D"hljs-title">padding_Value=
Changed</span>(<span class=3D"hljs-params"><span class=3D"hljs-keyword">obj=
ect</span> sender, EventArgs e</span>)</span> {
</td></tr>
<tr><td class=3D"line-number">461</td><td class=3D"line-text">            M=
odelLocator.Current.Settings.Sheets.GetValueOrDefault(ModelLocator.Current.=
Settings.DefaultSheet.ToString()).Padding =3D (<span class=3D"hljs-keyword"=
>int</span>)(padding.Value * <span class=3D"hljs-number">100</span>M);
</td></tr>
<tr><td class=3D"line-number">462</td><td class=3D"line-text">        }
</td></tr>
<tr><td class=3D"line-number">463</td><td class=3D"line-text">    }
</td></tr>
<tr><td class=3D"line-number">464</td><td class=3D"line-text">}
</td></tr>
<tr><td class=3D"line-number">465</td><td class=3D"line-text"></td></tr></t=
body></table></body></html>
------MultipartBoundary--ctxYLHKYprwXxXVmXMNQ4i1MAESqIAZlGBQc6BGSfT----
Content-Type: text/css
Content-Transfer-Encoding: quoted-printable
Content-Location: cid:css-b4cd29d4-bb14-44d1-a954-dcf901ed225f@mhtml.blink

@charset "utf-8";

body { margin: 0px; padding: 0px; tab-size: 4; }

.hljs { display: block; overflow-x: auto; padding: 0.5em; background: rgb(2=
40, 240, 240); }

.hljs, .hljs-subst { color: rgb(68, 68, 68); }

.hljs-comment { color: rgb(136, 136, 136); }

.hljs-keyword, .hljs-attribute, .hljs-selector-tag, .hljs-meta-keyword, .hl=
js-doctag, .hljs-name { font-weight: bold; }

.hljs-type, .hljs-string, .hljs-number, .hljs-selector-id, .hljs-selector-c=
lass, .hljs-quote, .hljs-template-tag, .hljs-deletion { color: rgb(136, 0, =
0); }

.hljs-title, .hljs-section { color: rgb(136, 0, 0); font-weight: bold; }

.hljs-regexp, .hljs-symbol, .hljs-variable, .hljs-template-variable, .hljs-=
link, .hljs-selector-attr, .hljs-selector-pseudo { color: rgb(188, 96, 96);=
 }

.hljs-literal { color: rgb(120, 169, 96); }

.hljs-built_in, .hljs-bullet, .hljs-code, .hljs-addition { color: rgb(57, 1=
15, 0); }

.hljs-meta { color: rgb(31, 113, 153); }

.hljs-meta-string { color: rgb(77, 153, 191); }

.hljs-emphasis { font-style: italic; }

.hljs-strong { font-weight: bold; }

.hljs { display: block; overflow-x: auto; padding: 0.5em; background: rgb(2=
40, 240, 240); }

.hljs, .hljs-subst { color: rgb(68, 68, 68); }

.hljs-comment { color: rgb(136, 136, 136); }

.hljs-keyword, .hljs-attribute, .hljs-selector-tag, .hljs-meta-keyword, .hl=
js-doctag, .hljs-name { font-weight: bold; }

.hljs-type, .hljs-string, .hljs-number, .hljs-selector-id, .hljs-selector-c=
lass, .hljs-quote, .hljs-template-tag, .hljs-deletion { color: rgb(136, 0, =
0); }

.hljs-title, .hljs-section { color: rgb(136, 0, 0); font-weight: bold; }

.hljs-regexp, .hljs-symbol, .hljs-variable, .hljs-template-variable, .hljs-=
link, .hljs-selector-attr, .hljs-selector-pseudo { color: rgb(188, 96, 96);=
 }

.hljs-literal { color: rgb(120, 169, 96); }

.hljs-built_in, .hljs-bullet, .hljs-code, .hljs-addition { color: rgb(57, 1=
15, 0); }

.hljs-meta { color: rgb(31, 113, 153); }

.hljs-meta-string { color: rgb(77, 153, 191); }

.hljs-emphasis { font-style: italic; }

.hljs-strong { font-weight: bold; }

table { border: none; border-collapse: collapse; }

.line-number { border-right: thin solid silver; padding-right: 0.3em; text-=
align: right; vertical-align: top; }

.line-text { margin-left: 0.7em; padding-bottom: 0em; white-space: pre-wrap=
; }

.hljs { max-width: 100%; width: 100%; font-family: Consolas, monospace; fon=
t-size: 10pt; }
------MultipartBoundary--ctxYLHKYprwXxXVmXMNQ4i1MAESqIAZlGBQc6BGSfT------
